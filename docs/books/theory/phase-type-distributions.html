<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Phase-type distributions | Complete Theory</title>
  <meta name="description" content="4.2 Phase-type distributions | Complete Theory" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Phase-type distributions | Complete Theory" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Phase-type distributions | Complete Theory" />
  
  
  

<meta name="author" content="Joakim Bilyk" />


<meta name="date" content="2023-03-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="markov-jump-processes.html"/>
<link rel="next" href="interest-rates.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

<script>
    $(function() {
        var element = document.body;
        if (localStorage.chkbx && localStorage.chkbx != '') {
            $('#remember_me').attr('checked', 'checked');
            element.classList.toggle("dark-mode");
            document.querySelector('.book-header.fixed').click();
        } else {
            $('#remember_me').removeAttr('checked');
            document.querySelector('.book-header.fixed').click();
        }

        $('#remember_me').click(function() {

            if ($('#remember_me').is(':checked')) {
                // save username and password
                localStorage.chkbx = $('#remember_me').val();
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            } else {
                localStorage.chkbx = '';
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            }
        });
    });

</script>

<div class = "sticky-darkmode-toggle">
  <label class="switch">
  <input type="checkbox" value="remember-me" id="remember_me">
  <span class="slider round">
  </span>
  </label>
</div>

<script>
$(function() {
  $('body').after($('.sticky-darkmode-toggle'));
})
</script>

<style>

.sticky-darkmode-toggle {
  position: fixed;
  right: 20px;
  bottom: 20px;
}
</style>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Comlete theory</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="abbreviations.html"><a href="abbreviations.html"><i class="fa fa-check"></i><b>1.1</b> Abbreviations</a></li>
<li class="chapter" data-level="1.2" data-path="to-do-reading.html"><a href="to-do-reading.html"><i class="fa fa-check"></i><b>1.2</b> To-do reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-life-insurance-mathematics.html"><a href="basic-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>2</b> Basic Life Insurance Mathematics</a></li>
<li class="chapter" data-level="3" data-path="stochastic-processes-in-life-insurance-mathematics.html"><a href="stochastic-processes-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>3</b> Stochastic Processes in Life Insurance Mathematics</a></li>
<li class="chapter" data-level="4" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>4</b> Topics in Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="markov-jump-processes.html"><a href="markov-jump-processes.html"><i class="fa fa-check"></i><b>4.1</b> Markov Jump Processes</a></li>
<li class="chapter" data-level="4.2" data-path="phase-type-distributions.html"><a href="phase-type-distributions.html"><i class="fa fa-check"></i><b>4.2</b> Phase-type distributions</a></li>
<li class="chapter" data-level="4.3" data-path="interest-rates.html"><a href="interest-rates.html"><i class="fa fa-check"></i><b>4.3</b> Interest rates</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="interest-rates.html"><a href="interest-rates.html#basic-definitions-and-properties"><i class="fa fa-check"></i><b>4.3.1</b> Basic definitions and properties</a></li>
<li class="chapter" data-level="4.3.2" data-path="interest-rates.html"><a href="interest-rates.html#phase-type-representation-of-bond-prices"><i class="fa fa-check"></i><b>4.3.2</b> Phase-type representation of bond prices</a></li>
<li class="chapter" data-level="4.3.3" data-path="interest-rates.html"><a href="interest-rates.html#term-structure-models"><i class="fa fa-check"></i><b>4.3.3</b> Term structure models</a></li>
<li class="chapter" data-level="4.3.4" data-path="interest-rates.html"><a href="interest-rates.html#estimation-of-ph-bond-models"><i class="fa fa-check"></i><b>4.3.4</b> Estimation of PH bond models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html"><i class="fa fa-check"></i><b>4.4</b> Survival and mortality rates</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#survival-probabilities-and-forward-mortality-rates"><i class="fa fa-check"></i><b>4.4.1</b> Survival probabilities and forward mortality rates</a></li>
<li class="chapter" data-level="4.4.2" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#forward-transistion-rates"><i class="fa fa-check"></i><b>4.4.2</b> Forward transistion rates</a></li>
<li class="chapter" data-level="4.4.3" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#reserves-revisited"><i class="fa fa-check"></i><b>4.4.3</b> Reserves revisited</a></li>
<li class="chapter" data-level="4.4.4" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#stochastic-mortality-rates"><i class="fa fa-check"></i><b>4.4.4</b> Stochastic mortality rates</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html"><i class="fa fa-check"></i><b>4.5</b> Matrix methods in life insurance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#basic-setup"><i class="fa fa-check"></i><b>4.5.1</b> Basic setup</a></li>
<li class="chapter" data-level="4.5.2" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#interest-rate-free-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Interest rate free analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#transform-of-rewards-and-higher-order-moments"><i class="fa fa-check"></i><b>4.5.3</b> Transform of rewards and higher order moments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html"><i class="fa fa-check"></i><b>5</b> Continuous Time Finance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="discrete-time-models.html"><a href="discrete-time-models.html"><i class="fa fa-check"></i><b>5.1</b> Discrete time models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="discrete-time-models.html"><a href="discrete-time-models.html#one-period-time-models"><i class="fa fa-check"></i><b>5.1.1</b> One-period time models</a></li>
<li class="chapter" data-level="5.1.2" data-path="discrete-time-models.html"><a href="discrete-time-models.html#multi-period-model"><i class="fa fa-check"></i><b>5.1.2</b> Multi-period model</a></li>
<li class="chapter" data-level="5.1.3" data-path="discrete-time-models.html"><a href="discrete-time-models.html#generelised-one-period-model"><i class="fa fa-check"></i><b>5.1.3</b> Generelised one-period model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html"><i class="fa fa-check"></i><b>5.2</b> Self-financing portfolios</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#discrete-time-sf-portfolio"><i class="fa fa-check"></i><b>5.2.1</b> Discrete time SF portfolio</a></li>
<li class="chapter" data-level="5.2.2" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#continuous-time-sf-portfolio"><i class="fa fa-check"></i><b>5.2.2</b> Continuous time SF portfolio</a></li>
<li class="chapter" data-level="5.2.3" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#portfolio-weights"><i class="fa fa-check"></i><b>5.2.3</b> Portfolio weights</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html"><i class="fa fa-check"></i><b>5.3</b> Black-Scholes PDE</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#contingent-claims-and-arbitrage"><i class="fa fa-check"></i><b>5.3.1</b> Contingent Claims and Arbitrage</a></li>
<li class="chapter" data-level="5.3.2" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#risk-neutral-valuation-1"><i class="fa fa-check"></i><b>5.3.2</b> Risk Neutral Valuation</a></li>
<li class="chapter" data-level="5.3.3" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#black-scholes-formula"><i class="fa fa-check"></i><b>5.3.3</b> Black-Scholes formula</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html"><i class="fa fa-check"></i><b>5.4</b> Completeness and Hedging</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#completeness-in-black-scholes"><i class="fa fa-check"></i><b>5.4.1</b> Completeness in Black-Scholes</a></li>
<li class="chapter" data-level="5.4.2" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#absence-of-arbitrage-1"><i class="fa fa-check"></i><b>5.4.2</b> Absence of Arbitrage</a></li>
<li class="chapter" data-level="5.4.3" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#incomplete-markets"><i class="fa fa-check"></i><b>5.4.3</b> Incomplete Markets</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="parity-relations.html"><a href="parity-relations.html"><i class="fa fa-check"></i><b>5.5</b> Parity relations</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="parity-relations.html"><a href="parity-relations.html#put-call-parity"><i class="fa fa-check"></i><b>5.5.1</b> Put-call Parity</a></li>
<li class="chapter" data-level="5.5.2" data-path="parity-relations.html"><a href="parity-relations.html#the-greeks"><i class="fa fa-check"></i><b>5.5.2</b> The Greeks</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html"><i class="fa fa-check"></i><b>5.6</b> Fundamental pricing theorem I and II</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#completeness-1"><i class="fa fa-check"></i><b>5.6.1</b> Completeness</a></li>
<li class="chapter" data-level="5.6.2" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#risk-neutral-valuation-formula"><i class="fa fa-check"></i><b>5.6.2</b> Risk Neutral Valuation Formula</a></li>
<li class="chapter" data-level="5.6.3" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#stochastic-discount-factors-1"><i class="fa fa-check"></i><b>5.6.3</b> Stochastic Discount Factors</a></li>
<li class="chapter" data-level="5.6.4" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#summary"><i class="fa fa-check"></i><b>5.6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html"><i class="fa fa-check"></i><b>5.7</b> Mathematics of the martingale approach</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html#martingale-representation-theorem"><i class="fa fa-check"></i><b>5.7.1</b> Martingale representation theorem</a></li>
<li class="chapter" data-level="5.7.2" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html#girsanov-theorem"><i class="fa fa-check"></i><b>5.7.2</b> Girsanov theorem</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="black-scholes-model---martingale-approach.html"><a href="black-scholes-model---martingale-approach.html"><i class="fa fa-check"></i><b>5.8</b> Black-Scholes model - martingale approach</a></li>
<li class="chapter" data-level="5.9" data-path="multidimensional-models.html"><a href="multidimensional-models.html"><i class="fa fa-check"></i><b>5.9</b> Multidimensional models</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-non-life-insurance-mathematics.html"><a href="basic-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>6</b> Basic Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="7" data-path="stochastic-processes-in-non-life-insurance-mathematics.html"><a href="stochastic-processes-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>7</b> Stochastic Processes in Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="8" data-path="topics-in-non-life-insurance-mathematics.html"><a href="topics-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>8</b> Topics in Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="9" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html"><i class="fa fa-check"></i><b>9</b> Probabilistic Machine Learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>9.1</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#what-is-a-good-estimator"><i class="fa fa-check"></i><b>9.1.1</b> What is a good estimator?</a></li>
<li class="chapter" data-level="9.1.2" data-path="supervised-learning.html"><a href="supervised-learning.html#excess-risk"><i class="fa fa-check"></i><b>9.1.2</b> Excess risk</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="training-validating-and-testing.html"><a href="training-validating-and-testing.html"><i class="fa fa-check"></i><b>9.2</b> Training, Validating and Testing</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="training-validating-and-testing.html"><a href="training-validating-and-testing.html#estimating-risk"><i class="fa fa-check"></i><b>9.2.1</b> Estimating risk</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>9.3</b> Linear Models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="linear-models.html"><a href="linear-models.html#least-squares-estimator"><i class="fa fa-check"></i><b>9.3.1</b> Least Squares Estimator</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-models.html"><a href="linear-models.html#ridge-regression"><i class="fa fa-check"></i><b>9.3.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-models.html"><a href="linear-models.html#lasso-regression"><i class="fa fa-check"></i><b>9.3.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="9.3.4" data-path="linear-models.html"><a href="linear-models.html#conclusion"><i class="fa fa-check"></i><b>9.3.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html"><i class="fa fa-check"></i><b>9.4</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#linear-smoothers"><i class="fa fa-check"></i><b>9.4.1</b> Linear Smoothers</a></li>
<li class="chapter" data-level="9.4.2" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#curse-of-dimensionality"><i class="fa fa-check"></i><b>9.4.2</b> Curse of dimensionality</a></li>
<li class="chapter" data-level="9.4.3" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#splines"><i class="fa fa-check"></i><b>9.4.3</b> Splines</a></li>
<li class="chapter" data-level="9.4.4" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#linear-regression-with-splines."><i class="fa fa-check"></i><b>9.4.4</b> Linear regression with splines.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="trees-and-forests.html"><a href="trees-and-forests.html"><i class="fa fa-check"></i><b>9.5</b> Trees and forests</a></li>
<li class="chapter" data-level="9.6" data-path="gradient-boosting-machines-and-bayesian-additive-regression-trees.html"><a href="gradient-boosting-machines-and-bayesian-additive-regression-trees.html"><i class="fa fa-check"></i><b>9.6</b> Gradient Boosting Machines and Bayesian additive regression trees</a></li>
<li class="chapter" data-level="9.7" data-path="some-practical-considerations.html"><a href="some-practical-considerations.html"><i class="fa fa-check"></i><b>9.7</b> Some practical considerations</a></li>
<li class="chapter" data-level="9.8" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>9.8</b> Neural Networks</a></li>
<li class="chapter" data-level="9.9" data-path="local-explanations.html"><a href="local-explanations.html"><i class="fa fa-check"></i><b>9.9</b> Local explanations</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="local-explanations.html"><a href="local-explanations.html#interpretability"><i class="fa fa-check"></i><b>9.9.1</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>9.10</b> Causality</a></li>
<li class="chapter" data-level="9.11" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html"><i class="fa fa-check"></i><b>9.11</b> Local and Global Explanations</a>
<ul>
<li class="chapter" data-level="9.11.1" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#interpretability-1"><i class="fa fa-check"></i><b>9.11.1</b> Interpretability</a></li>
<li class="chapter" data-level="9.11.2" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#partial-dependence-plots"><i class="fa fa-check"></i><b>9.11.2</b> Partial dependence plots</a></li>
<li class="chapter" data-level="9.11.3" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#a-functional-decomposition"><i class="fa fa-check"></i><b>9.11.3</b> A functional decomposition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html"><i class="fa fa-check"></i><b>10</b> Quantative Risk Management</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-loss-variable.html"><a href="the-loss-variable.html"><i class="fa fa-check"></i><b>10.1</b> The Loss Variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="the-loss-variable.html"><a href="the-loss-variable.html#risk-measures"><i class="fa fa-check"></i><b>10.1.1</b> Risk measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="measure-theory.html"><a href="measure-theory.html"><i class="fa fa-check"></i><b>11</b> Measure theory</a>
<ul>
<li class="chapter" data-level="11.1" data-path="axioms-of-probability.html"><a href="axioms-of-probability.html"><i class="fa fa-check"></i><b>11.1</b> Axioms of Probability</a></li>
<li class="chapter" data-level="11.2" data-path="conditional-probability-and-independence.html"><a href="conditional-probability-and-independence.html"><i class="fa fa-check"></i><b>11.2</b> Conditional Probability and Independence</a></li>
<li class="chapter" data-level="11.3" data-path="probabilities-on-a-finite-or-countable-space.html"><a href="probabilities-on-a-finite-or-countable-space.html"><i class="fa fa-check"></i><b>11.3</b> Probabilities on a Finite or Countable Space</a></li>
<li class="chapter" data-level="11.4" data-path="construction-of-a-probability-measure-on-mathbb-r.html"><a href="construction-of-a-probability-measure-on-mathbb-r.html"><i class="fa fa-check"></i><b>11.4</b> Construction of a Probability Measure on <span class="math inline">\(\mathbb R\)</span></a></li>
<li class="chapter" data-level="11.5" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>11.5</b> Random Variables</a></li>
<li class="chapter" data-level="11.6" data-path="integration-with-respect-to-a-probability-measure.html"><a href="integration-with-respect-to-a-probability-measure.html"><i class="fa fa-check"></i><b>11.6</b> Integration with Respect to a Probability Measure</a></li>
<li class="chapter" data-level="11.7" data-path="independent-random-variables.html"><a href="independent-random-variables.html"><i class="fa fa-check"></i><b>11.7</b> Independent Random Variables</a></li>
<li class="chapter" data-level="11.8" data-path="probability-distributions-on-mathbb-r.html"><a href="probability-distributions-on-mathbb-r.html"><i class="fa fa-check"></i><b>11.8</b> Probability Distributions on <span class="math inline">\(\mathbb R\)</span></a></li>
<li class="chapter" data-level="11.9" data-path="probability-distributions-on-mathbb-rn.html"><a href="probability-distributions-on-mathbb-rn.html"><i class="fa fa-check"></i><b>11.9</b> Probability Distributions on <span class="math inline">\(\mathbb R^n\)</span></a></li>
<li class="chapter" data-level="11.10" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html"><i class="fa fa-check"></i><b>11.10</b> Equivalent Probability Measures</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#the-radon-nikodym-theorem"><i class="fa fa-check"></i><b>11.10.1</b> The Radon-Nikodym Theorem</a></li>
<li class="chapter" data-level="11.10.2" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#equivalent-probability-measures-1"><i class="fa fa-check"></i><b>11.10.2</b> Equivalent Probability Measures</a></li>
<li class="chapter" data-level="11.10.3" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#likelihood-processes"><i class="fa fa-check"></i><b>11.10.3</b> Likelihood processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="random-variables-1.html"><a href="random-variables-1.html"><i class="fa fa-check"></i><b>12</b> Random Variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="conditional-expectation.html"><a href="conditional-expectation.html"><i class="fa fa-check"></i><b>12.2</b> Conditional expectation</a></li>
<li class="chapter" data-level="12.3" data-path="independence.html"><a href="independence.html"><i class="fa fa-check"></i><b>12.3</b> Independence</a></li>
<li class="chapter" data-level="12.4" data-path="moment-generating-function.html"><a href="moment-generating-function.html"><i class="fa fa-check"></i><b>12.4</b> Moment generating function</a></li>
<li class="chapter" data-level="12.5" data-path="standard-distributions.html"><a href="standard-distributions.html"><i class="fa fa-check"></i><b>12.5</b> Standard distributions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="standard-distributions.html"><a href="standard-distributions.html#normal-disribution"><i class="fa fa-check"></i><b>12.5.1</b> Normal disribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html"><i class="fa fa-check"></i><b>13</b> Discrete Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="13.1" data-path="convergence-concepts.html"><a href="convergence-concepts.html"><i class="fa fa-check"></i><b>13.1</b> Convergence concepts</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="convergence-concepts.html"><a href="convergence-concepts.html#sums-and-average-processes"><i class="fa fa-check"></i><b>13.1.1</b> Sums and average processes</a></li>
<li class="chapter" data-level="13.1.2" data-path="convergence-concepts.html"><a href="convergence-concepts.html#ergodic-theory"><i class="fa fa-check"></i><b>13.1.2</b> Ergodic Theory</a></li>
<li class="chapter" data-level="13.1.3" data-path="convergence-concepts.html"><a href="convergence-concepts.html#weak-convergence"><i class="fa fa-check"></i><b>13.1.3</b> Weak Convergence</a></li>
<li class="chapter" data-level="13.1.4" data-path="convergence-concepts.html"><a href="convergence-concepts.html#central-limit-theorems"><i class="fa fa-check"></i><b>13.1.4</b> Central Limit Theorems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>14</b> Markov Chains</a>
<ul>
<li class="chapter" data-level="14.1" data-path="definition-of-a-markov-chain.html"><a href="definition-of-a-markov-chain.html"><i class="fa fa-check"></i><b>14.1</b> Definition of a Markov Chain</a></li>
<li class="chapter" data-level="14.2" data-path="classification-of-states.html"><a href="classification-of-states.html"><i class="fa fa-check"></i><b>14.2</b> Classification of states</a></li>
<li class="chapter" data-level="14.3" data-path="limit-results-and-invariant-probabilities.html"><a href="limit-results-and-invariant-probabilities.html"><i class="fa fa-check"></i><b>14.3</b> Limit results and invariant probabilities</a></li>
<li class="chapter" data-level="14.4" data-path="absorbing-probabilities.html"><a href="absorbing-probabilities.html"><i class="fa fa-check"></i><b>14.4</b> Absorbing probabilities</a></li>
<li class="chapter" data-level="14.5" data-path="markov-chains-in-continuous-times.html"><a href="markov-chains-in-continuous-times.html"><i class="fa fa-check"></i><b>14.5</b> Markov Chains in Continuous Times</a></li>
<li class="chapter" data-level="14.6" data-path="properties-of-transitionsprobabilities.html"><a href="properties-of-transitionsprobabilities.html"><i class="fa fa-check"></i><b>14.6</b> Properties of transitionsprobabilities</a></li>
<li class="chapter" data-level="14.7" data-path="invariant-probabilies-and-absorption.html"><a href="invariant-probabilies-and-absorption.html"><i class="fa fa-check"></i><b>14.7</b> Invariant probabilies and absorption</a></li>
<li class="chapter" data-level="14.8" data-path="birth-death-processes.html"><a href="birth-death-processes.html"><i class="fa fa-check"></i><b>14.8</b> Birth-death processes</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html"><i class="fa fa-check"></i><b>15</b> Continuous Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="15.1" data-path="brownian-motion.html"><a href="brownian-motion.html"><i class="fa fa-check"></i><b>15.1</b> Brownian Motion</a></li>
<li class="chapter" data-level="15.2" data-path="filtration.html"><a href="filtration.html"><i class="fa fa-check"></i><b>15.2</b> Filtration</a></li>
<li class="chapter" data-level="15.3" data-path="martingale.html"><a href="martingale.html"><i class="fa fa-check"></i><b>15.3</b> Martingale</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html"><i class="fa fa-check"></i><b>16</b> Stochastic calculus</a>
<ul>
<li class="chapter" data-level="16.1" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html"><i class="fa fa-check"></i><b>16.1</b> Stochastic Integrals</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#information"><i class="fa fa-check"></i><b>16.1.1</b> Information</a></li>
<li class="chapter" data-level="16.1.2" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#stochastic-integrals-1"><i class="fa fa-check"></i><b>16.1.2</b> Stochastic Integrals</a></li>
<li class="chapter" data-level="16.1.3" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#martingales"><i class="fa fa-check"></i><b>16.1.3</b> Martingales</a></li>
<li class="chapter" data-level="16.1.4" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#stochastic-calculus-and-the-ito-formula"><i class="fa fa-check"></i><b>16.1.4</b> Stochastic Calculus and the Ito Formula</a></li>
<li class="chapter" data-level="16.1.5" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#the-multidimensional-ito-formula"><i class="fa fa-check"></i><b>16.1.5</b> The multidimensional Ito Formula</a></li>
<li class="chapter" data-level="16.1.6" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#correlated-brownian-motions"><i class="fa fa-check"></i><b>16.1.6</b> Correlated Brownian motions</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="discrete-stochastic-integrals.html"><a href="discrete-stochastic-integrals.html"><i class="fa fa-check"></i><b>16.2</b> Discrete Stochastic Integrals</a></li>
<li class="chapter" data-level="16.3" data-path="stochastic-differential-equations.html"><a href="stochastic-differential-equations.html"><i class="fa fa-check"></i><b>16.3</b> Stochastic Differential Equations</a></li>
<li class="chapter" data-level="16.4" data-path="partial-differential-equations.html"><a href="partial-differential-equations.html"><i class="fa fa-check"></i><b>16.4</b> Partial differential equations</a></li>
<li class="chapter" data-level="16.5" data-path="the-product-integral.html"><a href="the-product-integral.html"><i class="fa fa-check"></i><b>16.5</b> The Product Integral</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="the-product-integral.html"><a href="the-product-integral.html#properties-of-the-product-integral"><i class="fa fa-check"></i><b>16.5.1</b> Properties of the Product Integral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-algebra.html"><a href="linear-algebra.html"><i class="fa fa-check"></i><b>17</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="17.1" data-path="invertible-matrices.html"><a href="invertible-matrices.html"><i class="fa fa-check"></i><b>17.1</b> Invertible matrices</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>18</b> Coding</a>
<ul>
<li class="chapter" data-level="18.1" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>18.1</b> R-Packages</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="r-packages.html"><a href="r-packages.html#mlr3"><i class="fa fa-check"></i><b>18.1.1</b> mlr3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://joakim-bilyk.github.io/index.html">Back to main site</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Complete Theory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="phase-type-distributions" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Phase-type distributions<a href="phase-type-distributions.html#phase-type-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In life insurance models we often, that is always, have a model with one absorbing state, namely, <em>death</em>. This means that the state space <span class="math inline">\(E\)</span> will have the form of <span class="math inline">\(p\ge 1\)</span> transient states (states that may interact in both ways) and one absorbing state (a state that is never moved away from). In this case we would often like to study the distribution of</p>
<p><span class="math display">\[
\inf\{t\ge 0 : X(t)=p+1\},
\]</span></p>
<p>where <span class="math inline">\(p+1\)</span> is the absorbing state and <span class="math inline">\(1,...,p\)</span> are the transient states. We will assume that <span class="math inline">\(P(X(0)=p+1)=0\)</span> i.e. the above is at least zero and never <span class="math inline">\(-\infty\)</span>. Let us now formalise this setup.</p>
<p>Consider a time-inhomogeneous Markov jump process <span class="math inline">\(\{X_t\}_{t\ge 0}\)</span> on the finite state-space <span class="math inline">\(E=\{1,...,p,p+1\}\)</span> where the states <span class="math inline">\(1,...,p\)</span> are transient states and <span class="math inline">\(p+1\)</span> is the only absorbing state. This implies that the intesity matrix of <span class="math inline">\(\{X_t\}_{t\ge 0}\)</span> take the form</p>
<p><span class="math display">\[
\Lambda(t)=\begin{bmatrix}
\mathbf{T}(t) &amp; \mathbf{t}(t)\\
\mathbf{0} &amp; 0
\end{bmatrix}.
\]</span></p>
<p>In the above <span class="math inline">\(\mathbf{T}(t)\)</span> is a <span class="math inline">\(p\times p\)</span> matrix function and <span class="math inline">\(\mathbf{t}(t)\)</span> is a <span class="math inline">\(p\times 1\)</span> matrix function. We now define the initial distribution of <span class="math inline">\(X_0\)</span> as</p>
<p><span class="math display">\[
\{P(X_0=i)\}_{i\in E\setminus \{p+1\}}=\mathbf{\pi}=\begin{pmatrix}\pi_1\\ \vdots\\ \pi_p\end{pmatrix}^\top.
\]</span></p>
<p>By assumption we have <span class="math inline">\(P(X_0=p+1)=0\)</span> and so <span class="math inline">\(\sum_{i=1}^p\pi_i=1\)</span> and <span class="math inline">\(\mathbf{\pi}\)</span> is a proper distribution.</p>
<blockquote class="def">
<p><strong>Definition 2.10. (Bladt)</strong> <strong>(Phase-Type distribution)</strong> <em>Let</em></p>
<p><span class="math display">\[
\tau = \inf\{t\ge 0 : X(t)=p+1\}
\]</span></p>
<p><em>denote the time until absorption of <span class="math inline">\(X\)</span>. The distribution of <span class="math inline">\(\tau\)</span> is then said to be an inhomogeneous phase-type distribution with representation <span class="math inline">\((\mathbf{\pi},\mathbf{T}(t))\)</span> and we write <span class="math inline">\(\tau \sim IPH(\mathbf{\pi},\mathbf{T}(t))\)</span>.</em></p>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 2.11. (Bladt)</strong> <em>We have the following decomposition:</em></p>
<p><span class="math display">\[
\mathbf{P}(s,t)=\prod_s^t(\mathbf{I}+\mathbf{\Lambda}(u)\ du)=
\begin{bmatrix}
\prod_s^t(\mathbf{I}+\mathbf{T}(u)\ du) &amp; \mathbf{e} -\prod_s^t(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{e}\\
\mathbf{0} &amp; 1
\end{bmatrix},
\]</span></p>
<p><em>where <span class="math inline">\(\mathbf{e}=(1,1,...,1)^\top\)</span>.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 2.12. (Bladt)</strong> <em>Assume that <span class="math inline">\(\tau \sim IPH(\mathbf{\pi},\mathbf{T}(t))\)</span>. Then the density <span class="math inline">\(f\)</span> and the distribution function <span class="math inline">\(F\)</span> of <span class="math inline">\(\tau\)</span> are given by</em>
<span class="math display">\[\begin{align*}
f(x)&amp;=\mathbf{\pi}\prod_0^x(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{t}(x),\\
F(x)&amp;=1-\mathbf{\pi}\prod_0^x(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{e}.
\end{align*}\]</span></p>
</blockquote>
<details>
<summary>
<strong>Proof.</strong>
</summary>
</details>
<blockquote class="thm">
<p><strong>Theorem 2.13. (Bladt)</strong> <em>If <span class="math inline">\(\tau \sim IPH(\mathbf{\pi},\mathbf{T}(t))\)</span> then</em></p>
<p><span class="math display">\[
P(\tau &gt;s+t\ \vert\ \tau &gt;s)=\frac{\mathbf{\pi}\prod_0^s(\mathbf{I}+\mathbf{T}(u)\ du)}{\mathbf{\pi}\prod_0^s(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{e}}\prod_s^t(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{e}
\]</span></p>
<p><em>so that</em></p>
<p><span class="math display">\[
\tau-s\ \vert\ \{\tau&gt;s\}\sim IPH(\mathbf{\alpha},\mathbf{S}(\cdot)),
\]</span></p>
<p><em>where <span class="math inline">\(\mathbf{S}(u)=\mathbf{T}(s+u)\)</span> and </em></p>
<p><span class="math display">\[
\mathbf{\alpha}=\frac{\mathbf{\pi}\prod_0^s(\mathbf{I}+\mathbf{T}(u)\ du)}{\mathbf{\pi}\prod_0^s(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{e}}.
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Corollary 2.14. (Bladt)</strong> <em>If <span class="math inline">\(\tau\sim IPH(\mathbf{\alpha},\mathbf{T}(t))\)</span> and <span class="math inline">\(\mathbf{T}(t_1)\)</span> and <span class="math inline">\(\mathbf{T}(t_2)\)</span> commute for all <span class="math inline">\(t_1,t_2\ge 0\)</span>, then the density <span class="math inline">\(f\)</span> and the distribution function <span class="math inline">\(F\)</span> of <span class="math inline">\(\tau\)</span> are given by</em>
<span class="math display">\[\begin{align*}
f(x)&amp;=\mathbf{\pi}\exp\left(\int_0^x\mathbf{T}(u)\ du\right)\mathbf{t}(x),\\
F(x)&amp;=1-\mathbf{\pi}\exp\left(\int_0^x\mathbf{T}(u)\ du\right)\mathbf{e}.
\end{align*}\]</span></p>
</blockquote>
<details>
<summary>
<strong>Example (Approximation in time-inhomogeneous case).</strong>
</summary>
<p>Consider the Markov jump process on the state space <span class="math inline">\(E=\{1,2,3\}\)</span> where 1 is the state <em>“alive”</em> (working), 2 is <em>“disabled”</em> and 3 is the state <em>“death”</em>. We assume that <span class="math inline">\(\Lambda(t)\)</span> has the structure:
<span class="math display">\[\begin{align*}
\Lambda(t)&amp;=\begin{bmatrix}
\mu_{11}(t) &amp; \mu_{12}(t) &amp; \mu_{13}(t)\\
\mu_{21}(t) &amp; \mu_{22}(t) &amp; \mu_{23}(t)\\
\mu_{31}(t) &amp; \mu_{32}(t) &amp; \mu_{33}(t)
\end{bmatrix}\\
&amp;=
\begin{bmatrix}
-\mu_{12}(t)-\mu_{13}(t) &amp;  0.000015 + 10^{(4.6-10+0.015\cdot t)} &amp; 0.00005 + 10^{(4.6-10+0.05\cdot t)}\\
0.000005 + 10^{(4.6-10+0.015\cdot t)} &amp; -\mu_{21}(t)-\mu_{23}(t) &amp; 0.0001 + 10^{(4.6-10+0.05\cdot t)}\\
0 &amp; 0 &amp; 0
\end{bmatrix}
\end{align*}\]</span>
We can now implement this intensity matrix as a function in R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="phase-type-distributions.html#cb1-1" aria-hidden="true" tabindex="-1"></a>mu12 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-2"><a href="phase-type-distributions.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000015</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">4.6</span><span class="dv">-10</span><span class="fl">+0.015</span><span class="sc">*</span>t)</span>
<span id="cb1-3"><a href="phase-type-distributions.html#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-4"><a href="phase-type-distributions.html#cb1-4" aria-hidden="true" tabindex="-1"></a>mu13 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-5"><a href="phase-type-distributions.html#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.00005</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">4.6</span><span class="dv">-10</span><span class="fl">+0.05</span><span class="sc">*</span>t)</span>
<span id="cb1-6"><a href="phase-type-distributions.html#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="phase-type-distributions.html#cb1-7" aria-hidden="true" tabindex="-1"></a>mu11 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-8"><a href="phase-type-distributions.html#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">mu12</span>(t)<span class="sc">-</span><span class="fu">mu13</span>(t)</span>
<span id="cb1-9"><a href="phase-type-distributions.html#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="phase-type-distributions.html#cb1-10" aria-hidden="true" tabindex="-1"></a>mu21 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-11"><a href="phase-type-distributions.html#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.000005</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">4.6</span><span class="dv">-10</span><span class="fl">+0.015</span><span class="sc">*</span>t)</span>
<span id="cb1-12"><a href="phase-type-distributions.html#cb1-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-13"><a href="phase-type-distributions.html#cb1-13" aria-hidden="true" tabindex="-1"></a>mu23 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-14"><a href="phase-type-distributions.html#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.0001</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fl">4.6</span><span class="dv">-10</span><span class="fl">+0.05</span><span class="sc">*</span>t)</span>
<span id="cb1-15"><a href="phase-type-distributions.html#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="phase-type-distributions.html#cb1-16" aria-hidden="true" tabindex="-1"></a>mu22 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-17"><a href="phase-type-distributions.html#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">mu21</span>(t)<span class="sc">-</span><span class="fu">mu23</span>(t)</span>
<span id="cb1-18"><a href="phase-type-distributions.html#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="phase-type-distributions.html#cb1-19" aria-hidden="true" tabindex="-1"></a>mu31 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="dv">0</span>}</span>
<span id="cb1-20"><a href="phase-type-distributions.html#cb1-20" aria-hidden="true" tabindex="-1"></a>mu32 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="dv">0</span>}</span>
<span id="cb1-21"><a href="phase-type-distributions.html#cb1-21" aria-hidden="true" tabindex="-1"></a>mu33 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="dv">0</span>}</span>
<span id="cb1-22"><a href="phase-type-distributions.html#cb1-22" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb1-23"><a href="phase-type-distributions.html#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb1-24"><a href="phase-type-distributions.html#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mu11</span>(t),<span class="fu">mu21</span>(t),<span class="fu">mu31</span>(t),</span>
<span id="cb1-25"><a href="phase-type-distributions.html#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mu12</span>(t),<span class="fu">mu22</span>(t),<span class="fu">mu32</span>(t),</span>
<span id="cb1-26"><a href="phase-type-distributions.html#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mu13</span>(t),<span class="fu">mu23</span>(t),<span class="fu">mu33</span>(t)),</span>
<span id="cb1-27"><a href="phase-type-distributions.html#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb1-28"><a href="phase-type-distributions.html#cb1-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-29"><a href="phase-type-distributions.html#cb1-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-30"><a href="phase-type-distributions.html#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">M</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##               [,1]          [,2]         [,3]
## [1,] -7.296214e-05  1.898107e-05 5.398107e-05
## [2,]  8.981072e-06 -1.129621e-04 1.039811e-04
## [3,]  0.000000e+00  0.000000e+00 0.000000e+00</code></pre>
<p>We see that the intensities is choosen such that the following holds for any time interval <span class="math inline">\([t,t+dt)\)</span></p>
<ol style="list-style-type: decimal">
<li>The transition <span class="math inline">\(1\to 3\)</span> is less likely than <span class="math inline">\(2\to 3\)</span>,</li>
<li>The transition <span class="math inline">\(2\to 1\)</span> is less likely than <span class="math inline">\(1\to 2\)</span>,</li>
<li>The transition <span class="math inline">\(1\to 2\)</span> is less likely than <span class="math inline">\(1\to 3\)</span>.</li>
</ol>
<p>We now wish to compute the density and distribution of</p>
<p><span class="math display">\[
\tau =\inf\{t\ge 0\ :\ X(t)=3\}.
\]</span></p>
<p>We assume that <span class="math inline">\(\pi=(1,0)\)</span> i.e. the person is alive. Calculating the distribution of <span class="math inline">\(\tau\)</span> is then the distribution of the length of a newborn child lifespan. From theorem 2.12 this ammount to calculating the product integral of</p>
<p><span class="math display">\[
\mathbf{T}(t)=\{\mu_{ij}(t)\}_{i,j\in \{1,2\}}
\]</span></p>
<p>i.e. </p>
<p><span class="math display">\[
\prod_0^x(\mathbf{I}+\mathbf{T}(u)\ du).
\]</span></p>
<p>To du this we simply approximate with stepsize <span class="math inline">\(h=1/n\)</span> (for some <span class="math inline">\(n\ge 1\)</span>) by</p>
<p><span class="math display">\[
\prod_0^{x+h}(\mathbf{I}+\mathbf{T}(u)\ du)=h\prod_0^x(\mathbf{I}+\mathbf{T}(u)\ du)\mathbf{T}(x)+\prod_0^x(\mathbf{I}+\mathbf{T}(u)\ du),
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\prod_0^0(\mathbf{I}+\mathbf{T}(u)\ du)=\mathbf{I}.
\]</span></p>
<p>This is done in the code below</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="phase-type-distributions.html#cb3-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co">#monthly</span></span>
<span id="cb3-2"><a href="phase-type-distributions.html#cb3-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n</span>
<span id="cb3-3"><a href="phase-type-distributions.html#cb3-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">120</span> <span class="co">#max number years</span></span>
<span id="cb3-4"><a href="phase-type-distributions.html#cb3-4" aria-hidden="true" tabindex="-1"></a>T_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb3-5"><a href="phase-type-distributions.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb3-6"><a href="phase-type-distributions.html#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mu11</span>(t),<span class="fu">mu21</span>(t),</span>
<span id="cb3-7"><a href="phase-type-distributions.html#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mu12</span>(t),<span class="fu">mu22</span>(t)),</span>
<span id="cb3-8"><a href="phase-type-distributions.html#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb3-9"><a href="phase-type-distributions.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-10"><a href="phase-type-distributions.html#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-11"><a href="phase-type-distributions.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">T_matrix</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##               [,1]          [,2]
## [1,] -7.296214e-05  1.898107e-05
## [2,]  8.981072e-06 -1.129621e-04</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="phase-type-distributions.html#cb5-1" aria-hidden="true" tabindex="-1"></a>t_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb5-2"><a href="phase-type-distributions.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb5-3"><a href="phase-type-distributions.html#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mu13</span>(t),<span class="fu">mu23</span>(t)),</span>
<span id="cb5-4"><a href="phase-type-distributions.html#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol=</span><span class="dv">1</span></span>
<span id="cb5-5"><a href="phase-type-distributions.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-6"><a href="phase-type-distributions.html#cb5-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-7"><a href="phase-type-distributions.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">t_matrix</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 5.398107e-05
## [2,] 1.039811e-04</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="phase-type-distributions.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlist)</span>
<span id="cb7-2"><a href="phase-type-distributions.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Initial condition t=0</span></span>
<span id="cb7-3"><a href="phase-type-distributions.html#cb7-3" aria-hidden="true" tabindex="-1"></a>T_product_integral <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb7-4"><a href="phase-type-distributions.html#cb7-4" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb7-5"><a href="phase-type-distributions.html#cb7-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">t</span>(pi) <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%*%</span> <span class="fu">t_matrix</span>(<span class="dv">0</span>)</span>
<span id="cb7-6"><a href="phase-type-distributions.html#cb7-6" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">t</span>(pi) <span class="sc">%*%</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="sc">%*%</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb7-7"><a href="phase-type-distributions.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="sc">*</span>n)) {</span>
<span id="cb7-8"><a href="phase-type-distributions.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  x_1 <span class="ot">&lt;-</span> i<span class="sc">/</span>n</span>
<span id="cb7-9"><a href="phase-type-distributions.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  x_0 <span class="ot">&lt;-</span> (i<span class="dv">-1</span>)<span class="sc">/</span>n</span>
<span id="cb7-10"><a href="phase-type-distributions.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  T_0 <span class="ot">&lt;-</span> <span class="fu">T_matrix</span>(x_0)</span>
<span id="cb7-11"><a href="phase-type-distributions.html#cb7-11" aria-hidden="true" tabindex="-1"></a>  M_0 <span class="ot">&lt;-</span> T_product_integral[[i]]</span>
<span id="cb7-12"><a href="phase-type-distributions.html#cb7-12" aria-hidden="true" tabindex="-1"></a>  M_1 <span class="ot">&lt;-</span> h<span class="sc">*</span>M_0 <span class="sc">%*%</span> T_0 <span class="sc">+</span> M_0</span>
<span id="cb7-13"><a href="phase-type-distributions.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  T_product_integral <span class="ot">&lt;-</span> <span class="fu">list.append</span>(T_product_integral,M_1)</span>
<span id="cb7-14"><a href="phase-type-distributions.html#cb7-14" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">c</span>(f,<span class="fu">t</span>(pi) <span class="sc">%*%</span> M_1 <span class="sc">%*%</span> <span class="fu">t_matrix</span>(x_1))</span>
<span id="cb7-15"><a href="phase-type-distributions.html#cb7-15" aria-hidden="true" tabindex="-1"></a>  F <span class="ot">&lt;-</span> <span class="fu">c</span>(F,<span class="dv">1</span><span class="sc">-</span><span class="fu">t</span>(pi) <span class="sc">%*%</span> M_1 <span class="sc">%*%</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">ncol =</span> <span class="dv">1</span>))</span>
<span id="cb7-16"><a href="phase-type-distributions.html#cb7-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="figures/ex1_PT_dist.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We see that by calculating</p>
<p><span class="math display">\[
E[\tau\ \vert\ X_0=1]=\int_0^\infty \tau f(\tau)\ d\tau\approx\int_0^{120}\tau f(\tau)\ d\tau\approx\frac{1}{n}\sum_{i=0}^{120\cdot n} i/n\cdot f(i/n).
\]</span></p>
<p>that the life expectation is 84.01 years. We have that we may approximate <span class="math inline">\(f\)</span> and <span class="math inline">\(F\)</span> with an arbitrary precision by choosing <span class="math inline">\(n\)</span> appropriately. <span class="math inline">\(\square\)</span></p>
</details>
<p>I practice we may have alot complications in calculating the product integral of <span class="math inline">\(\mathbf T\)</span> as the matrix may have large dimensions, be non-cummative, encounter alternating sums with growing terms and obviously being time in-homogeneous. So one has to be smart when constructing numerical methods in computing the integral. We will briefly consider some considerations an implementer may use in calculating the product integral.</p>
<ol style="list-style-type: decimal">
<li><strong>Applying differential equation.</strong> Assume that <span class="math inline">\(X\)</span> is a time in-homogeneous markov jump process then we may always calculate <span class="math inline">\(\prod_s^t(\mathbf I + \mathbf T(x)\ dx)\)</span> using a stepwise argument:
<span class="math display">\[
  \prod_s^t(\mathbf I + \mathbf T(x)\ dx)=\prod_s^{s+1\cdot (t-s)/n}(\mathbf I + \mathbf T(x)\ dx)\prod_s^{s+2\cdot (t-s)/n}(\mathbf I + \mathbf T(x)\ dx)\cdots\prod_s^{t}(\mathbf I + \mathbf T(x)\ dx)
  \]</span>
for some <span class="math inline">\(n\ge 1\)</span>. In particular one can simply choose <span class="math inline">\(n\)</span> large enough such that the increments is approximately linear and so this is a brute force methods (see example above).</li>
<li><strong>Piece wise constant matrix.</strong> Since data is scarce it often occur that mortality rates are constant over at least a monthly timeline hence one may assume that <span class="math inline">\(\Lambda\)</span> is piecewise constant for some fine grid. This in particular means that if the grid has size <span class="math inline">\(1/n\)</span> (for instance <span class="math inline">\(n=12\)</span> or <span class="math inline">\(n=4\)</span>) we have
<span class="math display">\[
  \prod_s^{s+1/n}(\mathbf I + \mathbf T(x)\ dx)=\mathbf{I}e^{\mathbf{T}(s)\frac{1}{n}}=e^{\mathbf{T}(s)\frac{1}{n}}.
  \]</span>
and so the above reduces to
<span class="math display">\[
  \prod_s^t(\mathbf I + \mathbf T(x)\ dx)=e^{\mathbf{T}(s)\frac{1}{n}}e^{\mathbf{T}(s+1/n)\frac{1}{n}}\cdots e^{\mathbf{T}(t-1/n)\frac{1}{n}},
  \]</span>
assuming that <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> are integers (one could make this more general).</li>
<li><strong>Diagonalization.</strong> Assume that <span class="math inline">\(\mathbf{T}(x)\)</span> is constant on some interval <span class="math inline">\([s,t]\)</span> and that for the constant matrix <span class="math inline">\(\mathbf{T}:=\mathbf{T}(s)\)</span> there exist unique eigenvalues <span class="math inline">\(\lambda_1,...,\lambda_p\)</span>. Then we can diagonalize <span class="math inline">\(\mathbf{T}\)</span> as
<span class="math display">\[
  \mathbf{T}=\mathbf{B}\mathbf{D}\mathbf{B}^{-1},
  \]</span>
where as usual <span class="math inline">\(\mathbf{D}=\text{diag}(\lambda_1,...,\lambda_p)\)</span> and <span class="math inline">\(\mathbf{B}\)</span> is a <span class="math inline">\(p\times p\)</span> matrix with columns of eigenvectors for <span class="math inline">\(\lambda_1,...,\lambda_p\)</span>. In this case we can calculate
<span class="math display">\[\begin{align*}
  \prod_s^t(\mathbf I + \mathbf T(x)\ dx)&amp;=e^{\mathbf{T}(t-s)}=e^{\mathbf{B}\mathbf{D}\mathbf{B}^{-1}(t-s)}=\sum_{n=0}^\infty \frac{\left(\mathbf{B}\mathbf{D}\mathbf{B}^{-1}\right)^n(t-s)^n}{n!}\\
  &amp;=\sum_{n=0}^\infty \frac{\mathbf{B}\mathbf{D}\mathbf{B}^{-1}\mathbf{B}\mathbf{D}\mathbf{B}^{-1}\cdots \mathbf{B}\mathbf{D}\mathbf{B}^{-1}\mathbf{B}\mathbf{D}\mathbf{B}^{-1}(t-s)^n}{n!}\\
  &amp;=\sum_{n=0}^\infty \frac{\mathbf{B}\mathbf{D}^n\mathbf{B}^{-1}(t-s)^n}{n!}=\mathbf{B}\left(\sum_{n=0}^\infty \frac{\mathbf{D}^n(t-s)^n}{n!}\right)\mathbf{B}^{-1}\\
  &amp;=\mathbf{B}\left(\sum_{n=0}^\infty \frac{\text{diag}(\lambda_1^n(t-s)^n,...,\lambda_p^n(t-s)^n)}{n!}\right)\mathbf{B}^{-1}\\
  &amp;=\mathbf{B}\text{diag}\left(\sum_{n=0}^\infty \frac{\lambda_1^n(t-s)^n}{n!},...,\sum_{n=0}^\infty \frac{\lambda_p^n(t-s)^n}{n!}\right)\mathbf{B}^{-1}\\
  &amp;=\mathbf{B}\text{diag}\left(e^{\lambda_1(t-s)},...,e^{\lambda_p(t-s)}\right)\mathbf{B}^{-1}.
  \end{align*}\]</span>
which is much easier than any approximation. This is however a unrealisitic expectations to have.</li>
<li><strong>Univerformization.</strong> Assume that <span class="math inline">\(\mathbf{T}(x)\)</span> is constant on some interval <span class="math inline">\([s,t]\)</span> and define <span class="math inline">\(\mathbf{T}:=\mathbf{T}(s)\)</span>. We may furthermore define <span class="math inline">\(\lambda= \max_{i}(-\lambda_{ii})\)</span> as the largest diagonal entry in <span class="math inline">\(\mathbf T\)</span> (<span class="math inline">\(\lambda &lt;0\)</span>). We now set
<span class="math display">\[
  \mathbf P = \mathbf I + \lambda^{-1}\mathbf T,
  \]</span>
and see that <span class="math inline">\(\mathbf P\)</span> is a transition matrix i.e. rowsums is 1 and the the diagonals <span class="math inline">\(0\le p_{ii}\le 1\)</span>. We see this as <span class="math inline">\(0\le \lambda^{-1}\lambda_{ii}\le1\)</span> as <span class="math inline">\(\lambda_{ii}\le 0\)</span> for all <span class="math inline">\(i\)</span> and <span class="math inline">\(\lambda\ge 0\)</span> and dominates all diagonal entries. The rowsums is 1 as <span class="math inline">\(\mathbf T\)</span> is a intensity matrix i.e. rowsums is 0 and so adding one to the diagonal of the scaled matrix gives a rowsum of 1. We can now rearrange and see that
<span class="math display">\[\begin{align*}
  \prod_s^t(\mathbf I + \mathbf T(x)\ dx)&amp;=e^{\mathbf{T}(t-s)}=e^{\lambda (\mathbf P - \mathbf I)(t-s)}=e^{\lambda \mathbf P (t-s)}e^{-\lambda \mathbf I(t-s)}\\
  &amp;=e^{\lambda \mathbf P (t-s)}\mathbf Ie^{-\lambda (t-s)}=e^{-\lambda (t-s)}e^{\lambda \mathbf P (t-s)}\\
  &amp;=e^{-\lambda (t-s)}\sum_{n=0}^\infty \frac{(t-s)^n}{n!}\mathbf{P}^n.
  \end{align*}\]</span>
This is nice since <span class="math inline">\(\mathbf P\)</span> has entries in the interval <span class="math inline">\([0,1]\)</span> and so the series above converges and is monotonic, so we avoid the alternating sums from the negative diagonal in <span class="math inline">\(\mathbf T\)</span>.</li>
<li><strong>Scaling and squaring argument.</strong> Assuming the setup above. If the interval <span class="math inline">\((t-s)\)</span> is large we may apply a scaling and squaring argument by setting
<span class="math display">\[
  e^{\mathbf T(t-s)}=\mathbf{S}^{2^n},\hspace{15pt}\mathbf{S}=e^{\mathbf T (t-s)2^{-n}}.
  \]</span>
This ensures small entries in the matrix <span class="math inline">\(S\)</span> and we can simply square <span class="math inline">\(\mathbf S\)</span> <span class="math inline">\(n\)</span> times after approximating <span class="math inline">\(\mathbf S\)</span> numerically.</li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="markov-jump-processes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interest-rates.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
