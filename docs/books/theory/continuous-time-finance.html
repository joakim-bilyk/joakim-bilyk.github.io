<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Continuous Time Finance | Complete Theory</title>
  <meta name="description" content="Chapter 5 Continuous Time Finance | Complete Theory" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Continuous Time Finance | Complete Theory" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Continuous Time Finance | Complete Theory" />
  
  
  

<meta name="author" content="Joakim Bilyk" />


<meta name="date" content="2023-02-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="topics-in-life-insurance-mathematics.html"/>
<link rel="next" href="basic-non-life-insurance-mathematics.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

<script>
    $(function() {
        var element = document.body;
        if (localStorage.chkbx && localStorage.chkbx != '') {
            $('#remember_me').attr('checked', 'checked');
            element.classList.toggle("dark-mode");
            document.querySelector('.book-header.fixed').click();
        } else {
            $('#remember_me').removeAttr('checked');
            document.querySelector('.book-header.fixed').click();
        }

        $('#remember_me').click(function() {

            if ($('#remember_me').is(':checked')) {
                // save username and password
                localStorage.chkbx = $('#remember_me').val();
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            } else {
                localStorage.chkbx = '';
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            }
        });
    });

</script>

<div class = "sticky-darkmode-toggle">
  <label class="switch">
  <input type="checkbox" value="remember-me" id="remember_me">
  <span class="slider round">
  </span>
  </label>
</div>

<script>
$(function() {
  $('body').after($('.sticky-darkmode-toggle'));
})
</script>

<style>

.sticky-darkmode-toggle {
  position: fixed;
  right: 20px;
  bottom: 20px;
}
</style>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Comlete theory</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#abbreviations"><i class="fa fa-check"></i><b>1.1</b> Abbreviations</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#to-do-reading"><i class="fa fa-check"></i><b>1.2</b> To-do reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-life-insurance-mathematics.html"><a href="basic-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>2</b> Basic Life Insurance Mathematics</a></li>
<li class="chapter" data-level="3" data-path="stochastic-processes-in-life-insurance-mathematics.html"><a href="stochastic-processes-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>3</b> Stochastic Processes in Life Insurance Mathematics</a></li>
<li class="chapter" data-level="4" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>4</b> Topics in Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html#markov-jump-processes"><i class="fa fa-check"></i><b>4.1</b> Markov Jump Processes</a></li>
<li class="chapter" data-level="4.2" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html#phase-type-distributions"><i class="fa fa-check"></i><b>4.2</b> Phase-type distributions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html"><i class="fa fa-check"></i><b>5</b> Continuous Time Finance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#discrete-time-models"><i class="fa fa-check"></i><b>5.1</b> Discrete time models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#one-period-time-models"><i class="fa fa-check"></i><b>5.1.1</b> One-period time models</a></li>
<li class="chapter" data-level="5.1.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#multi-period-model"><i class="fa fa-check"></i><b>5.1.2</b> Multi-period model</a></li>
<li class="chapter" data-level="5.1.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#generelised-one-period-model"><i class="fa fa-check"></i><b>5.1.3</b> Generelised one-period model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#self-financing-portfolios"><i class="fa fa-check"></i><b>5.2</b> Self-financing portfolios</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#discrete-time-sf-portfolio"><i class="fa fa-check"></i><b>5.2.1</b> Discrete time SF portfolio</a></li>
<li class="chapter" data-level="5.2.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#continuous-time-sf-portfolio"><i class="fa fa-check"></i><b>5.2.2</b> Continuous time SF portfolio</a></li>
<li class="chapter" data-level="5.2.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#portfolio-weights"><i class="fa fa-check"></i><b>5.2.3</b> Portfolio weights</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#black-scholes-pde"><i class="fa fa-check"></i><b>5.3</b> Black-Scholes PDE</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#contingent-claims-and-arbitrage"><i class="fa fa-check"></i><b>5.3.1</b> Contingent Claims and Arbitrage</a></li>
<li class="chapter" data-level="5.3.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#risk-neutral-valuation-1"><i class="fa fa-check"></i><b>5.3.2</b> Risk Neutral Valuation</a></li>
<li class="chapter" data-level="5.3.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#black-scholes-formula"><i class="fa fa-check"></i><b>5.3.3</b> Black-Scholes formula</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#completeness-and-hedging"><i class="fa fa-check"></i><b>5.4</b> Completeness and Hedging</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#completeness-in-black-scholes"><i class="fa fa-check"></i><b>5.4.1</b> Completeness in Black-Scholes</a></li>
<li class="chapter" data-level="5.4.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#absence-of-arbitrage-1"><i class="fa fa-check"></i><b>5.4.2</b> Absence of Arbitrage</a></li>
<li class="chapter" data-level="5.4.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#incomplete-markets"><i class="fa fa-check"></i><b>5.4.3</b> Incomplete Markets</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#parity-relations"><i class="fa fa-check"></i><b>5.5</b> Parity relations</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#put-call-parity"><i class="fa fa-check"></i><b>5.5.1</b> Put-call Parity</a></li>
<li class="chapter" data-level="5.5.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#the-greeks"><i class="fa fa-check"></i><b>5.5.2</b> The Greeks</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#fundamental-pricing-theorem-i-and-ii"><i class="fa fa-check"></i><b>5.6</b> Fundamental pricing theorem I and II</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#completeness-1"><i class="fa fa-check"></i><b>5.6.1</b> Completeness</a></li>
<li class="chapter" data-level="5.6.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#risk-neutral-valuation-formula"><i class="fa fa-check"></i><b>5.6.2</b> Risk Neutral Valuation Formula</a></li>
<li class="chapter" data-level="5.6.3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#stochastic-discount-factors-1"><i class="fa fa-check"></i><b>5.6.3</b> Stochastic Discount Factors</a></li>
<li class="chapter" data-level="5.6.4" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#summary"><i class="fa fa-check"></i><b>5.6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#mathematics-of-the-martingale-approach"><i class="fa fa-check"></i><b>5.7</b> Mathematics of the martingale approach</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#martingale-representation-theorem"><i class="fa fa-check"></i><b>5.7.1</b> Martingale representation theorem</a></li>
<li class="chapter" data-level="5.7.2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#girsanov-theorem"><i class="fa fa-check"></i><b>5.7.2</b> Girsanov theorem</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#black-scholes-model---martingale-approach"><i class="fa fa-check"></i><b>5.8</b> Black-Scholes model - martingale approach</a></li>
<li class="chapter" data-level="5.9" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html#multidimensional-models"><i class="fa fa-check"></i><b>5.9</b> Multidimensional models</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basic-non-life-insurance-mathematics.html"><a href="basic-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>6</b> Basic Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="7" data-path="stochastic-processes-in-non-life-insurance-mathematics.html"><a href="stochastic-processes-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>7</b> Stochastic Processes in Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="8" data-path="topics-in-non-life-insurance-mathematics.html"><a href="topics-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>8</b> Topics in Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="9" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html"><i class="fa fa-check"></i><b>9</b> Probabilistic Machine Learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#supervised-learning"><i class="fa fa-check"></i><b>9.1</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#what-is-a-good-estimator"><i class="fa fa-check"></i><b>9.1.1</b> What is a good estimator?</a></li>
<li class="chapter" data-level="9.1.2" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#excess-risk"><i class="fa fa-check"></i><b>9.1.2</b> Excess risk</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#training-validating-and-testing"><i class="fa fa-check"></i><b>9.2</b> Training, Validating and Testing</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#estimating-risk"><i class="fa fa-check"></i><b>9.2.1</b> Estimating risk</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html#linear-models"><i class="fa fa-check"></i><b>9.3</b> Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html"><i class="fa fa-check"></i><b>10</b> Quantative Risk Management</a>
<ul>
<li class="chapter" data-level="10.1" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html#the-loss-variable"><i class="fa fa-check"></i><b>10.1</b> The Loss Variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html#risk-measures"><i class="fa fa-check"></i><b>10.1.1</b> Risk measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="measure-theory.html"><a href="measure-theory.html"><i class="fa fa-check"></i><b>11</b> Measure theory</a>
<ul>
<li class="chapter" data-level="11.1" data-path="measure-theory.html"><a href="measure-theory.html#axioms-of-probability"><i class="fa fa-check"></i><b>11.1</b> Axioms of Probability</a></li>
<li class="chapter" data-level="11.2" data-path="measure-theory.html"><a href="measure-theory.html#conditional-probability-and-independence"><i class="fa fa-check"></i><b>11.2</b> Conditional Probability and Independence</a></li>
<li class="chapter" data-level="11.3" data-path="measure-theory.html"><a href="measure-theory.html#equivalent-probability-measures"><i class="fa fa-check"></i><b>11.3</b> Equivalent Probability Measures</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="measure-theory.html"><a href="measure-theory.html#the-radon-nikodym-theorem"><i class="fa fa-check"></i><b>11.3.1</b> The Radon-Nikodym Theorem</a></li>
<li class="chapter" data-level="11.3.2" data-path="measure-theory.html"><a href="measure-theory.html#equivalent-probability-measures-1"><i class="fa fa-check"></i><b>11.3.2</b> Equivalent Probability Measures</a></li>
<li class="chapter" data-level="11.3.3" data-path="measure-theory.html"><a href="measure-theory.html#likelihood-processes"><i class="fa fa-check"></i><b>11.3.3</b> Likelihood processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>12</b> Random Variables</a>
<ul>
<li class="chapter" data-level="12.1" data-path="random-variables.html"><a href="random-variables.html#introduction-1"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="random-variables.html"><a href="random-variables.html#conditional-expectation"><i class="fa fa-check"></i><b>12.2</b> Conditional expectation</a></li>
<li class="chapter" data-level="12.3" data-path="random-variables.html"><a href="random-variables.html#independence"><i class="fa fa-check"></i><b>12.3</b> Independence</a></li>
<li class="chapter" data-level="12.4" data-path="random-variables.html"><a href="random-variables.html#moment-generating-function"><i class="fa fa-check"></i><b>12.4</b> Moment generating function</a></li>
<li class="chapter" data-level="12.5" data-path="random-variables.html"><a href="random-variables.html#standard-distributions"><i class="fa fa-check"></i><b>12.5</b> Standard distributions</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="random-variables.html"><a href="random-variables.html#normal-disribution"><i class="fa fa-check"></i><b>12.5.1</b> Normal disribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html"><i class="fa fa-check"></i><b>13</b> Discrete Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="13.1" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html#convergence-concepts"><i class="fa fa-check"></i><b>13.1</b> Convergence concepts</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html#sums-and-average-processes"><i class="fa fa-check"></i><b>13.1.1</b> Sums and average processes</a></li>
<li class="chapter" data-level="13.1.2" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html#ergodic-theory"><i class="fa fa-check"></i><b>13.1.2</b> Ergodic Theory</a></li>
<li class="chapter" data-level="13.1.3" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html#weak-convergence"><i class="fa fa-check"></i><b>13.1.3</b> Weak Convergence</a></li>
<li class="chapter" data-level="13.1.4" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html#central-limit-theorems"><i class="fa fa-check"></i><b>13.1.4</b> Central Limit Theorems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html"><i class="fa fa-check"></i><b>14</b> Continuous Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="14.1" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html#brownian-motion"><i class="fa fa-check"></i><b>14.1</b> Brownian Motion</a></li>
<li class="chapter" data-level="14.2" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html#filtration"><i class="fa fa-check"></i><b>14.2</b> Filtration</a></li>
<li class="chapter" data-level="14.3" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html#martingale"><i class="fa fa-check"></i><b>14.3</b> Martingale</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html"><i class="fa fa-check"></i><b>15</b> Stochastic calculus</a>
<ul>
<li class="chapter" data-level="15.1" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#stochastic-integrals"><i class="fa fa-check"></i><b>15.1</b> Stochastic Integrals</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#information"><i class="fa fa-check"></i><b>15.1.1</b> Information</a></li>
<li class="chapter" data-level="15.1.2" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#stochastic-integrals-1"><i class="fa fa-check"></i><b>15.1.2</b> Stochastic Integrals</a></li>
<li class="chapter" data-level="15.1.3" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#martingales"><i class="fa fa-check"></i><b>15.1.3</b> Martingales</a></li>
<li class="chapter" data-level="15.1.4" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#stochastic-calculus-and-the-ito-formula"><i class="fa fa-check"></i><b>15.1.4</b> Stochastic Calculus and the Ito Formula</a></li>
<li class="chapter" data-level="15.1.5" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#the-multidimensional-ito-formula"><i class="fa fa-check"></i><b>15.1.5</b> The multidimensional Ito Formula</a></li>
<li class="chapter" data-level="15.1.6" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#correlated-brownian-motions"><i class="fa fa-check"></i><b>15.1.6</b> Correlated Brownian motions</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#discrete-stochastic-integrals"><i class="fa fa-check"></i><b>15.2</b> Discrete Stochastic Integrals</a></li>
<li class="chapter" data-level="15.3" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#stochastic-differential-equations"><i class="fa fa-check"></i><b>15.3</b> Stochastic Differential Equations</a></li>
<li class="chapter" data-level="15.4" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#partial-differential-equations"><i class="fa fa-check"></i><b>15.4</b> Partial differential equations</a></li>
<li class="chapter" data-level="15.5" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#the-product-integral"><i class="fa fa-check"></i><b>15.5</b> The Product Integral</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html#properties-of-the-product-integral"><i class="fa fa-check"></i><b>15.5.1</b> Properties of the Product Integral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="linear-algebra.html"><a href="linear-algebra.html"><i class="fa fa-check"></i><b>16</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="16.1" data-path="linear-algebra.html"><a href="linear-algebra.html#invertible-matrices"><i class="fa fa-check"></i><b>16.1</b> Invertible matrices</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>17</b> Coding</a>
<ul>
<li class="chapter" data-level="17.1" data-path="coding.html"><a href="coding.html#r-packages"><i class="fa fa-check"></i><b>17.1</b> R-Packages</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="coding.html"><a href="coding.html#mlr3"><i class="fa fa-check"></i><b>17.1.1</b> mlr3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://joakim-bilyk.github.io/index.html">Back to main site</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Complete Theory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="continuous-time-finance" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Continuous Time Finance<a href="continuous-time-finance.html#continuous-time-finance" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This topic revolves around the theory of the Brownian motion and martingale processes. Other main topics are the binomial model and an introduction to financial derivatives. Financial derivatives is contingent on the outcome of a stochastic process at some future time <span class="math inline">\(t=T\)</span> and often is a function <span class="math inline">\(\Phi\)</span> of some assets price <span class="math inline">\(S_t\)</span>. As such the derivative will give a stochastic payout, at time <span class="math inline">\(t=T\)</span> of the size <span class="math inline">\(X_T=\Phi(S_T)\)</span>. Naturally we want to say something about the <em>fair</em> price of the derivative in the form of</p>
<p><span class="math display">\[\Pi_t(X_T)=\mathbb{E}\left[\Phi(S_T)\ \vert\ \mathcal{F}_t\right],\]</span></p>
<p>where <span class="math inline">\(\mathcal{F}_t\subset\mathcal{F}\)</span> is the available information at time <span class="math inline">\(t\)</span>. We will by defualt intepret the times <span class="math inline">\(t=0\)</span> as <em>today</em> and <span class="math inline">\(t=T\)</span> as <em>tomorrow</em>. This indeed require some fundamental understanding of the behaviour of the asset price <span class="math inline">\(S_t\)</span>. This lead us over to discussing the process in center of the <em>Black-Scholes</em> model: the Brownian motion.</p>
<div id="discrete-time-models" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Discrete time models<a href="continuous-time-finance.html#discrete-time-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="one-period-time-models" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> One-period time models<a href="continuous-time-finance.html#one-period-time-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The study of this course is the <strong>European call</strong> option (and <em>put</em> option). This financial derivative is an agreement between two parties where the holder of the option has the right to <em>“exercise”</em> the derivative, at a future time <span class="math inline">\(t=T\)</span>. Exercising means buying an asset at a certain agreed opon price-strike <span class="math inline">\(K\)</span>. In the case of the put-option: the holder has the right (but not obligation) to sell the asset at the strike price <span class="math inline">\(K\)</span>. As such the derivative has the payoff</p>
<p><span class="math display">\[\text{Call}\ \text{option:}\hspace{10pt}\Phi(S_T)=(S_T-K)^+,\hspace{20pt}\text{Put}\ \text{option:}\hspace{10pt}\Phi(S_T)=(K-S_T)^+.\]</span></p>
<p>Our objective is to understand when an arbitrage exist and to find the fair price of these derivative. The strategy in pricing is finding a replicating portfolio with the same payoff as the option (with probability one) and then price the derivative accordingly.</p>
<div id="model-description" class="section level4 hasAnchor" number="5.1.1.1">
<h4><span class="header-section-number">5.1.1.1</span> Model description<a href="continuous-time-finance.html#model-description" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the one-period model we consider the simplest possible market. We have two distinct times <span class="math inline">\(t=0\)</span> (today) and <span class="math inline">\(t=1\)</span> (tomorrow) and we may buy any portfolio as a mixture of bonds and one stock. We denote the bonds price by <span class="math inline">\(B_t\)</span> and the stocks price by <span class="math inline">\(S_t\)</span> and we assume the following:</p>
<p><span class="math display">\[
B_0=1,\ B_1=1+R,\hspace{20pt}S_0=s,\ S_1=\left\{\begin{matrix}s\cdot u, &amp; with\ probability\ p_u.\\s\cdot d, &amp; with\ probability\ p_d.\end{matrix}\right.
\]</span></p>
<p>We may introduce <span class="math inline">\(Z\)</span> as the random variable</p>
<p><span class="math display">\[
Z=u\cdot (I)+d\cdot (1-I),
\]</span></p>
<p>for an bernoulli variable <span class="math inline">\(I\)</span> with succes probability <span class="math inline">\(p_u\)</span>. Naturally, we assume <span class="math inline">\(d\le (1+R)\le u\)</span> (this is imperative to ensure no arbitrage as we will see).</p>
</div>
<div id="portfolios-and-arbirtage" class="section level4 hasAnchor" number="5.1.1.2">
<h4><span class="header-section-number">5.1.1.2</span> Portfolios and arbirtage<a href="continuous-time-finance.html#portfolios-and-arbirtage" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We study any portfolio on the <span class="math inline">\((B,S)\)</span> market as a vector <span class="math inline">\(h=(x,y)\)</span> where <span class="math inline">\(x\)</span> is the amount of bonds and <span class="math inline">\(y\)</span> is the amount of stock held in the portfolio. Notice that we allow for shorting, that is <span class="math inline">\(x&lt;0\)</span> or <span class="math inline">\(y&lt;0\)</span>. As such, we have that <span class="math inline">\(h\in \mathbb{R}^2\)</span>. In this we have made some unrealistic, but attractable assumptions included in the assumptions:</p>
<ul>
<li>We allow short positions and fractional holding, i.e. <span class="math inline">\(h\in \mathbb{R}^2\)</span>,</li>
<li>We assume no spread between ask and bids,</li>
<li>No transaction costs and</li>
<li>A completely liquid market i.e. we may borrow and buy as much stock and bonds as wanted.</li>
</ul>
<p>Given that we have chosen a portfolio <span class="math inline">\(h\)</span> we may introduce the value process.</p>
<blockquote class="def">
<p><strong>Definition 2.1. (Bjork)</strong> <em>The <strong>value process</strong> of the porfolio <span class="math inline">\(h\in\mathbb{R}^2\)</span> is the stochastic process</em></p>
<p><span class="math display">\[V^h_t=xB_t+yS_t,\ t=0,1.\]</span></p>
</blockquote>
<p>Given this notation we may define what an arbitrage is.</p>
<blockquote class="def">
<p><strong>Definition 2.2. (Bjork)</strong> <em>An <strong>arbitrage</strong> is a portfolio <span class="math inline">\(h\)</span> with the properties: 1) <span class="math inline">\(V^h_0=0\)</span>, 2) <span class="math inline">\(P(V^h_1\ge 0)=1\)</span> and 3) <span class="math inline">\(P(V^h_1&gt;0)&gt;0\)</span>.</em></p>
</blockquote>
<p>That is <span class="math inline">\(h\)</span> is an deterministic money-machine where we at least never loose any money. Granted the bonds give a determinictic non-negative return, but an arbitrage does not require any money out of pocket. With the notion of an arbitrage we will show the first proposition regarding the choice of <span class="math inline">\(R,u,d\)</span> as defined above.</p>
<blockquote class="prop">
<p><strong>Proposition 2.3. (Bjork)</strong> <em>The one-period binomial model is arbitrage free if and only if the following inequality hold:</em></p>
<p><span class="math display">\[d\le (1+R)\le u.\tag{2.1}\]</span></p>
</blockquote>

<details>
<summary>
<strong>Proof.</strong>
</summary>
<p>The statement is proofed by contradiction. Assume that <span class="math inline">\(d&gt;1+R\)</span> holds. Then by definition <span class="math inline">\(u&gt;d&gt;1+R\)</span>. Notice that any portfolio satisfying <span class="math inline">\(V_0^h=0\)</span> must satisfy</p>
<p><span class="math display">\[0=xB_0+yS_0=x+ys\iff x=-ys\]</span></p>
<p>That is for some choice <span class="math inline">\(y\)</span> the only arbitrage candidate is the portfolio <span class="math inline">\(h=(-ys,y)\)</span>. Calculating the value at time <span class="math inline">\(t=1\)</span> we have</p>
<p><span class="math display">\[V_1^h=-ys\cdot(1+R)+y\cdot s\cdot Z=ys(Z-1-R)\]</span></p>
<p>However since <span class="math inline">\(Z\ge d\)</span> we have <span class="math inline">\(Z-(1+R)\ge 0\)</span> and therefore an arbitrage (for <span class="math inline">\(y&gt;0\)</span>). The other inequality <span class="math inline">\(1+R&gt;u\)</span> follows analog steps. Simply choose some <span class="math inline">\(y&lt;0\)</span> and the result follows. <span class="math inline">\(\blacksquare\)</span></p>
</details>
<p>
From inequality (2.1) we see that since <span class="math inline">\(1+R\)</span> is between <span class="math inline">\(u\)</span> and <span class="math inline">\(d\)</span> we may find a pair <span class="math inline">\(q_d,q_u\ge 0\)</span> with <span class="math inline">\(q_d+q_u=1\)</span> such that</p>
<p><span class="math display">\[1+R=q_u\cdot u+q_d\cdot d.\]</span></p>
<p>This yields the important risk neutral valuation formula as summed op in the following definition</p>
<blockquote class="def">
<p><strong>Definition 2.4. (Bjork)</strong> <em>A probability measure <span class="math inline">\(Q\)</span> is called a <strong>martingale meausre</strong> if the following condition holds:</em></p>
<p><span class="math display">\[S_0=\frac{1}{1+R}E^Q[S_1].\]</span></p>
</blockquote>
<p>The above measure <span class="math inline">\(Q\)</span> is the measure <span class="math inline">\(Q(Z=d)=q_d\)</span> and <span class="math inline">\(Q(Z=u)=q_u\)</span> for the binomial model. This does in fact yield the risk neautral valuation formula:
<span class="math display">\[\begin{align*}
S_0&amp;=\frac{1}{1+R}E^Q[S_1]=\frac{1}{1+R}(Q(Z=d)\cdot d\cdot s+Q(Z=u)\cdot u\cdot s)\\
&amp;=s\frac{1}{1+R}(q_d\cdot d+q_u\cdot u)=s,
\end{align*}\]</span>
where we simply use <span class="math inline">\(1+R=q_d\cdot d+q_u\cdot u\)</span>. We call this the risk neautral valuation formula because it in some sense gives an expected discounted value of the future stock price. We end this endavour with reformulating the arbitrage proposition and determining the values of the <span class="math inline">\(Q\)</span>-measure.</p>
<blockquote class="prop">
<p><strong>Proposition 2.5. (Bjork)</strong> <em>The one-period binomial model is arbitrage free if and only if there exists a martingale measure <span class="math inline">\(Q\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 2.6. (Bjork)</strong> <em>The one-period binomial model has martingale probabilities given by:</em></p>
<p><span class="math display">\[\left\{\begin{matrix}q_u=\frac{(1+R)-d}{u-d},\\ q_u=\frac{u-(1+R)}{u-d}.\end{matrix}\right.\]</span></p>
</blockquote>
</div>
<div id="contingent-claims" class="section level4 hasAnchor" number="5.1.1.3">
<h4><span class="header-section-number">5.1.1.3</span> Contingent Claims<a href="continuous-time-finance.html#contingent-claims" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This chapter revolves around the financial derivative and we start by stating the definition of the financial derivative.</p>
<blockquote class="def">
<p><strong>Definition 2.7. (Bjork)</strong> <em>A <strong>contingent claim</strong> (financial derivative) is <em>any</em> stochastic variable <span class="math inline">\(X\)</span> of the form <span class="math inline">\(\Phi(Z)\)</span>, where <span class="math inline">\(Z\)</span> is the stochastic varible driving the stock price process.</em></p>
</blockquote>
<p>We may also call the function <span class="math inline">\(\Phi\)</span> the <strong>contract function</strong> as it states how the contract is resolved once the stochastic variable <span class="math inline">\(Z\)</span> has been realised. Our objective is now to study, what a buyer of said contract would have to pay at any given time <span class="math inline">\(t\)</span>. We call the fair price of <span class="math inline">\(X\)</span> at time <span class="math inline">\(t\)</span>: <span class="math inline">\(\Pi_t[X]\)</span>. As such it is easy to see that the fair price at the time of maturity <span class="math inline">\(T\)</span> is simply the payout <span class="math inline">\(X\)</span> i.e. <span class="math inline">\(\Pi_T[X]=X\)</span>. Our strategy is to find a replicating portfolio <span class="math inline">\(h\)</span> and determine the price of said portfolio.</p>
<blockquote class="def">
<p><strong>Definition 2.8. (Bjork)</strong> <em>A contingent claim <span class="math inline">\(X\)</span> can be <strong>replicated</strong>, or said to be <strong>reachable</strong> if there exist a portfolio <span class="math inline">\(h\)</span> such that</em></p>
<p><span class="math display">\[
V_1^h=X,
\]</span></p>
<p><em>with probability one. In that case, we say that the portfolio <span class="math inline">\(h\)</span> is a <strong>hedging</strong> portfolio or a <strong>replicating</strong> portfolio. If all claims can be replicated we say that the market is <strong>complete</strong>.</em></p>
</blockquote>
<p>Our pricing strategy is then to determine the value process of the replicating portfolio and then by the first pricing principle below we say that the price is imply the value of the replicating portfolio.</p>
<p><strong>Pricing principle 1.</strong> If a clain <span class="math inline">\(X\)</span> is reachable with replicating portfolio <span class="math inline">\(h\)</span>, then the only reasonable price process for <span class="math inline">\(X\)</span> is given by</p>
<p><span class="math display">\[
\Pi_t[X]=V_t^h.
\]</span></p>
<p>Notice, that this assumes that a replicating portfolio exist and even so we have a uniqueness statement to solve. We end this section by writing two important results.</p>
<blockquote class="prop">
<p><strong>Proposition 2.9. (Bjork)</strong> <em>Suppose that a claim <span class="math inline">\(X\)</span> is reachable with replicating portfolio <span class="math inline">\(h\)</span>. Then any price at time <span class="math inline">\(t\ge 0\)</span> of the claim <span class="math inline">\(X\)</span> other than the value process of <span class="math inline">\(h\)</span> will lead to an arbitrage on the extended market <span class="math inline">\((B,S,X)\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 2.10. (Bjork)</strong> <em>If the one-period binomial model is free of arbitrage, then it is also complete.</em></p>
</blockquote>
<p>The hedging portfolio in the one-period binomial model is given by the portfolio <span class="math inline">\((x,y)\)</span> below
<span class="math display">\[\begin{align*}
x&amp;=\frac{1}{1+R}\cdot\frac{u\Phi(d)-d\Phi(u)}{u-d},\tag{2.2}\\
y&amp;=\frac{1}{s}\cdot\frac{\Phi(u)-\Phi(d)}{u-d}.\tag{2.3}
\end{align*}\]</span></p>
</div>
<div id="risk-neutral-valuation" class="section level4 hasAnchor" number="5.1.1.4">
<h4><span class="header-section-number">5.1.1.4</span> Risk Neutral Valuation<a href="continuous-time-finance.html#risk-neutral-valuation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We see that since the one-period model is complete we can price any contingent claim and we see that
<span class="math display">\[\begin{align*}
\Pi_0[X]&amp;=\frac{1}{1+R}\cdot\frac{u\Phi(d)-d\Phi(u)}{u-d}+s\frac{1}{s}\cdot\frac{\Phi(u)-\Phi(d)}{u-d}\\
&amp;=\frac{1}{1+R}\left\{\frac{u\Phi(d)-d\Phi(u)}{u-d}+(1+R)\frac{\Phi(u)-\Phi(d)}{u-d}\right\}\\
&amp;=\frac{1}{1+R}\left\{\frac{(1+R)-d}{u-d}\Phi(u)+\frac{u-(1+R)}{u-d}\Phi(d)\right\}\\
&amp;=\frac{1}{1+R}E^Q[X].
\end{align*}\]</span>
i.e. the price at time <span class="math inline">\(t=0\)</span> should simply be the expected discounted payout according to the martingale measure. This leads to the important pricing proposition:</p>
<blockquote class="prop">
<p><strong>Proposition 2.11. (Bjork)</strong> <em>If the one-period binomial model is free of arbitrage, then the arbitrage free price of a contingent claim <span class="math inline">\(X\)</span> is given by</em></p>
<p><span class="math display">\[
\Pi_0[X]=\frac{1}{1+R}E^Q[X].\tag{2.4}
\]</span></p>
<p><em>Here the martingale measure <span class="math inline">\(Q\)</span> is uniquely determined by the relation</em></p>
<p><span class="math display">\[
S_0=\frac{1}{1+R}E^Q[S_1],\tag{2.5}
\]</span></p>
and the explicit expressions for <span class="math inline">\(q_u\)</span> and <span class="math inline">\(q_d\)</span> are given in proposition 2.6. Furthermore the claim <span class="math inline">\(X\)</span> can be replicated using the portfolio
<span class="math display">\[\begin{align*}
x&amp;=\frac{1}{1+R}\cdot\frac{u\Phi(d)-d\Phi(u)}{u-d},\tag{2.6}\\
y&amp;=\frac{1}{s}\cdot\frac{\Phi(u)-\Phi(d)}{u-d}.\tag{2.7}
\end{align*}\]</span>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="multi-period-model" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Multi-period model<a href="continuous-time-finance.html#multi-period-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The one-period binomial model can easily be extended to a multi-period model, by assuming that the bond and stock pricess evolve by the processes:</p>
<p><span class="math display">\[
t\ge1:\ B_t=(1+R)B_{t-1}\hspace{20pt}\text{and}\hspace{20pt}B_0=1,
\]</span></p>
<p><span class="math display">\[
t\ge1:\ S_t=Z_{t-1}S_{t-1}\hspace{20pt}\text{and}\hspace{20pt}S_0=s,
\]</span></p>
<p>where we obviously have that <span class="math inline">\(B_t=(1+R)^t\)</span> for <span class="math inline">\(t\ge 0\)</span>. In the above <span class="math inline">\(Z_t\)</span> is <span class="math inline">\(u\)</span> with probability <span class="math inline">\(p_u\)</span> and <span class="math inline">\(d\)</span> with probability <span class="math inline">\(p_d\)</span>. In this context, we need to define a portfolio in terms of a strategy.</p>
<blockquote class="def">
<p><strong>Definition 2.13. (Bjork)</strong> <em>A <strong>portfolio strategy</strong> is a stochastic process on <span class="math inline">\(\{1,...,T\}\)</span></em></p>
<p><span class="math display">\[
h=\left\{h_t=(x_t,y_t);\ t=1,...,T\right\}
\]</span></p>
<p><em>such that <span class="math inline">\(h_t\)</span> is a function of <span class="math inline">\(S_0,S_1,...,S_{t-1}\)</span>. For a given portfolio strategy <span class="math inline">\(h\)</span> we set <span class="math inline">\(h_0=h_1\)</span> by convention. The associated <strong>value process</strong> corresponding to the portfolio <span class="math inline">\(h\)</span> is defined by</em></p>
<p><span class="math display">\[
V_t^h=x_t(1+R)+y_tS_t.
\]</span></p>
</blockquote>
<p>Given this notation we may define what an arbitrage is, but first we introduce the notion of a self-financing portfolio. A self-financing portfolio in an intuative sense is a portfolio that is not withdrawn from or deposited into.</p>
<blockquote class="def">
<p><strong>Definition 2.14. (Bjork)</strong> <em>A portfolio strategy <span class="math inline">\(h\)</span> is said to be <strong>self-financing</strong> if the following condition holds for all <span class="math inline">\(t=0,...,T-1\)</span>:</em></p>
<p><span class="math display">\[
x_t(1+R)+y_tS_t=x_{t+1}+y_{t+1}S_t.
\]</span></p>
</blockquote>
<p>The above equation says that the portfolio purchased at time <span class="math inline">\(t\)</span> and helt until <span class="math inline">\(t+1\)</span> <span class="math inline">\((x_{t+1},y_{t+1})\)</span> can only be financed by the market value of the portfolio held from <span class="math inline">\([t-1,t)\)</span> i.e. <span class="math inline">\((x_{t},y_{t})\)</span>. We now define an arbitrage.</p>
<blockquote class="def">
<p><strong>Definition 2.15. (Bjork)</strong> <em>An <strong>arbitrage</strong> is a self-financing portfolio <span class="math inline">\(h\)</span> with the properties: 1) <span class="math inline">\(V^h_0=0\)</span>, 2) <span class="math inline">\(P(V^h_T\ge 0)=1\)</span> and 3) <span class="math inline">\(P(V^h_T&gt;0)&gt;0\)</span>.</em></p>
</blockquote>
<p>The multiperiod binomial model has an just like the oneperiod model a result regarding when an arbitrage exists.</p>
<blockquote class="lem">
<p><strong>Lemma 2.16. (Bjork)</strong> <em>If <span class="math inline">\(d\le (1+R)\le u\)</span> (eq. 2.8) then the multiperiod model is arbitrage-free.</em></p>
</blockquote>
<p>As one can see, the multiperiod model is rather similar to the one period model. We wil in the following summarise equivalent statements for the multiperiod model as the ones in the oneperiod model.</p>
<blockquote class="def">
<p><strong>Definition 2.17. (Bjork)</strong> <em>The martingale probabilities <span class="math inline">\(q_u\)</span> and <span class="math inline">\(q_d\)</span> are defined as the probabilities for which the relation below holds.</em></p>
<p><span class="math display">\[
s=\frac{1}{1+R}E^Q[S_{t+1}\ \vert\ S_t].
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 2.18. (Bjork)</strong> <em>The martingale probabilities <span class="math inline">\(q_u\)</span> and <span class="math inline">\(q_d\)</span> are given by</em></p>
<p><span class="math display">\[
\left\{\begin{matrix}q_u=\frac{(1+R)-d}{u-d},\\ q_u=\frac{u-(1+R)}{u-d}.\end{matrix}\right.
\]</span></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 2.19. (Bjork)</strong> <em>A <strong>contingent claim</strong> is a stochastic variable <span class="math inline">\(X\)</span> of the form</em></p>
<p><span class="math display">\[
X=\Phi(S_T),
\]</span></p>
<p><em>where the <strong>contract function</strong> <span class="math inline">\(\mathbf{\Phi}\)</span> is some given real valued function.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 2.20. (Bjork)</strong> <em>A given contingent claim <span class="math inline">\(X\)</span> is said to be <strong>reachable</strong> if there exists a self-financing portfolio <span class="math inline">\(h\)</span> such that</em></p>
<p><span class="math display">\[
V_T^h=X,
\]</span></p>
<p><em>with probability one. In that case we say that the portfolio <span class="math inline">\(h\)</span> is a <strong>hedging</strong> portfolio or a <strong>replicating</strong> portfolio. If all claims can be replicated we say that the market is <em>(dynamically)</em> <strong>complete</strong>.</em></p>
</blockquote>
<p><strong>Pricing principle 2. (Bjork)</strong> <em>If a claim <span class="math inline">\(X\)</span> is reachable with replicating portfolio <span class="math inline">\(h\)</span>, then the only reasonable price process for <span class="math inline">\(X\)</span> os given by</em></p>
<p><span class="math display">\[
\Pi_t[X]=V_t^h,\ t=0,1,...,T.
\]</span></p>
<blockquote class="prop">
<p><strong>Proposition 2.21. (Bjork)</strong> <em>Assume <span class="math inline">\(X\)</span> is reachable by <span class="math inline">\(h\)</span>, then any price other than <span class="math inline">\(V_t^h\)</span> for some <span class="math inline">\(t\ge 0\)</span> leads to an arbitrage opportunity.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 2.22. (Bjork)</strong> <em>The multiperiod model is complete, i.e. every claim can be replicated by a self-financing portfolio.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 2.24. (Bjork)</strong> <em><strong>(Binomial algorithm)</strong> Consider a <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X=\Phi(S_T)\)</span>. Then this claim can be replicated using af self-financing portfolio. If <span class="math inline">\(V_t(k)\)</span> denotes the value of the portfolio at the node <span class="math inline">\((t,k)\)</span> (<span class="math inline">\(k\)</span> referring to <span class="math inline">\(k\)</span> amount of up-moves for the stock), then <span class="math inline">\(V_t(k)\)</span> can be computed recursively by the scheme</em></p>
<p><span class="math display">\[
\left\{\begin{matrix}V_t(k)=\frac{1}{1+R}\left\{q_uV_{t+1}(k+1)+q_dV_{t+1}(k)\right\},\\ V_T(k)=\Phi(su^kd^{T-k}).\end{matrix}\right.
\]</span></p>
<p><em>where the martingale probabilities <span class="math inline">\(q_u\)</span> and <span class="math inline">\(q_d\)</span> are given by</em></p>
<p><span class="math display">\[
\left\{\begin{matrix}q_u=\frac{(1+R)-d}{u-d},\\ q_u=\frac{u-(1+R)}{u-d}.\end{matrix}\right.
\]</span></p>
<p><em>With the notation as above, the hedging portfolio is given by</em></p>
<p><span class="math display">\[
\left\{\begin{matrix}x_t(k)=\frac{1}{1+R}\cdot\frac{uV_t(k)-dV_t(k+1)}{u-d},\\ y_t(k)=\frac{1}{S_{t-1}}\cdot\frac{V_t(k+1)-V_t(k)}{u-d}.\end{matrix}\right.
\]</span></p>
<p><em>In particular, the arbitrage free price of the claim at <span class="math inline">\(t=0\)</span> is given by <span class="math inline">\(V_0(0)\)</span>.</em></p>
</blockquote>
<details>
<summary>
<strong>Example.</strong>
</summary>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Consider <span class="math inline">\(R=0.04\)</span>, <span class="math inline">\(s=100\)</span>, <span class="math inline">\(u=1.1\)</span>, <span class="math inline">\(d=0.9\)</span>, <span class="math inline">\(p_u=0.6\)</span> and <span class="math inline">\(p_d=0.4\)</span>. We consider a model of length <span class="math inline">\(T=2\)</span> and we want to evaluate the price of the european call option with srike <span class="math inline">\(K=90\)</span> that is the contingent claim</p>
<p><span class="math display">\[
X=(S_T-K)^+,\hspace{20pt}\Phi(s)=(s-K)^+.
\]</span></p>
<p>For each time <span class="math inline">\(t\)</span> we know the replicating portfolio, if we know the payoff the following period. Therefore we start from the leaves of the tree and work towards the root. Since the strike price is <span class="math inline">\(K=90\)</span> the end result will be the following payoffs:
<span class="math display">\[\begin{align*}
u^2:\hspace{20pt}&amp;(121-90)^+=31\\
ud:\hspace{20pt}&amp;(99-90)^+=9\\
du:\hspace{20pt}&amp;(99-90)^+=9\\
d^2:\hspace{20pt}&amp;(81-90)^+=0
\end{align*}\]</span>
Therefore by the risk neautral valuation formula with <span class="math inline">\(q_u=\frac{(1+R)-d}{u-d}=0.7\)</span> and <span class="math inline">\(q_d=\frac{u-(1+R)}{u-d}=0.3\)</span> we have that the cost of the replicating portfolio at time <span class="math inline">\(t=1\)</span> is respectively
<span class="math display">\[\begin{align*}
u:\hspace{20pt}&amp;\frac{1}{1+R}\left\{31\cdot q_u + 9 \cdot q_d\right\}\approx 23.46\\
d:\hspace{20pt}&amp;\frac{1}{1+R}\left\{9\cdot q_u + 0 \cdot q_d\right\}\approx 6.06
\end{align*}\]</span>
To replicate this payoff at time <span class="math inline">\(t=1\)</span> we can use the risk neutral valuation formula once more to find the base cost of the replicating portfolio i.e. the price of <span class="math inline">\(X\)</span> at time <span class="math inline">\(t=0\)</span></p>
<p><span class="math display">\[
\frac{1}{1+R}\left\{23.46\cdot q_u + 6.06 \cdot q_d\right\}\approx 17.54.
\]</span></p>
<p>Working from the root to the leaves we can now calculate the hedging portfolio at time <span class="math inline">\(t=0,1\)</span> for each path. For time <span class="math inline">\(t=0\)</span> we calculate
<span class="math display">\[\begin{align*}
x=&amp;\frac{1}{1+R}\cdot \frac{u\cdot 6.06-d\cdot 23.46}{u-d}\approx -69.46,\\
y=&amp;\frac{1}{s}\cdot\frac{23.46-6.06}{u-d}\approx0.87
\end{align*}\]</span>
We see by calculations that this does indeed replicate the payoff at time <span class="math inline">\(t=1\)</span>:
<span class="math display">\[\begin{align*}
u:\hspace{20pt}&amp;V_1^h=(1+R)\cdot x + 110\cdot y\approx 23.46,\\
d:\hspace{20pt}&amp;V_1^h=(1+R)\cdot x + 90\cdot y\approx 6.06.
\end{align*}\]</span>
We also see by calculation that the initial portfolio does cost the expected 17.54 as</p>
<p><span class="math display">\[
x\cdot 1+y\cdot100=87-69.46=17.54.
\]</span></p>
<p>Following these steps at time <span class="math inline">\(t=1\)</span> the portfolios <span class="math inline">\((-86.54,1)\)</span> (for the up-scenario) and <span class="math inline">\((-38.94,0.5)\)</span> (for the down-scenario) would arise. Notice when calculating <span class="math inline">\(y\)</span> one has to use the current price <span class="math inline">\(S_1=S_0\cdot Z\)</span> not <span class="math inline">\(S_0\)</span>. One should also check by similar calculations as above, that these portfolios does indeed replicate the payoff of the contingent claim <span class="math inline">\(X\)</span>. <span class="math inline">\(\square\)</span></p>
</details>
<blockquote class="prop">
<p><strong>Proposition 2.25. (Bjork)</strong> <em>The arbitrage free price at <span class="math inline">\(t=0\)</span> of a <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span> is given by</em></p>
<p><span class="math display">\[
\Pi_0[X]=\frac{1}{(1+R)^T}E^Q[X]
\]</span></p>
<p><em>where <span class="math inline">\(Q\)</span> denotes the martingale measure, or more explicitly</em></p>
<p><span class="math display">\[
\Pi_0[X]=\frac{1}{(1+R)^T}\sum_{k=0}^T\binom{T}{k}q_u^kq_d^{T-k}\Phi(su^kd^{T-k}).
\]</span></p>
</blockquote>
<details>
<summary>
<strong>Example.</strong>
</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="continuous-time-finance.html#cb8-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">0.04</span></span>
<span id="cb8-2"><a href="continuous-time-finance.html#cb8-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb8-3"><a href="continuous-time-finance.html#cb8-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fl">1.1</span></span>
<span id="cb8-4"><a href="continuous-time-finance.html#cb8-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb8-5"><a href="continuous-time-finance.html#cb8-5" aria-hidden="true" tabindex="-1"></a>p_u <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb8-6"><a href="continuous-time-finance.html#cb8-6" aria-hidden="true" tabindex="-1"></a>p_d <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb8-7"><a href="continuous-time-finance.html#cb8-7" aria-hidden="true" tabindex="-1"></a>q_u <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">+</span>R<span class="sc">-</span>d)<span class="sc">/</span>(u<span class="sc">-</span>d)</span>
<span id="cb8-8"><a href="continuous-time-finance.html#cb8-8" aria-hidden="true" tabindex="-1"></a>q_d <span class="ot">&lt;-</span> (u<span class="dv">-1</span><span class="sc">-</span>R)<span class="sc">/</span>(u<span class="sc">-</span>d)</span>
<span id="cb8-9"><a href="continuous-time-finance.html#cb8-9" aria-hidden="true" tabindex="-1"></a>cap_t <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb8-10"><a href="continuous-time-finance.html#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="continuous-time-finance.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Test for K=90</span></span>
<span id="cb8-12"><a href="continuous-time-finance.html#cb8-12" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb8-13"><a href="continuous-time-finance.html#cb8-13" aria-hidden="true" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">+</span>R)<span class="sc">**</span>(<span class="sc">-</span>cap_t)<span class="sc">*</span><span class="fu">sum</span>(</span>
<span id="cb8-14"><a href="continuous-time-finance.html#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">choose</span>(cap_t,<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>q_u<span class="sc">**</span>(<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>q_d<span class="sc">**</span>(cap_t <span class="sc">-</span> <span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span><span class="fu">pmax</span>(s<span class="sc">*</span>u<span class="sc">**</span>(<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>d<span class="sc">**</span>(cap_t <span class="sc">-</span> <span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">-</span>K,<span class="dv">0</span>)</span>
<span id="cb8-15"><a href="continuous-time-finance.html#cb8-15" aria-hidden="true" tabindex="-1"></a>) <span class="co"># = 17.53883</span></span>
<span id="cb8-16"><a href="continuous-time-finance.html#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="continuous-time-finance.html#cb8-17" aria-hidden="true" tabindex="-1"></a>pi_0 <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(<span class="dv">0</span><span class="sc">:</span><span class="fu">ceiling</span>(s<span class="sc">*</span>u<span class="sc">**</span>cap_t), <span class="cf">function</span>(K){</span>
<span id="cb8-18"><a href="continuous-time-finance.html#cb8-18" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>R)<span class="sc">**</span>(<span class="sc">-</span>cap_t)<span class="sc">*</span><span class="fu">sum</span>(</span>
<span id="cb8-19"><a href="continuous-time-finance.html#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">choose</span>(cap_t,<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>q_u<span class="sc">**</span>(<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>q_d<span class="sc">**</span>(cap_t <span class="sc">-</span> <span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span><span class="fu">pmax</span>(s<span class="sc">*</span>u<span class="sc">**</span>(<span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">*</span>d<span class="sc">**</span>(cap_t <span class="sc">-</span> <span class="dv">0</span><span class="sc">:</span>cap_t)<span class="sc">-</span>K,<span class="dv">0</span>)</span>
<span id="cb8-20"><a href="continuous-time-finance.html#cb8-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-21"><a href="continuous-time-finance.html#cb8-21" aria-hidden="true" tabindex="-1"></a>}))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="figures/BS_call_price.png" alt="The pricing function of the European call option." width="75%" />
<p class="caption">
Figure 5.1: The pricing function of the European call option.
</p>
</div>
<p>We follow an analog example as the one after proposition 2.24. Let <span class="math inline">\(K=90\)</span> and we see that
<span class="math display">\[\begin{align*}
&amp;\Pi_0[X]\\
&amp;=\frac{1}{(1+0.04)^2}\sum_{k=0}^2\binom{2}{k}\cdot0.7^k\cdot0.3^{2-k}\cdot\Phi(100\cdot 1.1^k\cdot0.9^{2-k})\\
&amp;=0.9245562\cdot\left(\underbrace{1\cdot 1\cdot0.09\cdot0}_{k=0}+\underbrace{2\cdot 0.7\cdot0.
3\cdot 9}_{k=1}+\underbrace{1\cdot 0.49\cdot1\cdot31}_{k=2}\right)\\
&amp;=0.9245562\cdot\left(0+3.78+15.19\right)\\
&amp;=17.53883
\end{align*}\]</span>
Since we know that <span class="math inline">\(K\)</span> must meaningfully range in <span class="math inline">\([0,121]\)</span> we could try to calculate the price of the contingent claim at time <span class="math inline">\(t=0\)</span> for all integers in this interval. We see that the price range between <span class="math inline">\(S_0\)</span> and 0 as expected. One can also see that the price changes slope at the prices 99 and 121 as the function is linear in <span class="math inline">\(\Phi\)</span> and som realisations loose any effect on the price when the strike is higher than the outcome. <span class="math inline">\(\square\)</span></p>
</details>
<blockquote class="prop">
<p><strong>Proposition 2.26. (Bjork)</strong> <em>The condition <span class="math inline">\(d&lt;(1+R)&lt;u\)</span> is necessary and sufficient condition for absence of arbitrage.</em></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
<div id="generelised-one-period-model" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Generelised one-period model<a href="continuous-time-finance.html#generelised-one-period-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the previous we had the simpel model where we only had one stochastic asset <span class="math inline">\(S\)</span> and only one stochastic variable <span class="math inline">\(Z\)</span> determining the future stock price. Now we will generelise this model by introducing <span class="math inline">\(N\)</span> assets and introducing som stochastic behaviour to the system.</p>
<div id="model-specification" class="section level4 hasAnchor" number="5.1.3.1">
<h4><span class="header-section-number">5.1.3.1</span> Model specification<a href="continuous-time-finance.html#model-specification" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We consider the market consisting of a collection of stochastic prices assets <span class="math inline">\(i=1,...,N\)</span> with <span class="math inline">\(N\)</span>-dimensional price process.</p>
<p><span class="math display">\[
S_t=\begin{bmatrix} S_t^1\\
\vdots\\
S_t^N\end{bmatrix}
\]</span></p>
<p>We now assume that <span class="math inline">\(S_t\)</span> is defined on a background space with finite sample space <span class="math inline">\(\Omega = \{\omega_1,...,\omega_M\}\)</span> with associated probabilities <span class="math inline">\(p_j=P(\omega_j)\)</span>, <span class="math inline">\(j=1,...,M\)</span>. We can then for eact time <span class="math inline">\(t=1,...,T\)</span> define the <span class="math inline">\(N\times M\)</span> matrix <span class="math inline">\(D_t\)</span> as such</p>
<p><span class="math display">\[
D_t=\begin{bmatrix} S_t^1(\omega_1)&amp;\cdots &amp;S_t^1(\omega_M)\\
\vdots &amp;\ddots &amp; \vdots\\
S_t^N(\omega_1) &amp;\cdots&amp;S_t^M(\omega_M)\end{bmatrix}.
\]</span></p>
<p>We will assume that <span class="math inline">\(S_0^1&gt;0\)</span> and <span class="math inline">\(S_1^1(\omega_j)&gt;0\)</span>, <span class="math inline">\(j=1,...,M\)</span>.</p>
</div>
<div id="absence-of-arbitrage" class="section level4 hasAnchor" number="5.1.3.2">
<h4><span class="header-section-number">5.1.3.2</span> Absence of Arbitrage<a href="continuous-time-finance.html#absence-of-arbitrage" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We now define a <strong>portfolio</strong> as an <span class="math inline">\(N\)</span>-dimensional row vector</p>
<p><span class="math display">\[
h=\begin{bmatrix} h^1, \dots,h^N\end{bmatrix}
\]</span></p>
<p>representing the amount of assets held at time <span class="math inline">\(t=0\)</span> and held until <span class="math inline">\(t=1\)</span>. The <strong>value process</strong> is then</p>
<p><span class="math display">\[
V^h_t=h\cdot S_t=\sum_{i=1}^N h^iS_t^i,\ t=0,1.\tag{3.1}
\]</span></p>
<p>For a given <span class="math inline">\(\omega_j\in\Omega\)</span> we have the realisation</p>
<p><span class="math display">\[
V_t^h=hS_t(\omega_j)=hd_j=(hD)_j.
\]</span></p>
<blockquote class="def">
<p><strong>Definition 3.1. (Bjork)</strong> <em>The portfolio <span class="math inline">\(h\)</span> is an <strong>arbitrage portfolio</strong> fil it satisfies the conditions: <span class="math inline">\(V_0^h=0\)</span>, <span class="math inline">\(P(V_1^h\ge 0)=1\)</span> and <span class="math inline">\(P(V_1^h&gt;0)&gt;0\)</span>.</em></p>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 3.2. (Bjork)</strong> <em><strong>(Farkas’ Lemma)</strong> Suppose that <span class="math inline">\(d_0,d_1,...,d_M\)</span> are column vectors in <span class="math inline">\(\mathbb{R}^N\)</span>. Then exactly one of the following problems possesses a solution.</em></p>
<ul>
<li><strong>Problem 1</strong>: <em>There exist <span class="math inline">\(\lambda_1,...,\lambda_M\ge0\)</span> such that <span class="math inline">\(d_0=\sum_{j=1}^M\lambda_jd_j\)</span>.</em></li>
<li><strong>Problem 2</strong>: <em>There exist <span class="math inline">\(h\in\mathbb{R}^N\)</span> such that <span class="math inline">\(h^\top d_0&lt;0\)</span> and <span class="math inline">\(h^\top d_j\ge 0\)</span> for <span class="math inline">\(j=1,...,M\)</span>.</em></li>
</ul>
</blockquote>
<p>We now investegate this system for any possible arbitrage portfolios. However first we acknowledge that there exist a nominal price system <span class="math inline">\(S_t\)</span> and a normalised price system <span class="math inline">\(Z_t\)</span>. The latter we define as the nominel pricess under the numeraire <span class="math inline">\(S_t^1\)</span> that is</p>
<p><span class="math display">\[
Z_t=\begin{bmatrix} S_t^1/S_t^1\\
S_t^2/S_t^1\\
\vdots\\
S_t^N/S_t^1\end{bmatrix}=\begin{bmatrix} 1\\
S_t^2/S_t^1\\
\vdots\\
S_t^N/S_t^1\end{bmatrix}.
\]</span></p>
<p>The reason for introducing the normalized price system is that we can without much effort translate results in this system to the nominal system and the normalised system is easier to analize. For this, however, we need af few results.</p>
<blockquote class="lem">
<p><strong>Lemma 3.3. (Bjork)</strong> <em>With notation as above, the following hold.</em></p>
<ol style="list-style-type: decimal">
<li><em>The <span class="math inline">\(Z_t\)</span> value process i related to the <span class="math inline">\(S_t\)</span> value process by</em>
<span class="math display">\[
  V_t^{h,Z}=hZ_t=\frac{1}{S_t^1}V_t^h.
  \]</span></li>
<li><em>A portfolio is an arbitrage in the <span class="math inline">\(S_t\)</span> system if and only if there is an arbitrage in the <span class="math inline">\(Z_t\)</span> system.</em></li>
<li><em>In the <span class="math inline">\(Z_t\)</span> price system, the numeraie asset <span class="math inline">\(Z^1\)</span> has unit constant prices i.e. <span class="math inline">\(Z_t^1=1\)</span> for all <span class="math inline">\(t\ge 0\)</span>.</em></li>
</ol>
</blockquote>
<p>One of the reason that the normalised system is attractable is that the numeraire asset is constant i.e. risk free in the normalised system. Let us formulate our first main result.</p>
<blockquote class="prop">
<p><strong>Proposition 3.4. (Bjork)</strong> <em>The market is arbitrage free if and only if there exists strictly positive real numbers <span class="math inline">\(q_1,...,q_M\ge 0\)</span> with <span class="math inline">\(q_1+\cdots + q_M=1\)</span> (eq. 3.2) (probability vector) such that the following vector equality holds</em></p>
<p><span class="math display">\[
\begin{bmatrix} Z_0^1\\
\vdots\\
Z_N^1\end{bmatrix}=\begin{bmatrix} Z_1^1(\omega_1)\\
\vdots\\
Z_1^N(\omega_1)\end{bmatrix}q_1+\cdots +\begin{bmatrix} Z_1^1(\omega_M)\\
\vdots\\
Z_1^N(\omega_M)\end{bmatrix}q_M.\tag{3.3}
\]</span></p>
</blockquote>
</div>
<div id="martingale-measures" class="section level4 hasAnchor" number="5.1.3.3">
<h4><span class="header-section-number">5.1.3.3</span> Martingale Measures<a href="continuous-time-finance.html#martingale-measures" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote class="def">
<p><strong>Definition 3.5. (Bjork)</strong> <em>Given the objective probability measure <span class="math inline">\(P\)</span> on <span class="math inline">\((\Omega,\mathcal{F},P)\)</span>, we say that another probability measure <span class="math inline">\(Q\)</span> defined on <span class="math inline">\(\Omega\)</span> is <strong>equivalent</strong> to <span class="math inline">\(P\)</span> if</em></p>
<p><span class="math display">\[
\forall A\in\mathcal{F}:P(A)=0\iff Q(A)=0,
\]</span></p>
<p>or equivalently</p>
<p><span class="math display">\[
\forall A\in\mathcal{F}:P(A)=1\iff Q(A)=1.
\]</span></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 3.7. (Bjork)</strong> <em>Consider the market model above and set <span class="math inline">\(S^1\)</span> as the numeraire asset. We say that a probability measure <span class="math inline">\(Q\)</span> defined on <span class="math inline">\(\Omega\)</span> is a <strong>martingale measure</strong> if it satisfies the following conditions:</em></p>
<ol style="list-style-type: decimal">
<li><em><span class="math inline">\(Q\)</span> is equivalent to <span class="math inline">\(P\)</span>, i.e. <span class="math inline">\(Q\sim P\)</span>.</em></li>
<li><em>For every <span class="math inline">\(i=1,...,N\)</span>, the normalized asset price process</em>
<span class="math display">\[
  Z_t^i=\frac{S_t^i}{S_t^1},
  \]</span>
<em>is martingale under the measure <span class="math inline">\(Q\)</span>.</em></li>
</ol>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 3.8. (Bjork)</strong> <strong>(First Fundamental Theorem)</strong> <em>Given a fixed numeraire, ther market is free of arbitrage possibilities if and only if there exists a martingale measure <span class="math inline">\(Q\)</span>.</em></p>
</blockquote>
<p>By assuming that the numeraire asset is risk free (i.e. does not depend on <span class="math inline">\(\omega\)</span>) then by scaling we can derive the short interest rate as</p>
<p><span class="math display">\[
1+R=\frac{S_1^1}{S_0^1}.
\]</span></p>
<p>With this in mind we can formulate theorem 3.8 in its more widely used form.</p>
<blockquote class="thm">
<p><strong>Theorem 3.9. (Bjork)</strong> <strong>(First Fundamental Theorem)</strong> <em>Assume that there exist a risk free asset, and denote the corresponding risk free interest rate by <span class="math inline">\(R\)</span>. Then the market is arbitrage free if and only if there exist a measure <span class="math inline">\(Q\sim P\)</span> such that</em></p>
<p><span class="math display">\[
S_0^i=\frac{1}{1+R}E^Q[S_1^i],\hspace{20pt}\text{for all}\ i=1,...,N.\tag{3.9}
\]</span></p>
</blockquote>
</div>
<div id="martingale-pricing" class="section level4 hasAnchor" number="5.1.3.4">
<h4><span class="header-section-number">5.1.3.4</span> Martingale Pricing<a href="continuous-time-finance.html#martingale-pricing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Moving forward we will assume that there exist a risk free asset and we will denote it by <span class="math inline">\(B_t\)</span> (<span class="math inline">\(B_t=S^1_t/S^1_0\)</span>).</p>
<blockquote class="def">
<p><strong>Definition 3.10. (Bjork)</strong> <em>A <strong>contingent claim</strong> is any random variable <span class="math inline">\(X\)</span>, defined on the sample space <span class="math inline">\(\Omega\)</span>.</em></p>
</blockquote>
<p>To ensure no arbitrage in the extended market containing the <span class="math inline">\(N\)</span> assets and the contingent claim we can apply the first fundamental pricing theorem on the extended market.</p>
<blockquote class="prop">
<p><strong>Proposition 3.11. (Bjork)</strong> <em>Consider a given claim <span class="math inline">\(X\)</span>. In order to avoid arbitrage, <span class="math inline">\(X\)</span> must then be priced according to the formula</em></p>
<p><span class="math display">\[
\Pi_0[X]=\frac{1}{1+R}E^Q[X],\tag{3.10}
\]</span></p>
<p><em>where <span class="math inline">\(Q\)</span> is a martingale measure for the underlying market <span class="math inline">\((\Pi,S^1,...,S^N)\)</span>.</em></p>
</blockquote>
</div>
<div id="completeness" class="section level4 hasAnchor" number="5.1.3.5">
<h4><span class="header-section-number">5.1.3.5</span> Completeness<a href="continuous-time-finance.html#completeness" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Given that a market is arbitrage-free we may run into a uniqueness issue when determining the price of a contingent claim. If a martingale measure exist we will very much like it to be unique as this will ensure that the price from the risk neutral valuation formula is unique. To this we need the market to be complete.</p>
<blockquote class="def">
<p><strong>Definition 3.12. (Bjork)</strong> <em>Consider a contingent claim <span class="math inline">\(X\)</span>. If there exists a portfolio <span class="math inline">\(h\)</span>, based on the underlying assets, such that</em></p>
<p><span class="math display">\[
V_1^h=X,\ \text{with probability 1}\tag{3.11}
\]</span></p>
<p><em>i.e.</em></p>
<p><span class="math display">\[
V_1^h(\omega_j)=X(\omega_j),\ j=1,...,M,\tag{3.12}
\]</span></p>
<p><em>then we say that <span class="math inline">\(X\)</span> is <strong>replicated</strong>, or <strong>hedged</strong> by <span class="math inline">\(h\)</span>. Such a portfolio <span class="math inline">\(h\)</span> is called a replicating, or hedging portfolio. If every contingent claim can be replicated, we say that the market is <strong>complete</strong>.</em></p>
</blockquote>
<p>We can now formulate a proposition on when the market is complete in terms of the matrix <span class="math inline">\(D\)</span>.</p>
<blockquote class="prop">
<p><strong>Proposition 3.13. (Bjork)</strong> <em>The market is complete if and only if the rows of the matrix <span class="math inline">\(D\)</span> span <span class="math inline">\(\mathbb{R}^M\)</span>, i.e. if and only if <span class="math inline">\(D\)</span> has rank <span class="math inline">\(M\)</span>.</em></p>
</blockquote>
<p>Now we formulate the second fundamental pricing theorem in terms of the martingale measure <span class="math inline">\(Q\)</span>.</p>
<blockquote class="prop">
<p><strong>Proposition 3.14. (Bjork)</strong> <strong>(Second Fundamental Theorem)</strong> <em>Assume that the model is arbitrage free i.e. <span class="math inline">\(Q\)</span> exist. Then the market is unique if and only if the martingale measure is unique.</em></p>
</blockquote>
</div>
<div id="stochastic-discount-factors" class="section level4 hasAnchor" number="5.1.3.6">
<h4><span class="header-section-number">5.1.3.6</span> Stochastic Discount Factors<a href="continuous-time-finance.html#stochastic-discount-factors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote class="def">
<p><strong>Definition 3.16. (Bjork)</strong> <em>The random variable <span class="math inline">\(L\)</span> on <span class="math inline">\(\Omega\)</span> is defined by</em></p>
<p><span class="math display">\[
L(\omega_i)=\frac{q_i}{p_i},\hspace{20pt} i=1,...,M.
\]</span></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 3.17. (Bjork)</strong> <em>Assume the absence of arbitrage, and fix a martingale measure <span class="math inline">\(Q\)</span>. With notation as above, the <strong>stochastic discount factor</strong> (or “state price deflator”) is the random variable <span class="math inline">\(\Lambda\)</span> on <span class="math inline">\(\Omega\)</span> by</em></p>
<p><span class="math display">\[
\mathbf{M}(\omega)=\frac{1}{1+R}\cdot L(\omega).\tag{3.19}
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 3.18. (Bjork)</strong> <em>The arbitrage free price of any claim <span class="math inline">\(X\)</span> is given by the formula</em></p>
<p><span class="math display">\[
\Pi_0[X]=E^P[\mathbf{M}\cdot X]\tag{3.20}
\]</span></p>
<p><em>where <span class="math inline">\(\mathbf{M}\)</span> is a stochastic discount factor.</em></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div id="self-financing-portfolios" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Self-financing portfolios<a href="continuous-time-finance.html#self-financing-portfolios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We move forward in this chapter by first defining a self-financing portfolio in discrete time and then by letting the step length tend to zero obtain the continuous time analogue.</p>
<div id="discrete-time-sf-portfolio" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Discrete time SF portfolio<a href="continuous-time-finance.html#discrete-time-sf-portfolio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider <span class="math inline">\(N\)</span> different adapted price processes <span class="math inline">\(S^1,...,S^N\)</span>. We use the following definition.</p>
<blockquote class="def">
<p><strong>Definition 6.1. (Bjork)</strong> <em>We use the following definitions.</em></p>
<ul>
<li><em><span class="math inline">\(S_n^i\)</span> is th price of asset <span class="math inline">\(i\)</span> at time <span class="math inline">\(n\)</span>,</em></li>
<li><em><span class="math inline">\(h_n^i\)</span> is the number of units of asset <span class="math inline">\(i\)</span> held during <span class="math inline">\([n,n+1)\)</span>, that is bought at time <span class="math inline">\(n\)</span>,</em></li>
<li><em><span class="math inline">\(d_n^i\)</span> is the dividends from asset <span class="math inline">\(i\)</span> in the time-interval <span class="math inline">\([n-1,n)\)</span>, that is recieved at time <span class="math inline">\(n\)</span>,</em></li>
<li><em><span class="math inline">\(h_n\)</span> is the portfolio <span class="math inline">\((h_n^1,...,h_n^N)\)</span> held during <span class="math inline">\([n,n+1)\)</span>,</em></li>
<li><em><span class="math inline">\(c_n\)</span> is the consumption i.e. withdrawel at time <span class="math inline">\(n\)</span> (negative being deposits/saving),</em></li>
<li><em><span class="math inline">\(V_n\)</span> is the value of the portfolio just before time <span class="math inline">\(n\)</span> i.e. of the portfolio <span class="math inline">\(h_{n-1}\)</span> at time <span class="math inline">\(n\)</span>.</em></li>
</ul>
</blockquote>
<p>We are now ready to define the self-financing portfolio</p>
<blockquote class="def">
<p><strong>Definition 6.2. (Bjork)</strong> <em>A <strong>self-financing portfolio supporting the consumption stream</strong> <span class="math inline">\(\mathbf{c}\)</span> is a portfolio adhering to the <strong>budget constraint</strong> given as</em></p>
<p><span class="math display">\[
h_{n+1}S_{n+1}+c_{n+1}=h_nS_{n+1}+h_nd_{n+1.}
\]</span></p>
<p><em>The interpretation being, that we may only use funds obtained from selling the old portfolio <span class="math inline">\(h_n\)</span> and recieved in dividends to buy the new portfolio <span class="math inline">\(h_{n+1}\)</span> and consume the amount <span class="math inline">\(c_{n+1}\)</span>.</em></p>
</blockquote>
<p>Before studying the self-financing portfolio we define the operator <span class="math inline">\(\Delta\)</span> (in definition 6.3) as the increment <span class="math inline">\(\Delta x_n=x_{n+1}-x_n\)</span> of a countable sequence <span class="math inline">\((x_n)_{n\in\mathbb{N}_0}\)</span>. Notice that we define the increment forward so the increment <span class="math inline">\(n\)</span> is the increment over the time period <span class="math inline">\([n,n+1)\)</span> with the first increment being <span class="math inline">\([0,1)\)</span>. Using this notation we can derive the lemma below.</p>
<blockquote class="lem">
<p><strong>Lemma 6.4. (Bjork)</strong> <em>For any pair of sequences of real numbers <span class="math inline">\((x_n)_{n\in\mathbb{N}_0}\)</span> and <span class="math inline">\((y_n)_{n\in\mathbb{N}_0}\)</span> we have the relations</em>
<span class="math display">\[\begin{align*}
\Delta(xy)_n&amp;=x_n\Delta y_n+y_{n+1}\Delta x_n,\tag{6.5}\\
\Delta(xy)_n&amp;=y_n\Delta x_n+x_{n+1}\Delta y_n,\tag{6.6}\\
\Delta(xy)_n&amp;=x_n\Delta y_n+y_n\Delta x_n+\Delta x_n\Delta y_n.\tag{6.7}
\end{align*}\]</span>
<em>This is also valid if the sequances are <span class="math inline">\(N\)</span>-dimensional, where we interpret the products above as scalar products (<span class="math inline">\(xy^\top\)</span>).</em></p>
</blockquote>
<p>Using these definitions and the lemma above we see that the dynamics of the self-financing portfolio is given below.</p>
<blockquote class="prop">
<p><strong>Proposition 6.6. (Bjork)</strong> <em>The dynamics of any self-financing portfolio supporting the consumption stream <span class="math inline">\(c\)</span> are given by</em></p>
<p><span class="math display">\[
\Delta V_n=h_n \Delta S_n+h_nd_{n+1}-c_{n+1},\tag{6.11}
\]</span></p>
<p><em>or, in more detail</em></p>
<p><span class="math display">\[
\Delta V_n=\sum_{i=1}^Nh_n^i(\Delta S_n^i+d^i_{n+1})-c_{n+1}.\tag{6.12}
\]</span></p>
</blockquote>
<p>We may rewrite the dividends as accumulating dividends <span class="math inline">\(D^i_n=\sum_{k=1}^nd^i_k\)</span> and see that <span class="math inline">\(d_{n+1}^i=\Delta D^i_n\)</span> and so the above condition is equivalent with.</p>
<blockquote class="prop">
<p><strong>Proposition 6.8. (Bjork)</strong> <em>The dynamics of any self-financing portfolio supporting the consumption stream <span class="math inline">\(c\)</span> are given by</em></p>
<p><span class="math display">\[
\Delta V_n=h_n \Delta S_n+h_n\Delta D_n-c_{n+1},\tag{6.15}
\]</span></p>
<p><em>or, in more detail</em></p>
<p><span class="math display">\[
\Delta V_n=\sum_{i=1}^Nh_n^i(\Delta S_n^i+\Delta D^i_n)-c_{n+1}.\tag{6.16}
\]</span></p>
</blockquote>
</div>
<div id="continuous-time-sf-portfolio" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Continuous time SF portfolio<a href="continuous-time-finance.html#continuous-time-sf-portfolio" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formulating the dynamics of the self-financing portfolio in continuous time is easy work given the discrete setup above. However since we now are in continuous time we will change the <span class="math inline">\(n\)</span> with a <span class="math inline">\(t\)</span> and cosider the behavour <span class="math inline">\(V_{t+dt}-V_t\)</span> as we let <span class="math inline">\(dt\to 0\)</span>. First we formulate some basic notation.</p>
<blockquote class="def">
<p><strong>Definition 6.9. (Bjork)</strong> <em>We use the following definitions.</em></p>
<ul>
<li><em><span class="math inline">\(S_t^i\)</span> is th price of asset <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>,</em></li>
<li><em><span class="math inline">\(h_t^i\)</span> is the number of units of asset <span class="math inline">\(i\)</span> held at time <span class="math inline">\(t\)</span>,</em></li>
<li><em><span class="math inline">\(D_t^i\)</span> is the cumulative dividend processs for asset <span class="math inline">\(i\)</span>,</em></li>
<li><em><span class="math inline">\(h_t\)</span> is the portfolio <span class="math inline">\((h_t^1,...,h_t^N)\)</span> held at time <span class="math inline">\(t\)</span>,</em></li>
<li><em><span class="math inline">\(c_t\)</span> is the consumption rate at time <span class="math inline">\(n\)</span> (negative being deposits/saving),</em></li>
<li><em><span class="math inline">\(V_t\)</span> is the value of the portfolio at time <span class="math inline">\(t\)</span> i.e. of the portfolio <span class="math inline">\(h_t\)</span> at time <span class="math inline">\(t\)</span>.</em></li>
</ul>
</blockquote>
<p>Given these definitions we may define a portfolio strategy that is self-financing.</p>
<blockquote class="def">
<p><strong>Definition 6.10. (Bjork)</strong> <em>Let <span class="math inline">\(S\)</span> be and adapted <span class="math inline">\(N\)</span>-dimensional price process. We define the following</em></p>
<ol style="list-style-type: decimal">
<li><em>A <strong>portfolio strategy</strong> is any adapted <span class="math inline">\(N\)</span>-dimensional process <span class="math inline">\(h\)</span>.</em></li>
<li><em>The <strong>value process</strong> <span class="math inline">\(V^h\)</span> corresponding to the portfolio <span class="math inline">\(h\)</span> is given by</em>
<span class="math display">\[
  V_t^h=\sum_{i=1}^N h_t^iS_t^i.\tag{6.17}
  \]</span></li>
<li><em>A <strong>consumption process</strong> is any adapted one-dimensional process <span class="math inline">\(c\)</span>.</em></li>
<li><em>A portfolio-consumption pair <span class="math inline">\((h,c)\)</span> is called <strong>self-financing</strong> if the value process <span class="math inline">\(V^h\)</span> satisfies the condition</em>
<span class="math display">\[
  dV_t^h=\sum_{i=1}^N h_t^i(dS_t^i+d D^i_t)-c_t\ dt,\tag{6.18}
  \]</span>
<em>i.e. if</em>
<span class="math display">\[
  dV_t^h=h_t\ dS_t + h_t\ dD_t -c_t\ dt.
  \]</span></li>
<li><em>The <strong>gain process</strong> <span class="math inline">\(G\)</span> is defined by</em>
<span class="math display">\[
  G_t=S_t+D_t\tag{6.19}
  \]</span>
<em>so we can write the self-financing condition as</em>
<span class="math display">\[
  dV_t=h_t\ dG_t-c_t\ dt.\tag{6.20}
  \]</span></li>
<li><em>The portfolio <span class="math inline">\(h\)</span> is said to be <strong>Markovian</strong> if it is of the form</em>
<span class="math display">\[
  h_t=h(t,S_t),
  \]</span>
<em>for some function <span class="math inline">\(h : \mathbb{R}_+\times \mathbb{R}^N\to\mathbb{R}^N\)</span>.</em></li>
</ol>
</blockquote>
</div>
<div id="portfolio-weights" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Portfolio weights<a href="continuous-time-finance.html#portfolio-weights" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="def">
<p><strong>Definition 6.11. (Bjork)</strong> <em>For a given portfolio <span class="math inline">\(h\)</span> the corresponding <strong>relative portfolio</strong> or <strong>portfolio weights</strong> <span class="math inline">\(w\)</span> are defined by</em></p>
<p><span class="math display">\[
w_t^i=\frac{h_t^iS_t^i}{V_t^h},\ i=1,...,N,\tag{6.21}
\]</span></p>
<p><em>so, in particular, we have <span class="math inline">\(\sum_{i=1}^N w_i=1\)</span>.</em></p>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 6.12. (Bjork)</strong> <em>A portfolio-consumption pair <span class="math inline">\((h,c)\)</span> is self-financing if and only if</em></p>
<p><span class="math display">\[
dV_t^h=V_t^h\sum_{i=1}^N w_t^i\frac{dS_t^i+dD_t^i}{S_t^i}-c_t\ dt\tag{6.22}
\]</span></p>
<p><em>or equivalently with the absolute weights</em></p>
<p><span class="math display">\[
dV_t^h=\sum_{i=1}^N h_t^i(dS_t^i+dD_t^i)-c_t\ dt.
\]</span></p>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 6.13. (Bjork)</strong> <em>Consider the case with no dividends. Let <span class="math inline">\(c\)</span> be a consumption process, and assume that there exist a scalar process <span class="math inline">\(Z\)</span> and a vector process <span class="math inline">\(q=(q^1,...,q^N)\)</span> such that</em></p>
<p><span class="math display">\[
dZ_t=Z_t\sum_{i=1}^N q_t^i\frac{dS_t^i}{S_t^i}-c_t\ dt,\tag{6.23}
\]</span></p>
<p><em>and <span class="math inline">\(\sum_{i=1}^Nqq^i=1\)</span> (eq. 6.24). Now define a portfolio <span class="math inline">\(h\)</span> by</em></p>
<p><span class="math display">\[
h_t^i=\frac{q_t^iZ_t}{S_t^i}.\tag{6.25}
\]</span></p>
<p><em>Then the value process <span class="math inline">\(V^h\)</span> is given by <span class="math inline">\(V^h=Z\)</span>, the pair <span class="math inline">\((h,c)\)</span> is self-financing, and the corresponding relative portfolio <span class="math inline">\(w\)</span> is given by <span class="math inline">\(w=q\)</span>.</em></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="black-scholes-pde" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Black-Scholes PDE<a href="continuous-time-finance.html#black-scholes-pde" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Black-Scholes model revolves arround SDE’s as seen above. In this model we have two assets a risk free asset <span class="math inline">\(B\)</span> and a stochastic priced asset <span class="math inline">\(S\)</span>. We therefore start by defining what we mean by a quote-on-qoute <em>risk free</em> asset.</p>
<blockquote class="def">
<p><strong>Definition 7.1. (Bjork)</strong> <em>The price process <span class="math inline">\(B\)</span> is the price of a <strong>risk free asset</strong> if it has the dynamics</em></p>
<p><span class="math display">\[
dB_t=r_t B_t\ dt,\tag{7.1}
\]</span></p>
<p><em>where <span class="math inline">\(r\)</span> is any <span class="math inline">\(\mathcal{F}_t\)</span> adapted process.</em></p>
</blockquote>
<p>We see from this definition that the meaning of “risk free” is the property, that <span class="math inline">\(B\)</span> is priced locally deterministic in the sence that <span class="math inline">\(r\)</span> is adapted and therefore known at time <span class="math inline">\(t\)</span> and we therefore know the yield on a short term basis. This is also why we may call <span class="math inline">\(r\)</span> the <strong>short interest rate</strong>. Given the dynamics above, we know that <span class="math inline">\(B\)</span> in fact is represented by the process</p>
<p><span class="math display">\[
B_t=B_0e^{\int_0^tr_s\ ds},
\]</span></p>
<p>for some <span class="math inline">\(B_0\)</span> initial value. We will moving forward assume that <span class="math inline">\(B_0=1\)</span>. The stochastic asset <span class="math inline">\(S\)</span> has dynamics.</p>
<p><span class="math display">\[
dS_t=\mu(t,S_t)\ dt + \sigma(t,S_t)\ dW_t,\tag{7.2}
\]</span></p>
<p>where as usual <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are deterministic functions and <span class="math inline">\(W_t\)</span> is a standard Brownian motion. Note that the risk free asset has a similarly process with <span class="math inline">\(\sigma = 0\)</span>. We may now include this in the definition of the Black-Scholes model.</p>
<blockquote class="def">
<p><strong>Definition 7.2. (Bjork)</strong> <em>The <strong>Black-Scholes model</strong> consists of two assets with dynamics given by</em>
<span class="math display">\[\begin{align*}
dB_t&amp;=rB_t\ dt,\tag{7.3}\\
dS_t&amp;=\mu S_t\ dt+\sigma S_t\ dW_t,\tag{7.4}
\end{align*}\]</span>
<em>where <span class="math inline">\(r,\mu,\sigma\)</span> are deterministic constants.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 7.3. (Bjork)</strong> <em>A <strong>zero coupon bond</strong> with maturity <span class="math inline">\(T\)</span> (henceforth “<span class="math inline">\(T\)</span>-bond”) is an asset which pays the holder the face value 1 dollar at time <span class="math inline">\(T\)</span>. The price at time <span class="math inline">\(n\)</span> of a <span class="math inline">\(T\)</span>-bond is denoted by <span class="math inline">\(p(n,T)\)</span>.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 7.4.</strong> <em>The (possible stochastic) discrete <strong>short rate</strong> <span class="math inline">\(r_n\)</span>, for the period <span class="math inline">\([n,n+1]\)</span>, is defined as</em></p>
<p><span class="math display">\[
p(n,n+1)=\frac{1}{1+ r_n}.\tag{7.6}
\]</span></p>
</blockquote>
<p>From this short rate we may derive the dynamics of the bank account recieving zero-coupon rates for each distinct time interval.</p>
<blockquote class="def">
<p><strong>Definition 7.5. (Bjork)</strong> <em>The dynamics of the bank account are given by</em></p>
<p><span class="math display">\[
\Delta B_n=r_n B_n.\tag{7.7}
\]</span></p>
</blockquote>
<div id="contingent-claims-and-arbitrage" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Contingent Claims and Arbitrage<a href="continuous-time-finance.html#contingent-claims-and-arbitrage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="def">
<p><strong>Definition 7.6. (Bjork)</strong> <em>A <strong>European call option</strong> with <strong>exercise price</strong> (or strike price) <span class="math inline">\(K\)</span> and <strong>time of maturity</strong> (exercise date) <span class="math inline">\(T\)</span> on the <strong>underlying asset</strong> <span class="math inline">\(S\)</span> is a contract defined by the following clauses:</em></p>
<ul>
<li><em>The holder of the option has, at time <span class="math inline">\(T\)</span>, the right to buy one share of the underlying stock at the price <span class="math inline">\(K\)</span> dollars from the underwriter of the option.</em></li>
<li><em>The holder of the option is in no way obliged to buy the underlying stock.</em></li>
<li><em>The right to buy the underlying stock at the price <span class="math inline">\(K\)</span> can only be exercised at the precise time <span class="math inline">\(T\)</span>.</em></li>
</ul>
</blockquote>
<p>Obviously, we also have the <strong>european put</strong> option which gives the owner the right to sell an asset at price <span class="math inline">\(K\)</span> at time <span class="math inline">\(T\)</span>. Let os formally define a contingent claim.</p>
<blockquote class="def">
<p><strong>Definition 7.7.</strong> <em>Consider a financial market with vector price process <span class="math inline">\(S\)</span>. A <strong>contingent claim</strong> with <strong>date of maturity</strong> <span class="math inline">\(T\)</span>, also called a <span class="math inline">\(T\)</span>-claim, is any random variable <span class="math inline">\(\mathcal{X}\in\mathcal{F}_T^S\)</span>. A contingent claim <span class="math inline">\(\mathcal{X}\)</span> is called a <strong>simple</strong> claim if it is of the form <span class="math inline">\(\mathcal{X} = \Phi(S_t)\)</span>. The function <span class="math inline">\(\Phi\)</span> is called the <strong>contract function</strong>.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 7.8. (Bjork)</strong> <em>An <strong>arbitrage</strong> possibility on a financial market is a self-financed portfolio <span class="math inline">\(h\)</span> such that</em>
<span class="math display">\[\begin{align*}
V^h(0)&amp;=0,\tag{7.13}\\
P(V_T^h\ge0)&amp;=1,\tag{7-14}\\
P(V_T^h&gt;0)&amp;&gt;0.\tag{7.15}
\end{align*}\]</span>
<em>We say that the market is <strong>arbitrage free</strong> if there are no arbitrage possibilities.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 7.9. (Bjork)</strong> <em>Suppose that there exists a self-financing portfolio <span class="math inline">\(h\)</span>, such that the value process <span class="math inline">\(V^h\)</span> has the dynamics</em></p>
<p><span class="math display">\[
d V_t^h=k_tV_t^h\ dt,\tag{7.16}
\]</span></p>
<p><em>where <span class="math inline">\(k\)</span> is an adapted process. Then it must hold that <span class="math inline">\(k_t=r_t\)</span> for all <span class="math inline">\(t\)</span>, ore there exists an arbitrage possibility.</em></p>
</blockquote>
<blockquote class="thm">
<strong>Theorem 7.10. (Bjork)</strong> <strong>(Black-Scholes equation)</strong> <em>Assume that the market is specified by the equations</em>
<span class="math display">\[\begin{align*}
dB_t&amp;=rB_t\ dt,\tag{7.18}\\
dS_t&amp;=\mu(t,S_t) S_t\ dt+\sigma(t,S_t)S_t\ dW_t,\tag{7.19}
\end{align*}\]</span>
<em>and that we want to price a contingent claim of the form <span class="math inline">\(\mathcal{X}=\Phi(S_t)\)</span> (eq. 7.20). Then the only pricing function of the form <span class="math inline">\(\Pi_t[\Phi(S_t)]=F(t,S_t)\)</span> (eq. 7.21) which is consistent with the absence of arbitrage in the market <span class="math inline">\([B_t,S_t,\Pi_t]\)</span> is when <span class="math inline">\(F\)</span> is the solution of the following boundary value problem in the domain <span class="math inline">\([0,T]\times\mathbb{R}_+\)</span>:</em>
<span class="math display">\[\begin{align*}
F_t(t,s)+rsF_s(t,s)+\frac{1}{2}s^2\sigma^2(t,s)F_{ss}(t,s)-rF(t,s)&amp;=0,\\
F(T,s)&amp;=\Phi(s).
\end{align*}\]</span>
</blockquote>
</div>
<div id="risk-neutral-valuation-1" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Risk Neutral Valuation<a href="continuous-time-finance.html#risk-neutral-valuation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="thm">
<p><strong>Theorem 7.11. (Bjork)</strong> <strong>(Risk Neutral Valuation)</strong> <em>The arbitrage free price of the claim <span class="math inline">\(\Phi(S_t)\)</span> is given by <span class="math inline">\(\Pi_t[\Phi]=F(t,S_t)\)</span>, where <span class="math inline">\(F\)</span> is given by the formula</em></p>
<p><span class="math display">\[
F(t,s)=e^{-r(T-t)}E^Q_{t,s}[\Phi(S_T)],\tag{7.43}
\]</span></p>
<p><em>where the <span class="math inline">\(Q\)</span>-dynamics of <span class="math inline">\(S\)</span> are those of</em></p>
<p><span class="math display">\[
dS_t=rS_t\ dt+S_t\sigma(t,S_t)\ dW_t^Q.\tag{7.42}
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Property 7.12. (Bjork)</strong> <strong>(The Martingale Property)</strong> <em>In the Black-Scholes model, the price process <span class="math inline">\(\Pi_t\)</span> for every traded asset, be it the underlying or derivate asset, has the property the the normalized price process</em></p>
<p><span class="math display">\[
Z_t=\frac{\Pi_t}{B_t},
\]</span></p>
<p><em>(including <span class="math inline">\(S_t/B_t\)</span>) is a martingale under the measure <span class="math inline">\(Q\)</span>.</em></p>
</blockquote>
</div>
<div id="black-scholes-formula" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Black-Scholes formula<a href="continuous-time-finance.html#black-scholes-formula" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="figures/BS_sim.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This chapter will center on deriving the famous Black-Scholes formula. We start by laying out the assumptions of the model. We have a market consiting of two assets: a stochastic prices asset <span class="math inline">\(S\)</span> and a risk free asset <span class="math inline">\(B\)</span>. The prices processes have dynamics:
<span class="math display">\[\begin{align*}
dS_t&amp;=\mu S_t\ dt+\sigma S_t\ dW_t,\tag{7.45}\\
dB_t&amp;=r B_t\ dt,\tag{7.44}
\end{align*}\]</span>
where <span class="math inline">\(S_0=s\)</span> and <span class="math inline">\(B_0=1\)</span> (by assumption). Now from Feymann-Kac and the definition of arbitrage we know that a simple claim <span class="math inline">\(\Phi(S_t)\)</span> has the arbitrage free price given by the risk neutral valueation formula.</p>
<p><span class="math display">\[
F(t,s)=e^{-r(T-t)}E^Q_{t,s}[\Phi(S_T)],\tag{7.46}
\]</span></p>
<p>where <span class="math inline">\(Q\)</span> is a probability measure, namely a Martingale measure, such that the dynamics of <span class="math inline">\(S\)</span> under this measure is</p>
<p><span class="math display">\[
dS_t=r S_t\ dt+\sigma S_t\ dW^Q_t,\tag{7.47}
\]</span></p>
<p>with <span class="math inline">\(W_t^Q\)</span> being a Brownian motion wrt. to the probability measure <span class="math inline">\(Q\)</span> (not <span class="math inline">\(P\)</span>). The above still has the initial condition <span class="math inline">\(S_0=s\)</span>. Given these assumptions we may formulate the Black-Scholes formula.</p>
<blockquote class="thm">
<p><strong>Theorem 7.13. (Bjork)</strong> <strong>(Black-Scholes formula)</strong> <em>The price of the european call option with strikeprice <span class="math inline">\(K\)</span> and maturity <span class="math inline">\(T\)</span> (contract function <span class="math inline">\(\Phi(S_t)=\left( S_t - K\right)^+\)</span>) takes the form <span class="math inline">\(\Pi_t=F(t,s)\)</span>, where</em></p>
<p><span class="math display">\[
F(t,s)=s N(d_1(t,s))-e^{-r(T-t)}KN(d_2(t,s)),\tag{7.52}
\]</span></p>
<em>where <span class="math inline">\(N\)</span> is the distribution-function for an <span class="math inline">\(\mathcal{N}(0,1)\)</span>-distributed random variable and</em>
<span class="math display">\[\begin{align*}
d_1(t,s)&amp;=\frac{1}{\sigma \sqrt{T-t}}\left(\log\left(\frac{s}{K}\right)+\left(r+\frac{1}{2}\sigma^2\right)(T-t)\right),\tag{7.53}\\
d_2(t,s)&amp;=d_1(t,s)-\sigma\sqrt{T-t}.\tag{7.54}
\end{align*}\]</span>
</blockquote>

<details>
<summary>
<strong>Proof.</strong>
</summary>
<p>We let the market be given in terms of the price processes <span class="math inline">\(S\)</span> and <span class="math inline">\(B\)</span> with dynamics.
<span class="math display">\[\begin{align*}
dS_t&amp;=\mu S_t\ dt+\sigma S_t\ dW_t,\\
dB_t&amp;=r B_t\ dt,
\end{align*}\]</span>
with <span class="math inline">\(B_t=1\)</span> and <span class="math inline">\(S_t=s\)</span>. We assume that <span class="math inline">\(\mu,\sigma, r\)</span> are deterministic real numbers. Consider the contingent claim</p>
<p><span class="math display">\[
\Phi(S_t)=\left( S_t - K\right)^+,
\]</span></p>
<p>that is the European call option. Let <span class="math inline">\(Q\)</span> be a martingale measure such that the dynamics of <span class="math inline">\(S\)</span> may be written as</p>
<p><span class="math display">\[
dS_t=r S_t\ dt+\sigma S_t\ dW^Q_t,
\]</span></p>
<p>then <span class="math inline">\(S_t\)</span> is clearly a GBM wrt. the measure <span class="math inline">\(Q\)</span>. Therefore we know the solution given in terms of the increment of the Brownian motion <span class="math inline">\(W^Q\)</span> as follows</p>
<p><span class="math display">\[
S_u=s\cdot \exp\left\{\left(r-\frac{1}{2}\sigma^2\right)(u-t)+\sigma\left(W_u^Q-W_t^Q\right)\right\},
\]</span></p>
<p>for some initial condition <span class="math inline">\(S_t=s\)</span>. From theorem 7.10 we know that the only pricing function which takes the form</p>
<p><span class="math display">\[
\Pi_t[\Phi(S_T)]=F(t,S_t),
\]</span></p>
<p>can only be consistent with the absence of arbitrage if <span class="math inline">\(F\)</span> is the solution the the boundary value problem
<span class="math display">\[\begin{align*}
F_t(t,s)+rsF_s(t,s)+\frac{1}{2}s^2\sigma^2F_{ss}(t,s)-rF(t,s)&amp;=0,\\
F(T,s)&amp;=\Phi(s).
\end{align*}\]</span>
From Feymann-Kac we then know that the stochastic representation of such a solution take the form</p>
<p><span class="math display">\[
F(t,s)=e^{-r(T-t)}E_{t,s}^Q[\Phi(S_T)].
\]</span></p>
<p>Here the superscript refers to taking mean value with respect to the measure <span class="math inline">\(Q\)</span>. This gives the solution to the pricing function</p>
<p><span class="math display">\[
F(t,s)=e^{-r(T-t)}\int \Phi(S_T)\ dQ.
\]</span></p>
<p>Under the measure <span class="math inline">\(Q\)</span> we have that for <span class="math inline">\(u\ge t\)</span>:</p>
<p><span class="math display">\[
Z_u=\log (S_u/s)\sim \mathcal{N}\left(\left(r-\frac{1}{2}\sigma^2\right)(u-t),\sigma\sqrt{u-t}\right)
\]</span></p>
<p>Hence we may set <span class="math inline">\(u=T\)</span> and observe that
<span class="math display">\[\begin{align*}
F(t,s)&amp;=e^{-r(T-t)}\int_{-\infty}^\infty \Phi(se^z) f(z)\ dz\\
&amp;=e^{-r(T-t)}\int_{-\infty}^\infty (se^z-K)^+ f(z)\ dz\\
&amp;=e^{-r(T-t)}\int_{\log\left(\frac{K}{s}\right)}^{\infty} (se^z-K) f(z)\ dz\\
&amp;=e^{-r(T-t)}\left(s\int_{\log\left(\frac{K}{s}\right)}^{\infty} e^z f(z)\ dz-K\int_{\log\left(\frac{K}{s}\right)}^{\infty} f(z)\ dz\right),
\end{align*}\]</span>
where we used that <span class="math inline">\(f\)</span> is the distribution function of a normal distributed random variable with mean <span class="math inline">\((r-\sigma^2/2)(T-t)\)</span> and variance <span class="math inline">\(\sigma\sqrt{T-t}\)</span> and that</p>
<p><span class="math display">\[
(se^z-K)^+ \ge 0\iff se^z\ge K\iff z\ge \log\left(\frac{K}{s}\right)
\]</span></p>
<p>Using that the MGF of a <span class="math inline">\(X\sim\mathcal{N}(\alpha, \beta^2)\)</span> variable is</p>
<p><span class="math display">\[
E[e^{tX}]=e^{\alpha t+\frac{1}{2}\beta ^2t^2},
\]</span></p>
<p>and the shorthand <span class="math inline">\(N(t)\)</span> for the distribution function of the standard normal distribution, we have
<span class="math display">\[\begin{align*}
F(t,s)&amp;=e^{-r(T-t)}\left(sE\left[e^{Z_T}1_{Z_T\ge \log\left(\frac{K}{s}\right)}\right]-K P\left(Z_T\ge \log\left(\frac{K}{s}\right)\right)\right)\\
&amp;=e^{-r(T-t)}s\exp\left\{\left(r-\frac{1}{2}\sigma^2\right)(T-t)+\frac{1}{2}\sigma^2(T-t)\right\}E\left[1_{Z_T\ge \log\left(\frac{K}{s}\right)}\right]\\
&amp;-e^{-r(T-t)}K P\left(X\ge\frac{1}{\sigma\sqrt{T-t}}\left( \log\left(\frac{K}{s}\right)-(r-\sigma^2/2)(T-t)\right)\right)\\
&amp;=sE\left[1_{Z_T\ge \log\left(\frac{K}{s}\right)}\right]-e^{-r(T-t)}K P\left(X\le\frac{1}{\sigma\sqrt{T-t}}\left(\log\left(\frac{s}{K}\right)+(r-\sigma^2/2)(T-t)\right)\right)\\
&amp;=sN(d_1(s,t))-e^{-r(T-t)}K N\left(d_2(s,t)\right),
\end{align*}\]</span>
as desired. <span class="math inline">\(\blacksquare\)</span></p>
</details>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="completeness-and-hedging" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Completeness and Hedging<a href="continuous-time-finance.html#completeness-and-hedging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We derived the pricing function of the european call option above and introduced the theory around boundary value problems and Feymann-Kac solution to the partial differential stochastic equation. Now we want to see if a portfolio exists such that it gives the payout <span class="math inline">\(\Phi(S_T)\)</span> with probability one.</p>
<p>In order to do this, we return to the concept of hedge and replication.</p>
<blockquote class="def">
<p><strong>Definition 8.1. (Bjork)</strong> <em>We say that a <span class="math inline">\(T\)</span>-claim <span class="math inline">\(\mathcal{X}\)</span> can be <strong>replicated</strong>, alternatively the it is <strong>reachable</strong> or <strong>hedgeable</strong>, if there exists a self-financing portfolio <span class="math inline">\(h\)</span> such that</em></p>
<p><span class="math display">\[
V_T^h=\mathcal{X},\ P-\text{a.s.}\tag{8.1}
\]</span></p>
<p><em>In this case we say that <span class="math inline">\(h\)</span> is a <strong>hedge</strong> against <span class="math inline">\(\mathcal{X}\)</span>. Alternatively, <span class="math inline">\(h\)</span> is called a <strong>replicating</strong> or <strong>hedging</strong> portfolio. If every contingent claim is reachable we say that the market is <strong>complete</strong>.</em></p>
</blockquote>
<p>If we can find a portfolio <span class="math inline">\(h\)</span> that reaches <span class="math inline">\(\mathcal{X}\)</span> in value over the time period <span class="math inline">\([t,T]\)</span> it must mean, that holding the portfolio is equivalent with holding the contract itself. We therefore have the natural assumption that the price process must satisfie <span class="math inline">\(\Pi_t[\mathcal{X}]=V_t^h\)</span> for all <span class="math inline">\(t\ge 0\)</span>. How this relates to the absence of arbitrage is given below.</p>
<blockquote class="prop">
<p><strong>Proposition 8.2. (Bjork)</strong> <em>Suppose <span class="math inline">\(\mathcal{X}\)</span> is hedged using the portfolio <span class="math inline">\(h\)</span>. Then the only price process <span class="math inline">\(\Pi_t[\mathcal{X}]\)</span> which is consistent with no arbitrage is given by <span class="math inline">\(\Pi_t[\mathcal{X}]=V_t^h\)</span>. Furthermore, if <span class="math inline">\(\mathcal{X}\)</span> can be hedged by both <span class="math inline">\(h\)</span> and <span class="math inline">\(g\)</span> then <span class="math inline">\(V_t^g=V_t^h\)</span> for all <span class="math inline">\(t\)</span> with probability one.</em></p>
</blockquote>
<div id="completeness-in-black-scholes" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Completeness in Black-Scholes<a href="continuous-time-finance.html#completeness-in-black-scholes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Black-Scholes model will be investegated in the following. We start by stating the important theorem.</p>
<blockquote class="thm">
<p><strong>Theorem 8.3. (Bjork)</strong> <em>Consider the Black-Scholes model given by</em>
<span class="math display">\[\begin{align*}
dS_t&amp;=\mu(t,S_t) S_t\ dt+\sigma(t,S_t) S_t\ dW_t,\tag{8.2}\\
dB_t&amp;=r B_t\ dt,\tag{8.3}
\end{align*}\]</span>
<em>The model above is complete.</em></p>
</blockquote>
<p>The following lemma gives us replicability of a <strong>simple</strong> claim (which we will restrict ud to).</p>
<blockquote class="lem">
<strong>Lemma 8.4. (Bjork)</strong> <em>Suppose that there exist an adapted process <span class="math inline">\(V\)</span> and an adapted process <span class="math inline">\(w=[w^B,w^S]\)</span> with <span class="math inline">\(w^B_t+w^S_t=1\)</span> (eq. 8.4) for all <span class="math inline">\(t\ge 0\)</span>, such that</em>
<span class="math display">\[\begin{align*}
dV_t&amp;=V_t(w_t^Br+w_t^S\mu(t,S_t))\ dt+V_tw_t^S\sigma(t,S_t)\ dW_t,\tag{8.5}\\
V_t&amp;=\Phi(S_t).\tag{8.5}
\end{align*}\]</span>
<em>Then the claim <span class="math inline">\(\mathcal{X}=\Phi(S_t)\)</span> can be replicated using <span class="math inline">\(w\)</span> as the relative portfolio. The corresponding value process is given by the process <span class="math inline">\(V\)</span> and the absolute portfolio <span class="math inline">\(h\)</span> is given by</em>
<span class="math display">\[\begin{align*}
h_t^B&amp;=\frac{w_t^B V_t}{B_t},\tag{8.6}\\
h_t^S&amp;=\frac{w_t^S V_t}{S_t}.\tag{8.7}
\end{align*}\]</span>
</blockquote>
<p>Doing some heuristics we come up with some clever weights, which turns on to adhere to the boundary value problem formulated in the Black-Scholes equation. Given that the weights gives rise to the desired value process, we have succesfully found the portfolio weight (see lemma above).</p>
<blockquote class="thm">
<p><strong>Theorem 8.5. (Bjork)</strong> <em>Consider the Black-Scholes model given in (8.3)-(8.4), and a simple contingent claim <span class="math inline">\(\mathcal{X}=\Phi(S_t)\)</span>. Define <span class="math inline">\(F\)</span> as the solution to the boundary value problem</em>
<span class="math display">\[\begin{align*}
F_t(t,s)+rsF_s(t,s)+\frac{1}{2}s^2\sigma^2F_{ss}(t,s)-rF(t,s)&amp;=0,\tag{8.17}\\
F(T,s)&amp;=\Phi(s).\tag{8.17}
\end{align*}\]</span>
<em>Then <span class="math inline">\(\mathcal{X}\)</span> can be replicated by the relative portfolio</em>
<span class="math display">\[\begin{align*}
w_t^B&amp;=\frac{F(t,S_t)-S_tF_s(t,S_t)}{F(t,S_t)},\tag{8.18}\\
w_t^S&amp;=\frac{S_tF_s(t,S_t)}{F(t,S_t)}.\tag{8.19}
\end{align*}\]</span>
<em>The corresponding absolute portfolio is given by</em>
<span class="math display">\[\begin{align*}
h_t^B&amp;=\frac{F(t,S_t)-S_tF_s(t,S_t)}{B_t},\tag{8.20}\\
h_t^S&amp;=F_s(t,S_t),\tag{8.21}
\end{align*}\]</span>
<em>and the value process <span class="math inline">\(V^h\)</span> is given by</em></p>
<p><span class="math display">\[
V^h_t=F(t,S_t).\tag{8.22}
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 8.6. (Bjork)</strong> <em>Consider the Black-Scholes model given in (8.3)-(8.4), and a contingent claim on the form <span class="math inline">\(\mathcal{X}=\Phi(S_T,Z_T)\)</span> (eq. 8.29). We define the process <span class="math inline">\(Z_t\)</span> as</em></p>
<p><span class="math display">\[
Z_t=\int_0^tg(u,S_u)\ du,\tag{8.30}
\]</span></p>
<p><em>for some choice of the deterministic function <span class="math inline">\(g\)</span>. Then <span class="math inline">\(\mathcal{X}\)</span> can be replicated using a relative portfolio given by</em>
<span class="math display">\[\begin{align*}
w_t^B&amp;=\frac{F(t,S_t,Z_t)-S_tF_s(t,S_t,Z_t)}{F(t,S_t,Z_t)},\tag{8.31}\\
w_t^S&amp;=\frac{S_tF_s(t,S_t,Z_t)}{F(t,S_t,Z_t)}.\tag{8.32}
\end{align*}\]</span>
<em>where <span class="math inline">\(F\)</span> is the solution to the boundary value problem</em>
<span class="math display">\[\begin{align*}
F_t(t,s,z)+rsF_s(t,s,z)+\frac{1}{2}s^2\sigma^2F_{ss}(t,s,z)-rF(t,s,z)&amp;=0,\tag{8.33}\\
F(T,s,z)&amp;=\Phi(s,z).\tag{8.33}
\end{align*}\]</span>
<em>The corresponding value process is given by <span class="math inline">\(V_t=F(t,S_t,Z_t)\)</span>, and <span class="math inline">\(F\)</span> has the stochastic representation</em></p>
<p><span class="math display">\[
F(t,s,z)=e^{-r(T-t)}E^Q_{t,s,z}[\Phi(S_T,Z_T)],\tag{8.34}
\]</span></p>
<p><em>where the <span class="math inline">\(Q\)</span>-dynamics are given by</em>
<span class="math display">\[\begin{align*}
dS_u&amp;=rS_u\ du + S_u\sigma(u,S_u)\ dW^Q_u,\tag{8.35}\\
S_t&amp;=s,\tag{8.36}\\
dZ_u&amp;=g(u,S_u)\ du,\tag{8.37}\\
Z_t&amp;=z.\tag{8.38}
\end{align*}\]</span></p>
</blockquote>
</div>
<div id="absence-of-arbitrage-1" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Absence of Arbitrage<a href="continuous-time-finance.html#absence-of-arbitrage-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In general we have conflicting forces when evaluating when a certain market is arbitrage free and/or complete. We have in simple terms the non-rigorous theorem below.</p>
<blockquote class="thm">
<p><strong>Meta-theorem 8.3.1. (Bjork)</strong> <em>Let <span class="math inline">\(N\)</span> denote the number of underlying <strong>traded</strong> assets in the model <strong>excluding</strong> the risk free asset, and let <span class="math inline">\(R\)</span> denote the number of random sources driving the price system. Genericallly we then have the following statements.</em></p>
<ul>
<li><em>The model is arbitrage free if and only if <span class="math inline">\(N\le R\)</span>.</em></li>
<li><em>The model is complete if and only if <span class="math inline">\(N\ge R\)</span>.</em></li>
<li><em>The model is arbitrage free and complete if and only if <span class="math inline">\(N=R\)</span>.</em></li>
</ul>
</blockquote>
</div>
<div id="incomplete-markets" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Incomplete Markets<a href="continuous-time-finance.html#incomplete-markets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We assume a market with a risk free asset and one risky assets with dynamics</p>
<p><span class="math display">\[
dX_t=\mu(t,X_t)\ dt+\sigma(t,X_t)\ dW_t.\tag{9.1}
\]</span></p>
<p>We want to find a unique price of a derivative on a functional form of the risky asset. We assume that we cannot invest in the asset representing the process <span class="math inline">\(X_t\)</span> and so we can solely write contracts based on the observation <span class="math inline">\(X_T\)</span>. The problem here is that we can only short or long the risk free asset and so no derivative is replicable.</p>
<p>The way we solve this problem is by having the market set the price of risk and universally price derivatives based on this given price process. We then have the assumptions</p>
<p><strong>Assumption 9.2.1</strong> <em>We have the market given with the only investable asset <span class="math inline">\(B\)</span> with dynamics</em></p>
<p><span class="math display">\[
dB_t=rB_t\ dt.\tag{9.2}
\]</span></p>
<p><em>We furthermore, have an empirically observable stochastic process <span class="math inline">\(X\)</span> which is <strong>not</strong> the price process of any traded asset. The <span class="math inline">\(P\)</span>-dynamics of <span class="math inline">\(X\)</span> is given by</em></p>
<p><span class="math display">\[
dX_t=\mu(t,X_t)\ dt+\sigma(t,X_t)\ dW_t.
\]</span></p>
<p><strong>Assumption 9.2.2</strong> <em>There is a liquid market for every contingent claim.</em></p>
<p><strong>Assumption 9.2.3</strong> <em>We assume that</em></p>
<ul>
<li><em>There is a liquid, frictionless market for each of the contingent claims <span class="math inline">\(\mathcal{Y}\)</span> and <span class="math inline">\(\mathcal{Z}\)</span>.</em></li>
<li><em>The market prices of the claims are of the form</em>
<span class="math display">\[ \Pi_t[\mathcal{Y}] = F(t,X_t),\]</span>
<span class="math display">\[ \Pi_t[\mathcal{Z}] = G(t,X_t),\]</span>
<em>where <span class="math inline">\(F\)</span> and <span class="math inline">\(G\)</span> are smooth real valued function.</em></li>
</ul>
<p>From Ito’s formula we have the dynamics
<span class="math display">\[\begin{align*}
dF=\mu_F F\ dt+\sigma_F F\ dW,\tag{9.4}\\
dG=\mu_G G\ dt+\sigma_G G\ dW.\tag{9.5}
\end{align*}\]</span>
Where the processes <span class="math inline">\(\mu_F\)</span> and <span class="math inline">\(\sigma_F\)</span> are given by
<span class="math display">\[\begin{align*}
\mu_F&amp;=\frac{F_t+\mu F_x+\frac{1}{2}\sigma^2 F_{xx}}{F},\\
\sigma_F&amp;=\frac{\sigma F_x}{F}.
\end{align*}\]</span>
By forming a portfolio of the two contracts we lead to the relation.</p>
<p><span class="math display">\[
\frac{\mu_F-r}{\sigma_F}=\frac{\mu_G-r}{\sigma_G}.
\]</span></p>
<p>This gives the important insight.</p>
<blockquote class="prop">
<p><strong>Proposition 9.1. (Bjork)</strong> <em>Assume that the market for derivatives is free of arbitrage. Then there exists a universal process <span class="math inline">\(\lambda(t,X_t)\)</span> such that, with probability one, and for all <span class="math inline">\(t\)</span>, we have</em></p>
<p><span class="math display">\[
\frac{\mu_F(t,X_t)-r}{\sigma_F(t,X_t)}=\mu(t,X_t),\tag{9.7}
\]</span></p>
<p><em>regardless of the specific choice of the derivative <span class="math inline">\(F\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 9.2. (Bjork)</strong> <em>Assume absence of arbitrage, the pricing function <span class="math inline">\(F(t,x)\)</span> of the <span class="math inline">\(T\)</span>-claim <span class="math inline">\(\Phi(X_T)\)</span> solves the following boundary value problem.</em>
<span class="math display">\[\begin{align*}
F_t(t,x)+\mathcal{A}F(t,x)-rF(t,x)&amp;=0,\hspace{15pt}&amp;(t,x)\in (0,T)\times \mathbb{R},\tag{9.8}\\
F(T,x)&amp;=\Phi(x), &amp;x\in\mathbb{R},\tag{9.9}
\end{align*}\]</span>
<em>where</em></p>
<p><span class="math display">\[
\mathcal{A}F(t,x)=\left\{\mu(t,x)-\lambda(t,x)\sigma(t,x)\right\}F_x(t,x)+\frac{1}{2}\sigma^2(t,x)F_{xx}(t,x).
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 9.3. (Bjork)</strong> <strong>(Risk neutral valuation)</strong> <em>Assuming absence of arbitrage, the pricing function <span class="math inline">\(F(t,x)\)</span> of the <span class="math inline">\(T\)</span>-claim <span class="math inline">\(\Phi(X_T)\)</span> is given by the formula</em></p>
<p><span class="math display">\[
F(t,x)=e^{-r(T-t)}E^Q_{t,x}[\Phi(X_T)].\tag{9.11}
\]</span></p>
<p><em>The dynamics of <span class="math inline">\(X\)</span> under the martingale measure <span class="math inline">\(Q\)</span> are given by</em></p>
<p><span class="math display">\[
dX_t=\left\{\mu(t,x)-\lambda(t,x)\sigma(t,x)\right\}F_x(t,x)+\sigma(t,x)\ dW^Q_t,
\]</span></p>
<p><em>where <span class="math inline">\(W^Q\)</span> is a <span class="math inline">\(Q\)</span>-Brownien motion.</em></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="parity-relations" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Parity relations<a href="continuous-time-finance.html#parity-relations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="put-call-parity" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Put-call Parity<a href="continuous-time-finance.html#put-call-parity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The notion of continuous rebalancing the replicating portfolio require leads to problems in the real world. Trading does cost some money (typical in fractions) and so contiuous balancing would make the portfolio go to 0 rather quickly. Why? The Brownian motion has unbounded variation and so we would have to sell and buy the portfolio uncountable many time in any interval and the shift in weight is not neglible. Because of this we would like to see which claims we can replicate by buying and holding a combination of assets and derivatives.</p>
<blockquote class="prop">
<p><strong>Proposition 10.1. (Bjork)</strong> <em>Let <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Psi\)</span> be contract functions for the <span class="math inline">\(T\)</span>-claims <span class="math inline">\(\mathcal{X}=\Phi(S_T)\)</span> and <span class="math inline">\(\mathcal{Y}=\Psi(S_T)\)</span>. Then for any real numbers <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> we have the following price relation:</em></p>
<p><span class="math display">\[
\Pi_t[\alpha \Phi + \beta\Psi]=\alpha \Pi_t[\Phi]+\beta\Pi_t[\Psi].\tag{10.1}
\]</span></p>
</blockquote>
<p>If we consider the basic contract functions
<span class="math display">\[\begin{align*}
\Phi_S(x)&amp;=x,\tag{10.2}\\
\Phi_B(x)&amp;=1,\tag{10.3}\\
\Phi_{C,K}(x)&amp;=(x-K)^+,\tag{10.4}\\
\Phi_{P,K}(x)&amp;=(K-x)^+.
\end{align*}\]</span>
That is a contract paying (respectively): the price of one stock, 1 dollar, one european call and one european put both with strike <span class="math inline">\(K\)</span>. It is clear that the following prices are
<span class="math display">\[\begin{align*}
\Pi_t[\Phi_S]&amp;=S_t,\tag{10.5}\\
\Pi_t[\Phi_B]&amp;=e^{-r(T-t)},\tag{10.6}\\
\Pi_t[\Phi_{C,K}]&amp;=c(t,S_t;K,T),\tag{10.7}\\
\Pi_t[\Phi_{P,K}]&amp;=p(t,S_t;K,T).
\end{align*}\]</span>
Where <span class="math inline">\(c(t,s,K,T,r,\sigma)\)</span> and <span class="math inline">\(p(t,s,K,T,r,\sigma)\)</span> are the pricing function of the european call and put option. We see that we can replicate these payouts by: buying the stock today and selling at time <span class="math inline">\(T\)</span>, buying a zero coupon <span class="math inline">\(T\)</span>-bond with face value 1, buying the call and put option.</p>
<p>Then we can by choosing <span class="math inline">\(\alpha,\beta,\gamma_1,...,\gamma_n\)</span> form a portfolio consisting of <span class="math inline">\(\alpha\)</span> stocks, <span class="math inline">\(\beta\)</span> <span class="math inline">\(T\)</span>-bonds and <span class="math inline">\(\gamma_i\)</span> call options with maturity <span class="math inline">\(T\)</span> and strike <span class="math inline">\(K_i\)</span>. The price is then a linear combination given the choice (se proposition 10.1).</p>
<p>The put option is not includet in the above portfolio as we have the put-call parity below</p>
<blockquote class="prop">
<p><strong>Proposition 10.2. (Bjork)</strong> <strong>(Put-call parity)</strong> <em>Consider a European call and a European put, both with strike <span class="math inline">\(K\)</span> and time of maturity <span class="math inline">\(T\)</span>. Then we have the relation.</em></p>
<p><span class="math display">\[
p(t,s) = Ke^{-r(T-t)}+c(t,s)-s.\tag{10.11}
\]</span></p>
<p><em>In particular the put option can be replicated by a constant portfolio consisting of <span class="math inline">\(K\)</span> zero coupon <span class="math inline">\(T\)</span>-bonds, a European call option and a single short position in the underlying stock.</em></p>
</blockquote>
<p>We now have the pleasing proposition given the class of claims we can reach with the buy-and-hold portfolio with <span class="math inline">\(T\)</span>-bonds, stock and call options</p>
<blockquote class="prop">
<p><strong>Proposition 10.3. (Bjork)</strong> <em>Fix an arbitrary continuous contract function <span class="math inline">\(\Phi\)</span> with compact support. Then the corresponding contract can be replicated with arbitrary precision (in sup-norm) using a constant portfolio consisting only of bonds, call options and the underlying stock.</em></p>
</blockquote>
</div>
<div id="the-greeks" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> The Greeks<a href="continuous-time-finance.html#the-greeks" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When holding a portfolio we may denote the pricing function by <span class="math inline">\(P(t,s)\)</span>. Here we only have one <strong>underlying</strong> asset with price process <span class="math inline">\(S_t\)</span>. We now have two types of risk:</p>
<ul>
<li>Price changes in the underlying asset.</li>
<li>Misspecifications in the model parameters.</li>
</ul>
<p>These two risk give rise to “the greeks” as defined below.</p>
<blockquote class="def">
<p><strong>Definition 10.4. (Bjork)</strong> <em>The greeks of a portfolio is given by</em></p>
<p><span class="math display">\[
\Delta=\frac{\partial P}{\partial s},\ \Gamma=\frac{\partial^2 P}{\partial s^2},\ \rho=\frac{\partial P}{\partial r},\ \Theta=\frac{\partial P}{\partial t},\ \mathcal{V}=\frac{\partial P}{\partial s}.
\]</span></p>
</blockquote>
<p>For the call option in particular we have the following derivatives.</p>
<blockquote class="prop">
<strong>Proposition 10.5. (Bjork)</strong> <em>The greeks of a portfolio consisting of a single European call option with maturity <span class="math inline">\(T\)</span> and strike price <span class="math inline">\(K\)</span> have the following greeks (<span class="math inline">\(\varphi\)</span> denoting the density function of a <span class="math inline">\(\mathcal{N}(0,1)\)</span>-variable):</em>
<span class="math display">\[\begin{align*}
\Delta&amp;=N(d_1),\tag{10.17}\\
\Gamma&amp;=\frac{\varphi(d_1)}{s\sigma\sqrt{T-t}},\tag{10.18}\\
\rho&amp;=K(T-t)e^{-r(T-t)}N(d_2),\tag{10.19}\\
\Theta&amp;=-\frac{s\varphi(d_1)\sigma}{2\sqrt{T-t}}-rKe^{-r(T-t)}N(d_2),\tag{10.20}\\
\mathcal{V}&amp;=s\varphi(d_1)\sqrt{T-t}\tag{10.21}.
\end{align*}\]</span>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="fundamental-pricing-theorem-i-and-ii" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Fundamental pricing theorem I and II<a href="continuous-time-finance.html#fundamental-pricing-theorem-i-and-ii" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We start by stating the following theorem.</p>
<blockquote class="thm">
<p><strong>Theorem 11.1. (Bjork)</strong> <em>If at least on of the assets <span class="math inline">\(S^1,...,S^N\)</span> has diffusion term which is non-zero at all times, and if naive portfolio strategies are admitted, then the model admits arbitrage.</em></p>
</blockquote>
<p>We will go as follows. Derive the fundamental pricing theorem 1 and 2 in a setting with zero interest rate. Then we will extend the result in general by choosing a simple numeraire. We start by defining some basic notation.</p>
<blockquote class="def">
<p><strong>Definition 11.2. (Bjork)</strong> <em>Define the process <span class="math inline">\(h\)</span> as</em></p>
<p><span class="math display">\[
h=[h^0,h^S]:=[h^0,h^1,...,h^N]
\]</span></p>
<p><em>We define the following.</em></p>
<ul>
<li><em>For a process <span class="math inline">\(h\)</span>, its <strong>value process</strong> <span class="math inline">\(V_t^h\)</span> is defined by</em>
<span class="math display">\[
  V_t^h=h^0_t\cdot 1+\sum_{i=1}^Nh_t^iS_t^i,\tag{11.3}
  \]</span>
<em>or in compact form</em>
<span class="math display">\[
  V_t^h=h_t^0\cdot 1 + h_t^S S_t\tag{11.4}
  \]</span></li>
<li><em>An adapted process <span class="math inline">\(h^S\)</span> is called <strong>admissible</strong> if there exists a non-negative real number <span class="math inline">\(\alpha\)</span> (which may depend on the choice of <span class="math inline">\(h^S\)</span>) such that</em>
<span class="math display">\[
  \int_0^th_u^SdS_u\ge -\alpha,\tag{11.5}
  \]</span>
<em>for all <span class="math inline">\(t\in[0,T]\)</span>. A process <span class="math inline">\(h\)</span>, is called an <strong>admissible portfolio</strong> process if <span class="math inline">\(h^S\)</span> is admissible.</em></li>
<li><em>An admissible portfolio is said to be <strong>self-financing</strong>, if</em>
<span class="math display">\[
  V_t^h=V_0^h+\int_0^th_u^S\ dS_u,\tag{11.6}
  \]</span>
<em>i.e. if</em>
<span class="math display">\[
  dV_t^h=h_t^S\ dS_t.\tag{11.7}
  \]</span></li>
</ul>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 11.3. (Bjork)</strong> <em>For any adapted process <span class="math inline">\(h^S\)</span> satisfying the admissibility condition above, and for any real number <span class="math inline">\(x\)</span>, there exists a unique adapted process <span class="math inline">\(h^0\)</span>, such that:</em></p>
<ul>
<li><em>The process <span class="math inline">\(h\)</span> defined by <span class="math inline">\(h=[h^0,h^S]\)</span> is self-financing.</em></li>
<li><em>The value process is given by</em>
<span class="math display">\[
  V_t^h=x+\int_0^th_u^S\ dS_u.\tag{11.8}
  \]</span></li>
</ul>
<p><em>In particular, the space <span class="math inline">\(\mathcal{K}_0\)</span> of portfolio values, reachable at time <span class="math inline">\(T\)</span> by means of a self-financing portfolio with zero initial cost is given by</em></p>
<p><span class="math display">\[
\mathcal{K}_0=\left\{\int_0^Th_t^S\ dS_u :\ h^S\ \text{is}\ \text{admissible}\right\}.\tag{11.9}
\]</span></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 11.4. (Bjork)</strong> <em>A probability measure <span class="math inline">\(Q\)</span> on <span class="math inline">\(\mathcal{F}_T\)</span> is called <strong>equivalent martingale measure</strong> for the market model, the numeraire <span class="math inline">\(S^0\)</span>, and the time interval <span class="math inline">\([0,T]\)</span>, if it has the following properties:</em></p>
<ul>
<li><em><span class="math inline">\(Q\sim P\)</span> on <span class="math inline">\(\mathcal{F}_T\)</span>, so <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> are equivalent.</em></li>
<li><em>All price processes <span class="math inline">\(S^0,S^1,...,S^N\)</span> are martingales under <span class="math inline">\(Q\)</span> on the time interval <span class="math inline">\([0,T]\)</span>.</em></li>
</ul>
<p><em>An equivalent martingale measure will often be referred to as just “a martingale measure” or as “an EMM”. If <span class="math inline">\(Q\sim P\)</span> has the property that <span class="math inline">\(S^0,S^1,...,S^N\)</span> are local martingales, then <span class="math inline">\(Q\)</span> is called a <strong>local martingale measure</strong>.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.5. (Bjork)</strong> <strong>(The First Fundamental Theorem)</strong> <em>The model is arbitrage free “essentially” if and only if there existis a (local) martingale measure <span class="math inline">\(Q\)</span>.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 11.6. (Bjork)</strong> <em>With the notation above, we say that the model admits</em></p>
<ul>
<li><em><strong>No Arbitrage</strong> (NA) if</em>
<span class="math display">\[
  \mathcal{C}\cap L_+^\infty=\{0\},\tag{11.21}
  \]</span></li>
<li><em><strong>No Free Lunch with Vanishing Risk</strong> (NFLVR) if</em>
<span class="math display">\[
  \tilde{\mathcal{C}}\cap L_+^\infty=\{0\},\tag{11.22}
  \]</span>
<em>where <span class="math inline">\(\tilde{\mathcal{C}}\)</span> denotes the closure of <span class="math inline">\(\mathcal{C}\)</span> in <span class="math inline">\(L^\infty\)</span>.</em></li>
</ul>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.7. (Bjork)</strong> <strong>(Kreps-Yan Separation Theorem)</strong> <em>If <span class="math inline">\(\mathcal{C}\)</span> is weak* closed, and if</em></p>
<p><span class="math display">\[
\mathcal{C}\cap L_+^\infty=\{0\},
\]</span></p>
<p><em>then there exists a random variable <span class="math inline">\(L\in L^1\)</span> such that <span class="math inline">\(L\)</span> is <span class="math inline">\(P\)</span> almost surely strictly positive, and</em></p>
<p><span class="math display">\[
E^P[L\cdot X]\le 0,
\]</span></p>
<p><em>for all <span class="math inline">\(X\in\mathcal{C}\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 11.8. (Bjork)</strong> <em>If the asset price processes are uniformly bounded, then the condition NFLVR implies that <span class="math inline">\(\mathcal{C}\)</span> is weak* closed.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.9. (Bjork)</strong> <strong>(First Fundamental Theorem)</strong> <em>Assume that the asset price process <span class="math inline">\(S\)</span> is bounded. Then there exists an equivalent martingale measure if and only if the model satisfies NFLVR.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.10. (Bjork)</strong> <strong>(First Fundamental Theorem)</strong> <em>Assume that the asset price process <span class="math inline">\(S\)</span> is locally bounded. Then there exists an equivalent martingale measure if and only if the model satisfies NFLVR.</em></p>
</blockquote>
<p><strong>Assumption 11.4.1. (Bjork)</strong> <em>We assume that </em><span class="math inline">\(S_t^0&gt;0\)</span> <span class="math inline">\(P\)</span><em>-a.s. for all </em><span class="math inline">\(t\ge 0\)</span>.</p>
<blockquote class="def">
<p><strong>Definition 11.11. (Bjork)</strong> <em>The <strong>normalized economy</strong> (also referred to as the “Z-economy”) is defined by the price vector process <span class="math inline">\(Z\)</span>, where</em></p>
<p><span class="math display">\[
Z_t=\frac{S_t}{S_t^0}.
\]</span></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 11.12. (Bjork)</strong></p>
<ul>
<li><em>A <strong>portfolio stragegy</strong> is any adapted <span class="math inline">\((N+1)\)</span>-dimensional process</em>
<span class="math display">\[
  h_t=[h_t^0,h_t^1,...,h_t^N].
  \]</span></li>
<li><em>The <strong>S-value process</strong> <span class="math inline">\(V_t^S\)</span> corresponding to the portfolio <span class="math inline">\(h\)</span> is <span class="math inline">\(h_tS_t\)</span>.</em></li>
<li><em>The <strong>Z-value process</strong> <span class="math inline">\(V_t^Z\)</span> corresponding to the portfolio <span class="math inline">\(h\)</span> is <span class="math inline">\(h_tZ_t\)</span>.</em></li>
<li><em>A portfolio is said to be <strong>admissible</strong> if it is admissible as an <span class="math inline">\(Z\)</span> portfolio.</em></li>
<li><em>An admissible portfolio is <strong>S-self-balancing</strong> if</em>
<span class="math display">\[
  dV_t^S=\sum_{i=0}^Nh_t^i\ dS_t^i\tag{11.26}
  \]</span></li>
<li><em>An admissible portfolio is <strong>Z-self-balancing</strong> if</em>
<span class="math display">\[
  dV_t^Z=\sum_{i=0}^Nh_t^i\ dZ_t^i.\tag{11.28}
  \]</span></li>
</ul>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 11.13. (Bjork)</strong> <strong>(Invariance Lemma)</strong> <em>With assumptions as above, the following hold.</em></p>
<ol style="list-style-type: lower-roman">
<li><em>A portfolio <span class="math inline">\(h\)</span> is S-self-financing if and only if it is Z-self-financing.</em></li>
<li><em>The value processes <span class="math inline">\(V^S\)</span> and <span class="math inline">\(V^Z\)</span> are connected by</em>
<span class="math display">\[
  V_t^Z=\frac{1}{S_t^0}\cdot V_t^S.
  \]</span></li>
<li><em>A claim <span class="math inline">\(\mathcal{Y}\)</span> is S-replical if and only if the claim</em>
<span class="math display">\[
  \frac{\mathcal{Y}}{S_T^0}
  \]</span>
<em>is Z-replicable.</em></li>
<li><em>The model is S arbitrage free if and only if it is Z arbitrage free.</em></li>
</ol>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.14. (Bjork)</strong> <strong>(The First Fundamental Theorem)</strong> <em>Consider the market model <span class="math inline">\(S^0,S^1,...,S^N\)</span> where we assume that <span class="math inline">\(S^0_t&gt;0\)</span>, <span class="math inline">\(P\)</span>-a.s. for all <span class="math inline">\(t\ge 0\)</span>. Assume furthermore that <span class="math inline">\(S^0,S^1,...,S^N\)</span> are locally bounded. Then the followin conditions are equivalent:</em></p>
<ul>
<li><em>The model satisfies NFLVR.</em></li>
<li><em>There exists a measure <span class="math inline">\(Q\sim P\)</span> such that the processes</em>
<span class="math display">\[
  Z^0,Z^1,...,Z^N,
  \]</span>
<em>are local martingales under <span class="math inline">\(Q\)</span>.</em></li>
</ul>
</blockquote>
<div id="completeness-1" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Completeness<a href="continuous-time-finance.html#completeness-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="lem">
<p><strong>Lemma 11.15. (Bjork)</strong> <em>Consider a given <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span>. Fix a martingale measure <span class="math inline">\(Q\)</span> and assume that the normalized claim <span class="math inline">\(X/S^0_T\)</span> is integrable. If the <span class="math inline">\(Q\)</span>-martingale <span class="math inline">\(M\)</span>, defined by</em></p>
<p><span class="math display">\[
M_t=E^Q\left[\left. \frac{X}{S^0_T}\right\vert \mathcal{F}_t\right],\tag{11.34}
\]</span></p>
<p><em>admits an integral representation of the form</em></p>
<p><span class="math display">\[
M_t=x+\sum_{i=1}^N\int_0^th_s^i\ dZ_s^i,\tag{11.35}
\]</span></p>
<p><em>then <span class="math inline">\(X\)</span> can be hedged in the S-economy. Furthermore, the replicating portfolio <span class="math inline">\((h^0,h^1,...,h^N)\)</span> is given by the above for <span class="math inline">\(h^i\)</span>, <span class="math inline">\(i=1,...,N\)</span> and <span class="math inline">\(h_t^0=M_t-\sum_{i=1}^Nh_t^iZ_t^i\)</span>.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.16. (Bjork)</strong> <strong>(Jacod)</strong> <em>Let <span class="math inline">\(\mathcal{M}\)</span> denote the convex set of equivalent martingale measures. Then, for any fixed <span class="math inline">\(Q\in\mathcal{M}\)</span>, the following statements are equivalent:</em></p>
<ul>
<li><em>Every <span class="math inline">\(Q\)</span> local martingale <span class="math inline">\(M\)</span> has dynamics of the form</em>
<span class="math display">\[
  dM_t=\sum_{i=1}^Nh_s^i\ dZ_s^i.
  \]</span></li>
<li><em><span class="math inline">\(Q\)</span> is an extremal point of <span class="math inline">\(\mathcal{M}\)</span>.</em></li>
</ul>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.17. (Bjork)</strong> <strong>(The Second Fundamental Theorem)</strong> <em>Assume that the market is arbitrage free and consider a fixed numeraire asset <span class="math inline">\(S^0\)</span>. Then the market is complete if and onlt if the martingale measure <span class="math inline">\(Q\)</span>, corresponding to the numeraire <span class="math inline">\(S^0\)</span>, is unique.</em></p>
</blockquote>
</div>
<div id="risk-neutral-valuation-formula" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Risk Neutral Valuation Formula<a href="continuous-time-finance.html#risk-neutral-valuation-formula" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have the setting of a market consisting of the assets <span class="math inline">\(S^0,...,S^N\)</span> of <span class="math inline">\(N+1\)</span> assets. We consider the numeraire <span class="math inline">\(S^0\)</span> being a risk free asset. We introduce a price of contingent claim <span class="math inline">\(X\)</span>, such that the extended market consisting of the price process of <span class="math inline">\(X\)</span> and the <span class="math inline">\(N+1\)</span> assets is arbitrage free. Alternatively, we can, equivalently, find a replicating portfolio <span class="math inline">\(h\)</span> such that <span class="math inline">\(V^h_T=X\)</span> with probability one.</p>
<blockquote class="thm">
<p><strong>Theorem 11.18. (Bjork)</strong> <strong>(General Pricing Equation)</strong> <em>The arbitrage free price process for the <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span> is given by</em></p>
<p><span class="math display">\[
\Pi_t[X]=S_t^0E^Q\left[\left.\frac{X}{S^0_T}\right\vert \mathcal{F}_t\right],\tag{11.41}
\]</span></p>
<p><em>where <span class="math inline">\(Q\)</span> is the (not necessarily unique) martingale measure for the a priori given market <span class="math inline">\(S^0,S^1,...,S^N\)</span>, with <span class="math inline">\(S^0\)</span> as the numeraire.</em></p>
</blockquote>
<p>If if we assume that the bank account takes the form</p>
<p><span class="math display">\[
S_t^0=S_0^0e^{-\int_0^tr(s)\ ds},
\]</span></p>
<p>where <span class="math inline">\(r\)</span> is the short rate, then we have the familier <em>risk neutral valuation formula</em>.</p>
<blockquote class="thm">
<p><strong>Theorem 11.19. (Bjork)</strong> <strong>(Risk Neutral Valuation Formula)</strong> <em>Assuming the existence of a short rate, the pricing formula takes the form</em></p>
<p><span class="math display">\[
\Pi_t[X]=E^Q\left[\left.e^{-\int_0^Tr(s)\ ds}X\right\vert \mathcal{F}_t\right],\tag{11.42}
\]</span></p>
<p><em>where <span class="math inline">\(Q\)</span> is the (not necessarily unique) martingale measure with the bank account as the numeraire.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 11.20. (Bjork)</strong> <em>A <strong>zero coupon bond</strong> with <strong>maturity date</strong> <span class="math inline">\(T\)</span>, also called a <span class="math inline">\(T\)</span>-bond, is a contract which guarantees the holder one dollar to be paid on the date <span class="math inline">\(T\)</span>. The price at time <span class="math inline">\(t\)</span> of a bond with maturity date <span class="math inline">\(T\)</span> is denoted by <span class="math inline">\(p(t,T)\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 11.21. (Bjork)</strong> <em>The price of a zero coupon <span class="math inline">\(T\)</span>-bond is given by</em></p>
<p><span class="math display">\[
p(t,T)=E^Q\left[\left.e^{-\int_t^Tr(s)\ ds}\right\vert \mathcal{F}_t\right],\tag{11.43}
\]</span></p>
<p><em>and in particular we have <span class="math inline">\(p(T,T)=1\)</span> for all <span class="math inline">\(T\ge 0\)</span> (eq. 11.44).</em></p>
</blockquote>
</div>
<div id="stochastic-discount-factors-1" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Stochastic Discount Factors<a href="continuous-time-finance.html#stochastic-discount-factors-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="def">
<p><strong>Definition 11.22. (Bjork)</strong> <em>Assume the existence of a short rate <span class="math inline">\(r\)</span>. For any fixed martingale measure <span class="math inline">\(Q\)</span>, let the likelihood process <span class="math inline">\(L\)</span> be defined by</em></p>
<p><span class="math display">\[
L_t=\frac{dQ}{dP},\ on\ \mathcal{F}_t.\tag{11.48}
\]</span></p>
<p><em>The <strong>stochastic discount factor</strong> (SDF) process <span class="math inline">\(\mathbf{M}\)</span>, corresponding to <span class="math inline">\(Q\)</span>, is defined as</em></p>
<p><span class="math display">\[
\mathbf{M}_t=e^{-\int_0^tr(s)\ ds}L_t\ \ \left(=\frac{1}{B_t}\cdot L_t\right).\tag{11.49/50}
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 11.23. (Bjork)</strong> <em>Assume absence of arbitrage. With notation as above, the following hold:</em></p>
<ul>
<li><em>For any sufficiently integrable <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span>, the arbitrage free price is given by</em>
<span class="math display">\[
  \Pi_t[X]=E^P\left[\left. \frac{\mathbf{M}_T}{\mathbf{M}_t} X \ \right\vert\ \mathcal{F}_t\right].\tag{11.51}
  \]</span></li>
<li><em>For any arbitrage free asset price process <span class="math inline">\(S\)</span> (derivative or underlying) the process <span class="math inline">\(\mathbf{M}_tS_t\)</span> is a (local) <span class="math inline">\(P\)</span>-martingale.</em></li>
<li><em>The <span class="math inline">\(P\)</span>-dynamics of <span class="math inline">\(\mathbf{M}\)</span> are given by</em>
<span class="math display">\[
  d\mathbf{M}_t=-r_t\mathbf{M}_t\ dt+\frac{1}{B_t}\ dL_t.\tag{11.53}
  \]</span></li>
</ul>
</blockquote>
</div>
<div id="summary" class="section level3 hasAnchor" number="5.6.4">
<h3><span class="header-section-number">5.6.4</span> Summary<a href="continuous-time-finance.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="thm">
<p><strong>Theorem 11.24. (Bjork)</strong> <strong>(First Fundamental Theorem)</strong> <em>The market model is free of arbitrage if and only if there exists a <strong>martingale measure</strong>, i.e. a measure <span class="math inline">\(Q\sim P\)</span> such that the processes</em>
<span class="math display">\[
\frac{S_t^0}{S_t^0},\frac{S_t^1}{S_t^0},...,\frac{S_t^N}{S_t^0}
\]</span>
<em>are (local) martingales under <span class="math inline">\(Q\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<strong>Proposition 11.25. (Bjork)</strong> <em>If the numeraire <span class="math inline">\(S^0\)</span> is the money account, i.e.</em>
<span class="math display">\[
S^0_t=e^{\int_0^t r(s)\ ds},
\]</span>
<em>where <span class="math inline">\(r\)</span> is the (possibly stochastic) short rate, and if we assume that all processes are Brownian driven, then a measure <span class="math inline">\(Q\sim P\)</span> is a martingale measure if and only if all assets <span class="math inline">\(S^0,S^1,...,S^N\)</span> have the short rate as their local rates of return, i.e. if the <span class="math inline">\(Q\)</span>-dynamics are of the form</em>
<span class="math display">\[
dS_t^i=S_t^ir_t\ dt+S_t^i \sigma_t^i\ dW_t^Q,\tag{11.54}
\]</span>
<em>where <span class="math inline">\(W^Q\)</span> is a (multidimensional) <span class="math inline">\(Q\)</span>-Brownian motion.</em>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 11.26. (Bjork)</strong> <strong>(Second Fundamental Theorem)</strong> <em>Assuming absence of arbitrage, the market model is complete if and only if the martingale measure <span class="math inline">\(Q\)</span> is unique.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 11.27. (Bjork)</strong></p>
<ol style="list-style-type: decimal">
<li><em>In order to avoid arbitrage, <span class="math inline">\(X\)</span> must be priced according to the formula</em>
<span class="math display">\[
  \Pi_t[X]=S^0_tE^Q\left[\left. \frac{X}{S^0_T}\ \right\vert\ \mathcal{F}_t\right],\tag{11.55}
  \]</span>
<em>where <span class="math inline">\(Q\)</span> is a martingale measure for <span class="math inline">\([S^0,S^1,...,S^N]\)</span>, with <span class="math inline">\(S^0\)</span> as the numeraire.</em></li>
<li><em>In particular, we can choose the bank account <span class="math inline">\(B_t\)</span>, as the numeraire. Then <span class="math inline">\(B\)</span> has the dynamics</em>
<span class="math display">\[
  dB_t=r_tB_t\ dt,\tag{11.56}
  \]</span>
<em>where <span class="math inline">\(r\)</span> is the (possibly stochastic) short rate process. In this case the pricing formula above reduces to</em>
<span class="math display">\[
  \Pi_t[X]=E^Q\left[\left. e^{-\int_t^T r(s)\ ds}X\ \right\vert\ \mathcal{F}_t\right].\tag{11.57}
  \]</span></li>
<li><em>As a special case, the price of a zero coupon <span class="math inline">\(T\)</span>-bond is given by</em>
<span class="math display">\[
  p(t,T)=E^Q\left[\left. e^{-\int_t^T r(s)\ ds}\ \right\vert\ \mathcal{F}_t\right].\tag{11.58}
  \]</span></li>
<li><em>Defining the stochastic discount factor <span class="math inline">\(\mathbf{M}\)</span> by <span class="math inline">\(\mathbf{M}_t=B_t^{-1}L_t\)</span> we also have the pricing formula.</em>
<span class="math display">\[
  \Pi_t[X]=E^Q\left[\left. \frac{\mathbf{M}_T}{\mathbf{M}_t}X\ \right\vert\ \mathcal{F}_t\right].\tag{11.59}
  \]</span></li>
<li><em>Different choices of <span class="math inline">\(Q\)</span> will generically give rise to different price processes for a fixed claim <span class="math inline">\(X\)</span>. However, if <span class="math inline">\(X\)</span> is attainable then all choices of <span class="math inline">\(Q\)</span> will produce the same price process, which then is given by</em>
<span class="math display">\[
  \Pi_t[X]=V_t^h,\tag{11.60}
  \]</span>
<em>where <span class="math inline">\(h\)</span> is the hedging portfolio. Different choices of hedging portfolios (if such exist) will produce the same price process.</em></li>
<li><em>In particular, for every replicable claim <span class="math inline">\(X\)</span> it holds that</em>
<span class="math display">\[
  V_t^Q=E^Q\left[\left. e^{-\int_t^T r(s)\ ds}X\ \right\vert\ \mathcal{F}_t\right].\tag{11.61}
  \]</span></li>
</ol>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="mathematics-of-the-martingale-approach" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Mathematics of the martingale approach<a href="continuous-time-finance.html#mathematics-of-the-martingale-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="martingale-representation-theorem" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Martingale representation theorem<a href="continuous-time-finance.html#martingale-representation-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="thm">
<p><strong>Theorem 12.1. (Bjork)</strong> <strong>(Representation of Brownian Functionals)</strong> <em>Let <span class="math inline">\(W\)</span> be a <span class="math inline">\(d\)</span> dimensional Brownian motions, and let <span class="math inline">\(X\)</span> be a random variable such that</em></p>
<ul>
<li><span class="math inline">\(X\in\mathcal{F}^W_T\)</span>,</li>
<li><span class="math inline">\(E[\vert X\vert]&lt;\infty\)</span>.</li>
</ul>
<p><em>Then there exist uniquely determined <span class="math inline">\(\mathcal{F}^W_t\)</span>-adapted processes <span class="math inline">\(h^1,...,h^d\)</span>, such that <span class="math inline">\(X\)</span> has the representation</em></p>
<p><span class="math display">\[
X=E[X]+\sum_{i=1}^d\int_0^Th^i_s\ dW_s^i.\tag{12.2}
\]</span></p>
<p><em>Under the additional assumption</em></p>
<p><span class="math display">\[
E[X^2]&lt;\infty,
\]</span></p>
<p><em>then <span class="math inline">\(h^1,...,h^d\)</span> are in <span class="math inline">\(\mathcal{L}^2\)</span>.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 12.2. (Bjork)</strong> <strong>(The Martingale Representation Theorem)</strong> <em>Let <span class="math inline">\(W\)</span> be a <span class="math inline">\(d\)</span> dimensional Brownian motions, and assume that the filtration <span class="math inline">\(\mathbf{F}\)</span> is defined as</em></p>
<p><span class="math display">\[
\mathcal{F}_t=\mathcal{F}^W_t,\hspace{20pt}t\in[0,T].
\]</span></p>
<p><em>Let <span class="math inline">\(M\)</span> be any <span class="math inline">\(\mathcal{F}_t\)</span>-adapted martingale. Then there exist uniquely determined <span class="math inline">\(\mathcal{F}_t\)</span>-adapted processes <span class="math inline">\(h^1,...,h^d\)</span> such that <span class="math inline">\(M\)</span> has the representation</em></p>
<p><span class="math display">\[
M_t=M_0+\sum_{i=1}^d\int_0^t h_s^i\ dW_s^i,\hspace{20pt}t\in[0,T].\tag{12.9}
\]</span></p>
<p><em>If the martingale <span class="math inline">\(M\)</span> is square integrable, then <span class="math inline">\(h^1,...,h^d\)</span> are in <span class="math inline">\(\mathcal{L}^2\)</span>.</em></p>
</blockquote>
</div>
<div id="girsanov-theorem" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Girsanov theorem<a href="continuous-time-finance.html#girsanov-theorem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote class="thm">
<p><strong>Theorem 12.3. (Bjork)</strong> <strong>(The Girsanov Theorem)</strong> <em>Let <span class="math inline">\(W\)</span> be a <span class="math inline">\(d\)</span> dimensional <span class="math inline">\(P\)</span>-Brownian motion on <span class="math inline">\((\Omega,\mathcal{F},P,\mathbf{F})\)</span> and let <span class="math inline">\(\varphi\)</span> be any <span class="math inline">\(d\)</span>-dimensional adapted column vector process. Choose a fixed <span class="math inline">\(T\)</span> and define the process <span class="math inline">\(L\)</span> on <span class="math inline">\([0,T]\)</span> by</em>
<span class="math display">\[\begin{align*}
dL_t&amp;=\varphi^\top_t L_t\ dW_t,\tag{12.16}\\
L_0&amp;=1,\tag{12.17}
\end{align*}\]</span>
<em>i.e.</em></p>
<p><span class="math display">\[
L_t = \exp\left\{\int_0^t \varphi^\top_s\ dW_s - \frac{1}{2}\int_0^t \Vert\varphi_s\Vert ^2\ ds\right\}.
\]</span></p>
<p><em>Assume that</em></p>
<p><span class="math display">\[
E^P[L_T]=1,\tag{12.18}
\]</span></p>
<p><em>and define the new probability measure <span class="math inline">\(Q\)</span> on <span class="math inline">\(\mathcal{F}_T\)</span> by</em></p>
<p><span class="math display">\[
L_T=\frac{dQ}{dP},\hspace{15pt}on\ \mathcal{F}_T.\tag{12.19}
\]</span></p>
<p><em>Then</em></p>
<p><span class="math display">\[
dW_t=\varphi\ dt+dW_t^Q,\tag{12.20}
\]</span></p>
<p><em>where <span class="math inline">\(W^Q\)</span> is a <span class="math inline">\(d\)</span> dimensional <span class="math inline">\(Q\)</span>-Brownian motion or equivalently</em></p>
<p><span class="math display">\[
W_t^Q=W_t-\int_0^t\varphi_s\ ds\tag{12.21}
\]</span></p>
<p><em>is a standard <span class="math inline">\(Q\)</span>-Brownian motion.</em></p>
</blockquote>
<p>We will often refere to <span class="math inline">\(\varphi\)</span> as the <strong>Girsanov kernel</strong> of the measure transformation. Furthermore, we have written on component form above and the <span class="math inline">\(L\)</span> dynamics will have the form</p>
<p><span class="math display">\[
dL_t=L_t\sum_{i=1}^d\varphi^i_t\ dW_t^i,
\]</span></p>
<p>and <span class="math inline">\(L\)</span> will have the explicit form</p>
<p><span class="math display">\[
L_t=\exp\left\{\sum_{i=1}^d\int_0^t\varphi^i_s\ dW_s^i - \frac{1}{2}\int_0^d\sum_{i=1}^d(\varphi^i_s)^2\ ds\right\}.
\]</span></p>
<p>The conclusion of the Girsanov Theorem is thwn that we can write</p>
<p><span class="math display">\[
dW_t^i=\varphi_t^i\ dt+dW_t^{Q,i},
\]</span></p>
<p>for <span class="math inline">\(i=1,...,d\)</span> where <span class="math inline">\(W_t^{Q,1},...,W_t^{Q,d}\)</span> are independent standard Brownian motions under <span class="math inline">\(Q\)</span>.</p>
<blockquote class="def">
<p><strong>Definition 12.4. (Bjork)</strong> <em>For any Brownian motion <span class="math inline">\(W\)</span> and any kernel process <span class="math inline">\(\varphi\)</span>, the <strong>Doleans exponential</strong> process <span class="math inline">\(\mathcal{E}\)</span> is defined by</em></p>
<p><span class="math display">\[
\mathcal{E}(\varphi\bullet W)_t=\exp\left\{\int_0^t\varphi^\top_s\ dW_s -\frac{1}{2}\int_0^t\Vert \varphi\Vert^2_s\ ds\right\}.\tag{12.24}
\]</span></p>
</blockquote>
<blockquote class="lem">
<p><strong>Lemma 12.5. (Bjork)</strong> <strong>(The Novikov Condition)</strong> <em>Assume that the Girsanov kernel <span class="math inline">\(\varphi\)</span> is such that</em></p>
<p><span class="math display">\[
E^P\left[e^{\frac{1}{2}\int_0^T\Vert \varphi_t\Vert^2\ dt}\right]&lt;\infty.\tag{12.27}
\]</span></p>
<p><em>Then <span class="math inline">\(L\)</span> is a martingale and in particular <span class="math inline">\(E^P[L_T]=1\)</span>.</em></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 12.6. (Bjork)</strong> <strong>(The Converse of the Girsanov Theorem)</strong> <em>Let <span class="math inline">\(W\)</span> be a <span class="math inline">\(d\)</span>-dimensional standard <span class="math inline">\(P\)</span>-Brownian motion on <span class="math inline">\((\Omega,\mathcal{F},P,\mathbf{F})\)</span> and assume that</em></p>
<p><span class="math display">\[
\mathcal{F}_t=\mathcal{F}^W_t,\ \forall t.
\]</span></p>
<em>Assume that there exists a probability measure <span class="math inline">\(Q\)</span> such that <span class="math inline">\(Q&lt;&lt;P\)</span> on <span class="math inline">\(\mathcal{F}_T\)</span>. Then there exists an adapted process <span class="math inline">\(\varphi\)</span> such that the likelihood process <span class="math inline">\(L\)</span> has the dynamics</em>
<span class="math display">\[\begin{align*}
dL_t&amp;=L_t\varphi^\top_t\ dW_t,\\
L_0&amp;=1.
\end{align*}\]</span>
</blockquote>
<p>This gives us a recipe to transform dynamics of Ito processes under the measure <span class="math inline">\(Q\)</span> as we may rewrite the dynamics of the Brownian motion. We therefore have for an Ito process <span class="math inline">\(X\)</span> with dynamics</p>
<p><span class="math display">\[
dX_t=\mu(t,X_t)X_t\ dt+\sigma(t,X_t) X_t\ dW_t,
\]</span></p>
<p>may be transformed under <span class="math inline">\(Q\)</span> as
<span class="math display">\[\begin{align*}
dX_t&amp;=\mu(t,X_t)X_t\ dt+\sigma(t,X_t) X_t\ dW_t\\
&amp;=\mu(t,X_t)X_t\ dt+\sigma(t,X_t) X_t\ (\varphi_t\ dt+dW_t^Q)\\
&amp;=\left(\mu(t,X_t) + \varphi_t\right) X_t\ dt + \sigma(t,X_t)X_t\ dW_t^Q.
\end{align*}\]</span>
This may lead us into deducing that</p>
<p><span class="math display">\[
\mu(t,X_t)+\sigma(t,X_t)\varphi_t=r_t\iff\varphi_t=\frac{r_t-\mu(t,X_t)}{\sigma(t,X_t)}.
\]</span></p>
<p>We furthermore have the Levy characterisation of a Brownian motion.</p>
<blockquote class="thm">
<p><strong>Theorem. (Remark FinKont)</strong> <strong>(Levy Characterisation of Brownian motion)</strong> <em>Let <span class="math inline">\(X_t\)</span> be an Ito process with <span class="math inline">\(X_0=0\)</span>. Then <span class="math inline">\(X_t\)</span> is a Brownian motion if and only if the two processes <span class="math inline">\(X_t\)</span> and <span class="math inline">\(X_t^2-t\)</span> are continuous martingales.</em></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="black-scholes-model---martingale-approach" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Black-Scholes model - martingale approach<a href="continuous-time-finance.html#black-scholes-model---martingale-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We consider the standard Black-Scholes model with a single risk free asset and risky asset with dynamics
<span class="math display">\[\begin{align*}
dS_t &amp;= \mu S_t\ dt+\sigma S_t\ dW_t,\tag{13.1}\\
dB_t &amp;= r B_t\ dt.\tag{13.2}
\end{align*}\]</span>
We want check whether the model is arbitrage free on any time interval <span class="math inline">\([0,T]\)</span>, and find a (perhaps unique) martingale measure such that we may apply the fundamental pricing theorem 1 and 2. From Girsanov this endavour is equivalent with searching for a (perhaps unique) Girsanov kernel <span class="math inline">\(\varphi\)</span>. We therefore define as usual the likelihood process</p>
<p><span class="math display">\[
dL_t=\varphi_ tL_t\ dW_t,
\]</span></p>
<p>and setting <span class="math inline">\(dQ=L_T\ dP\)</span> on <span class="math inline">\(\mathcal{F}_T\)</span>, we know from Girsanov theorem that</p>
<p><span class="math display">\[
dW_t=\varphi_t\ dt+dW_t^Q.
\]</span></p>
<p>Inserting into the Black-Scholes model we have</p>
<p><span class="math display">\[
dS_t=S_t(\mu + \sigma \varphi_t)\ dt+\sigma S_t\ dW_t^Q.
\]</span></p>
<p>We know that for <span class="math inline">\(Q\)</span> to be a martingale measure we know that the local rate of return under <span class="math inline">\(Q\)</span> of <span class="math inline">\(S\)</span> must be the short rate <span class="math inline">\(r\)</span> i.e. we have</p>
<p><span class="math display">\[
\mu + \sigma \varphi_t=r\iff \varphi_t=\frac{r-\mu}{\sigma}=-\frac{\mu -r}{\sigma},\tag{13.3}
\]</span></p>
<p>and so we see the Girsanov kernel is <strong>constant and deterministic</strong>. The process has the economic interpretation that the Girsanov kernel is the risk premium per unit volatility.</p>
<blockquote class="lem">
<p><strong>Lemma 13.1. (Bjork)</strong> <em>The Girsanov kernel <span class="math inline">\(\varphi\)</span> is given by</em></p>
<p><span class="math display">\[
\varphi = -\lambda
\]</span></p>
<p><em>where the market price of risk <span class="math inline">\(\lambda\)</span> is defined by</em></p>
<p><span class="math display">\[
\lambda =\frac{r-\mu}{\sigma}.
\]</span></p>
</blockquote>
<p>We therefore have determined <em>a martingale</em> and so we have the result.</p>
<blockquote class="thm">
<p><strong>Theorem 13.2. (Bjork)</strong> <em>The Black-Scholes model above is arbitrage free.</em></p>
</blockquote>
<p>We could in general have that <span class="math inline">\(\mu,\sigma,r\)</span> are adapted processes. If this is the case we would have to show the Nivokov condition.</p>
<p>Pricing then of any <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span> then is given by the risk neatral pricing formula</p>
<p><span class="math display">\[
\Pi_t[X]=e^{-r(T-t)}E^Q[X\ \vert\ \mathcal{F}_t],\tag{13.7}
\]</span></p>
<p>where the <span class="math inline">\(Q\)</span> dynamics of <span class="math inline">\(S\)</span> has local drift <span class="math inline">\(r\)</span> and volatility from the <span class="math inline">\(Q\)</span>-brownian motion <span class="math inline">\(W^Q\)</span>.</p>
<blockquote class="thm">
<p><strong>Theorem 13.3. (Bjork)</strong> <em>The Black-Scholes model above is complete. This also holds for the more general model where <span class="math inline">\(r,\mu,\sigma\)</span> are adapted processes.</em></p>
</blockquote>
<p>Hedging is the possible by considiering a <span class="math inline">\(T\)</span> claim with</p>
<p><span class="math display">\[
E^Q\left[\frac{X}{B_T}\right]&lt;\infty.
\]</span></p>
<p>Notice the numeraire <span class="math inline">\(B_t\)</span> as in the normalized <span class="math inline">\(Z\)</span>-economy. Consider now the <span class="math inline">\(Q\)</span>-martingale</p>
<p><span class="math display">\[
M_t=E^Q\left[\left. \frac{X}{B_T}\ \right\vert\ \mathcal{F}_t\right],\tag{13.9}
\]</span></p>
<p>and it now follows from lemma 11.15 the the model is complete if we can find a process <span class="math inline">\(h_t^1\)</span> such that</p>
<p><span class="math display">\[
dM_t=h_t^1\ dZ_t^i.\tag{13.10}
\]</span></p>
<p>In order to prove existance of such a process <span class="math inline">\(h^1\)</span> we use the Martingale Representation Theorem 12.2, which says that there <em>exists</em> a process <span class="math inline">\(g_t\)</span> such that</p>
<p><span class="math display">\[
dM_t=g_t\ dW_t^Q.\tag{13.11}
\]</span></p>
<p>We can now combine these two equation by the following <span class="math inline">\(Q\)</span> dynamics</p>
<p><span class="math display">\[
dZ_t^1=Z_t^1\sigma\ dW_t^Q.\tag{13.12}
\]</span></p>
<p>Hence we have</p>
<p><span class="math display">\[
dM_t=h_t^1Z_t^1\sigma\ dW_t^Q=g_t\ dW_t^Q\ \Rightarrow\ h_t^1=\frac{g_t}{Z_t^1\sigma}.
\]</span></p>
<blockquote class="thm">
<p><strong>Theorem 13.4. (Bjork)</strong> <em>In the Black-Scholes model every <span class="math inline">\(T\)</span>-claim <span class="math inline">\(X\)</span> satisfying</em></p>
<p><span class="math display">\[
E^Q\left[\frac{X}{B_T}\right]&lt;\infty
\]</span></p>
<p><em>can be replicated. The replicating portfolio is given by</em>
<span class="math display">\[\begin{align*}
h_t^1&amp;=\frac{g_t}{Z_t^1\sigma},\tag{13.13}\\
h_t^0&amp;=M_t-h_t^1Z_t^1,\tag{13.14}
\end{align*}\]</span>
<em>where <span class="math inline">\(M\)</span> is defined by the above and <span class="math inline">\(g\)</span> is defined by above.</em></p>
</blockquote>
<p>If the <span class="math inline">\(T\)</span>-claim is simple that is <span class="math inline">\(X=\Phi(S_T)\)</span> we may solve a boundary value problem with Feymann-Kac to arrive at the familiar result.</p>
<blockquote class="prop">
<p><strong>Proposition 13.5. (Bjork)</strong> <em>In the Black-Scholes model every <span class="math inline">\(T\)</span>-claim on the form <span class="math inline">\(X=\Phi(S_T)\)</span>. Then <span class="math inline">\(X\)</span> can be replicated by the portfolio</em>
<span class="math display">\[\begin{align*}
h_t^0&amp;=\frac{F(t,S_t)-S_t\frac{\partial F}{\partial s}(t,S_t)}{B_t},\tag{13.15}\\
h_t^1&amp;=\frac{\partial F}{\partial s}(t,S_t),\tag{13.15}
\end{align*}\]</span>
<em>where <span class="math inline">\(F\)</span> solves the <strong>Black-Scholes equation</strong></em>
<span class="math display">\[\begin{align*}
\frac{\partial F}{\partial t}(t,s)+rs\frac{\partial F}{\partial s}(t,s)+\frac{1}{2}\sigma^2s^2 \frac{\partial^2 F}{\partial s^2}(t,s)-rF(t,s)&amp;=0,\tag{13.16}\\
F(T,s)&amp;=\Phi(s).\tag{13.16}
\end{align*}\]</span>
<em>Furthermore the value process for the replicating portfolio is given by</em></p>
<p><span class="math display">\[
V_t=F(t,S_t).
\]</span></p>
</blockquote>
<div style="page-break-after: always;"></div>
</div>
<div id="multidimensional-models" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Multidimensional models<a href="continuous-time-finance.html#multidimensional-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We specify the general model by the assumptions below.</p>
<p><strong>Assumption 14.0.1</strong> <em>We assume the following:</em></p>
<ul>
<li><em>There are <span class="math inline">\(n\)</span> risky assets <span class="math inline">\(S^1,...,S^n\)</span>.</em></li>
<li><em>Under the objective probability measure <span class="math inline">\(P\)</span>, the <span class="math inline">\(S\)</span>-dynamics are given by</em>
<span class="math display">\[
  dS_t^i=\mu_t^iS_t^i\ dt +S_t^i\sum_{j=1}^N\sigma_t^{ij}\ dW_t^j,\tag{14.1}
  \]</span>
<em>for <span class="math inline">\(i=1,...,n\)</span>.</em></li>
<li><em>The coefficients processes <span class="math inline">\(\mu^i\)</span> and <span class="math inline">\(\sigma^{ij}\)</span> above are assumed to be adapted.</em></li>
<li><em>We have a standard risk free asset with price process <span class="math inline">\(B\)</span> with dynamics</em>
<span class="math display">\[
  dB_t=r_tB_t\ dt,\tag{14.2}
  \]</span>
<em>where the short rate process <span class="math inline">\(r\)</span> is assumed to be an adapted stochastic process.</em></li>
</ul>
<p>We can use the representation of <span class="math inline">\(\mu^i\)</span>, <span class="math inline">\(\sigma^{ij}\)</span> and <span class="math inline">\(S^i\)</span> as vectors and matrices on the form.</p>
<p><span class="math display">\[
\mu =
\begin{bmatrix}
\mu ^1\\
\vdots\\
\mu ^n
\end{bmatrix},\ \sigma=
\begin{bmatrix}
\sigma^{1,1}&amp; \cdots &amp; \sigma^{i,N}\\
\vdots &amp; \ddots &amp; \vdots\\
\sigma^{n,1}&amp;\cdots&amp;\sigma^{n,N}
\end{bmatrix},\ D(S)=
\begin{bmatrix}
S^{1}&amp; \cdots &amp; 0\\
\vdots &amp; \ddots &amp; \vdots\\
0&amp;\cdots&amp;S^n
\end{bmatrix}.
\]</span></p>
<p>And so we have the model on compact form.
<span class="math display">\[\begin{align*}
dS_t&amp;= D(S_t)\mu_t\ dt+D(S_t)\sigma_t\ dW_t,\tag{14.3}\\
dB_t&amp;=r_tB_t\ dt.\tag{14.4}
\end{align*}\]</span>
Now using Girsanov Theorem we can define the prospective likelihood process <span class="math inline">\(L\)</span> by
<span class="math display">\[\begin{align*}
dL_t&amp;=L_t\varphi_t^\top\ dW_t,\tag{14.5}\\
L_0&amp;=1,\tag{14.6}
\end{align*}\]</span>
where <span class="math inline">\(\varphi\)</span> is an adapted <span class="math inline">\(N\)</span>-dimensional process. Then our candidate martingale measure <span class="math inline">\(Q\)</span> is given by <span class="math inline">\(dQ=L_t\ dP\)</span> on <span class="math inline">\(\mathcal{F}_t\)</span> and the Girsanov theorem give the dynamics</p>
<p><span class="math display">\[
dW_t=\varphi_t\ dt+dW_t^Q,\tag{14.7}
\]</span></p>
<p>where <span class="math inline">\(W^Q\)</span> is a standard <span class="math inline">\(Q\)</span>-Brownian motion. Inserting into the <span class="math inline">\(P\)</span>-dynamics we obtain.</p>
<p><span class="math display">\[
dS_t=D(S_t)[\mu_t+\sigma_t\varphi_t]\ dt+D(S_t)\sigma_t\ dW_t^Q.\tag{14.8}
\]</span></p>
<p>The from (11.54) we know that <span class="math inline">\(Q\)</span> is a martingale measure if and only if the local rate of return (the <span class="math inline">\(dt\)</span>-term) is the short interest rate i.e. if and only if</p>
<p><span class="math display">\[
\mu_t+\sigma_t\varphi=\mathbf{r}_t,\tag{14.9}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{r}_t=[r,...,r]^\top\in\mathbb{R}^n\)</span>. We then have that</p>
<p><span class="math display">\[
\sigma_t\varphi_t = \mathbf{r}_t-\mu_t,\tag{14.11}
\]</span></p>
<p>where we want to solve for <span class="math inline">\(\varphi\)</span>. Thus we may write a condition for the absence of arbitrage in linear algebra terms.</p>
<blockquote class="prop">
<p><strong>Proposition 14.1. (Bjork)</strong> <em>A necessary condition for absence of arbitrage is that</em></p>
<p><span class="math display">\[
\mathbf{r}_t-\mu_t\in Im[\sigma_t]
\]</span></p>
<p><em>with probability one for each <span class="math inline">\(t\)</span>. A sufficient condition for absence of arbitrage is that there exists a process <span class="math inline">\(\varphi\)</span> which solves (14.11) and such that <span class="math inline">\(L\)</span> is a martingale.</em></p>
</blockquote>
<p>Note that it is not enought for <span class="math inline">\(\varphi\)</span> to solce (14.11). We also need that <span class="math inline">\(L\)</span> is a martingale.</p>
<blockquote class="def">
<p><strong>Definition 14.2. (Bjork)</strong> <em>A Girsanov kernel <span class="math inline">\(\varphi\)</span> is said to be <strong>admissible</strong> if it generates a martingale measure, i.e. it solves (14.11) and <span class="math inline">\(L\)</span> is a true martingale.</em></p>
</blockquote>
<blockquote class="def">
<p><strong>Definition 14.3. (Bjork)</strong> <em>The model above is said to be <strong>generically arbitrage free</strong> if it is arbitrage free for every choice of <span class="math inline">\(\mu\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 14.4. (Bjork)</strong> <em>Disregarding integrability problems the model is generically arbitrage free if and only if, for each <span class="math inline">\(t\le T\)</span> and <span class="math inline">\(P\)</span>-a.s., the mapping</em></p>
<p><span class="math display">\[
\sigma_t : \mathbb{R}^B\to \mathbb{R}^n
\]</span></p>
<p><em>is surjective, i.e. if and only if the volatility matrix <span class="math inline">\(\sigma_t\)</span> has rank <span class="math inline">\(n\)</span>.</em></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 14.5. (Bjork)</strong> <em>Assume that the model i generically arbitrage free and that the filtration <span class="math inline">\(\mathbf{F}\)</span> is defined by</em></p>
<p><span class="math display">\[
\mathcal{F}_t=\mathcal{F}^W_t.\tag{14.14}
\]</span></p>
<p><em>Then, disregarding integrability problems, the model is complete if and only if <span class="math inline">\(n=N\)</span> and the volatility matrix <span class="math inline">\(\sigma_t\)</span> is invertible <span class="math inline">\(P\)</span>-a.s. for each <span class="math inline">\(t\le T\)</span>.</em></p>
</blockquote>
<p><strong>Assumption 14.3.1. (Bjork)</strong> <em>We assume that the model is generically free of arbitrage, i.e. that</em></p>
<p><span class="math display">\[
Im[\sigma_t]=\mathbb{R}^n,\tag{14.16}
\]</span></p>
<p><em>for all <span class="math inline">\(t\)</span> and with probability one. We also assume that the model is purely Brownian driven, i.e. that <span class="math inline">\(\mathcal{F}_t=\mathcal{F}_t^W\)</span>.</em></p>
<blockquote class="prop">
<p><strong>Proposition 14.6. (Bjork)</strong> <em>Under assumption 14.3.1 the model is complete if and only if</em></p>
<p><span class="math display">\[
Im[\sigma_t^\top]=\mathbb{R}^N.\tag{14.23}
\]</span></p>
<p><em>If the model is complete then, using the notation of chapter 11, the replicating portfolio <span class="math inline">\([h^0,h^S]\)</span> is given by</em>
<span class="math display">\[\begin{align*}
h_t^S&amp;=g_t\sigma_t^{-1}D^{-1}(Z_t),\tag{14.24}\\
h_t^2&amp;=M_t-h_tZ_t.\tag{14.25}
\end{align*}\]</span>
<em>With <span class="math inline">\(M_t\)</span> defined by</em></p>
<p><span class="math display">\[
M_t=E^Q\left[\left. \frac{\mathcal{X}}{B_T}\ \right\vert\ \mathcal{F}_t \right].\tag{14.17}
\]</span></p>
</blockquote>
<blockquote class="thm">
<p><strong>Theorem 14.7. (Bjork)</strong> <strong>(The Second Fundamental Theorem)</strong> <em>Under assumptions 14.3.1 the model is complete if and only if the martingale measure is unique. This is equivalent with the statements: <span class="math inline">\(Ker[\sigma_t]=\{0\}\)</span>, <span class="math inline">\(Im[\sigma_t^\top]=\mathbb{R}^N\)</span> and <span class="math inline">\(\sigma_t^{-1}\)</span> exists (i.e. <span class="math inline">\(\sigma_t\)</span> is invertible).</em></p>
</blockquote>
<p>Pricing of any <span class="math inline">\(T\)</span>-claim <span class="math inline">\(\mathcal{X}\)</span> is now given by the risk neutral valuation formula</p>
<p><span class="math display">\[
\Pi_t[\mathcal{X}] = E^Q\left[\left. e^{-\int_t^Tr_u\ du}\mathcal{X} \ \right\vert\ \mathcal{F}_t\right],\tag{14.27}
\]</span></p>
<p>where <span class="math inline">\(Q\)</span> is some choice of martingale measure. Alternatively we can write the price as</p>
<p><span class="math display">\[
\Pi_t[\mathcal{X}] = E^Q\left[\left. \frac{\mathbf{M}_T}{\mathbf{M}_t}\mathcal{X} \ \right\vert\ \mathcal{F}_t\right],\tag{14.29}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{M}\)</span> is the stochastic discount factor, defined by</p>
<p><span class="math display">\[
\mathbf{M}_t=\frac{1}{B_t}L_t.
\]</span></p>
<p>If we have a simple claim i.e. of the form <span class="math inline">\(\mathcal{X}=\Phi(S_t)\)</span> and if <span class="math inline">\(S\)</span> is Markovian we have</p>
<p><span class="math display">\[
e^{-r(T-t)}E^Q[\Phi(S_t)\ \vert\ \mathcal{F}_t]=e^{-r(T-t)}E^Q[\Phi(S_t)\ \vert\ S_t],
\]</span></p>
<p>and then the pricing process must be of the form <span class="math inline">\(\Pi_t[\Phi]=F(t,S_t)\)</span>. We then have <span class="math inline">\(F\)</span> to be the solutions to the PDE
<span class="math display">\[\begin{align*}
F_t(t,s)+\sum_{i=1}^nrs_iF_i(t,s)+\frac{1}{2}\text{tr}\left\{\sigma^\top D(S)F_{ss}D(S)\sigma\right\}-rF(t,s)&amp;=0,\tag{14.31}\\
F(T,s)&amp;=\Phi(s),\tag{14.31}
\end{align*}\]</span>
where <span class="math inline">\(F_i=\frac{\partial F}{\partial s_i}\)</span> and <span class="math inline">\(F_{ss}\)</span> denotes the Hessian matrix. Furthermore, <span class="math inline">\(\text{tr}(A)\)</span> denotes the trace of <span class="math inline">\(A\)</span> i.e. the sum of the diagonal. We have that the hedging portfolio has value process <span class="math inline">\(V_t^h=F(t,S_t)\)</span> with dynamics</p>
<p><span class="math display">\[
dV_t^h=\sum_{i=1}^n F_i(t,S_t)\ dS_t^i.
\]</span></p>
Then we must gave the solution
<span class="math display">\[\begin{align*}
h_t^i&amp;=\frac{\partial F}{\partial s_i}(t,S_t),\hspace{10pt}i=1,...,n,\tag{14.32}\\
h_t^0&amp;=\frac{1}{B_t}\left\{F(t,S_t)-\sum_{i=1}^n \frac{\partial F}{\partial s_i}(t,S_t)\ S_t^i\right\}.\tag{14.33}
\end{align*}\]</span>
<blockquote class="prop">
<p><strong>Proposition 14.8. (Bjork)</strong> <em>With <span class="math inline">\(L\)</span>-dynamics as in <span class="math inline">\(dL_t=L_t\varphi^\top_t\ dW_t\)</span>, the <span class="math inline">\(\mathbf{M}\)</span>-dynamics are</em></p>
<p><span class="math display">\[
d\mathbf{M}_t=-r_t\mathbf{M}_t\ dt+\mathbf{M}_t\varphi_t^\top\ dW_t,\tag{14.39}
\]</span></p>
<p><em>or alternatively in terms of the market price of risk <span class="math inline">\(\lambda_t=-\varphi_t\)</span></em></p>
<p><span class="math display">\[
d\mathbf{M}_t=-r_t\mathbf{M}_t\ dt-\mathbf{M}_t\lambda_t^\top\ dW_t.\tag{14.40}
\]</span></p>
</blockquote>
<blockquote class="prop">
<p><strong>Proposition 14.9. (Bjork)</strong> <strong>(The Hansen-Jagannathan Bounds)</strong> <em>Assume generic absence of arbitrage. Then the following holds for all assets, underlying or derivative, and for all admissible Girsanov kernels <span class="math inline">\(\varphi\)</span>, and market prices of risk <span class="math inline">\(\lambda\)</span>.</em></p>
<p><span class="math display">\[
\frac{\vert \mu_t^p - r_t\vert}{\Vert \sigma_t ^p\Vert}\le \Vert \varphi_t\Vert,\hspace{15pt} \frac{\vert \mu_t^p - r_t\vert}{\Vert \sigma_t ^p\Vert}\le \Vert \lambda_t\Vert.\tag{14.42}
\]</span></p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="topics-in-life-insurance-mathematics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-non-life-insurance-mathematics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
