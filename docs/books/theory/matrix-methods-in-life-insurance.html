<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.5 Matrix methods in life insurance | Mathematics of the Actuarial Sciences</title>
  <meta name="description" content="This document contains lecture notes from the courses i attended during my education. The notes mostly contains results from the master courses but there are also included some results from the bachelor as these lay out some of the fundamentals of the mathematics used during the master courses. I want to stress that this is a work in progress and as such is subject to some small and some severy errors. The contents of these notes have not been supervised by anyone other than myself and so, although i an confident in most of the content, i would not take any of the below as clear facts. Always due your own research and derivations to confirm the results." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="4.5 Matrix methods in life insurance | Mathematics of the Actuarial Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This document contains lecture notes from the courses i attended during my education. The notes mostly contains results from the master courses but there are also included some results from the bachelor as these lay out some of the fundamentals of the mathematics used during the master courses. I want to stress that this is a work in progress and as such is subject to some small and some severy errors. The contents of these notes have not been supervised by anyone other than myself and so, although i an confident in most of the content, i would not take any of the below as clear facts. Always due your own research and derivations to confirm the results." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.5 Matrix methods in life insurance | Mathematics of the Actuarial Sciences" />
  
  <meta name="twitter:description" content="This document contains lecture notes from the courses i attended during my education. The notes mostly contains results from the master courses but there are also included some results from the bachelor as these lay out some of the fundamentals of the mathematics used during the master courses. I want to stress that this is a work in progress and as such is subject to some small and some severy errors. The contents of these notes have not been supervised by anyone other than myself and so, although i an confident in most of the content, i would not take any of the below as clear facts. Always due your own research and derivations to confirm the results." />
  

<meta name="author" content="Joakim Bilyk" />


<meta name="date" content="2023-04-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="survival-and-mortality-rates.html"/>
<link rel="next" href="financial-mathematics-in-life-insurance.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

<script>
    $(function() {
        var element = document.body;
        if (localStorage.chkbx && localStorage.chkbx != '') {
            $('#remember_me').attr('checked', 'checked');
            element.classList.toggle("dark-mode");
            document.querySelector('.book-header.fixed').click();
        } else {
            $('#remember_me').removeAttr('checked');
            document.querySelector('.book-header.fixed').click();
        }

        $('#remember_me').click(function() {

            if ($('#remember_me').is(':checked')) {
                // save username and password
                localStorage.chkbx = $('#remember_me').val();
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            } else {
                localStorage.chkbx = '';
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            }
        });
    });

</script>

<div class = "sticky-darkmode-toggle">
  <label class="switch">
  <input type="checkbox" value="remember-me" id="remember_me">
  <span class="slider round">
  </span>
  </label>
</div>

<script>
$(function() {
  $('body').after($('.sticky-darkmode-toggle'));
})
</script>

<style>

.sticky-darkmode-toggle {
  position: fixed;
  right: 20px;
  bottom: 20px;
}
</style>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Comlete theory</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="abbreviations.html"><a href="abbreviations.html"><i class="fa fa-check"></i>Abbreviations</a></li>
<li class="chapter" data-level="" data-path="to-do-reading.html"><a href="to-do-reading.html"><i class="fa fa-check"></i>To-do reading</a></li>
<li class="chapter" data-level="" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i>Notation</a></li>
</ul></li>
<li class="part"><span><b>I The Mathematics of Life Insurance and Financial Contracts</b></span></li>
<li class="chapter" data-level="1" data-path="basic-life-insurance-mathematics.html"><a href="basic-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>1</b> Basic Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="payments-interest-and-mortality.html"><a href="payments-interest-and-mortality.html"><i class="fa fa-check"></i><b>1.1</b> Payments, interest and mortality</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="payments-interest-and-mortality.html"><a href="payments-interest-and-mortality.html#payments"><i class="fa fa-check"></i><b>1.1.1</b> Payments</a></li>
<li class="chapter" data-level="1.1.2" data-path="payments-interest-and-mortality.html"><a href="payments-interest-and-mortality.html#interests"><i class="fa fa-check"></i><b>1.1.2</b> Interests</a></li>
<li class="chapter" data-level="1.1.3" data-path="payments-interest-and-mortality.html"><a href="payments-interest-and-mortality.html#valuation-of-paymentstreams"><i class="fa fa-check"></i><b>1.1.3</b> Valuation of paymentstreams</a></li>
<li class="chapter" data-level="1.1.4" data-path="payments-interest-and-mortality.html"><a href="payments-interest-and-mortality.html#mortality"><i class="fa fa-check"></i><b>1.1.4</b> Mortality</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="insurance-of-a-single-life.html"><a href="insurance-of-a-single-life.html"><i class="fa fa-check"></i><b>1.2</b> Insurance of a single life</a></li>
<li class="chapter" data-level="1.3" data-path="expenses.html"><a href="expenses.html"><i class="fa fa-check"></i><b>1.3</b> Expenses</a></li>
<li class="chapter" data-level="1.4" data-path="multi-life-insurances.html"><a href="multi-life-insurances.html"><i class="fa fa-check"></i><b>1.4</b> Multi-life insurances</a></li>
<li class="chapter" data-level="1.5" data-path="markov-chains-in-life-insurance.html"><a href="markov-chains-in-life-insurance.html"><i class="fa fa-check"></i><b>1.5</b> Markov chains in life insurance</a></li>
<li class="chapter" data-level="1.6" data-path="safety-loadings-and-bonus.html"><a href="safety-loadings-and-bonus.html"><i class="fa fa-check"></i><b>1.6</b> Safety loadings and bonus</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="stochastic-processes-in-life-insurance-mathematics.html"><a href="stochastic-processes-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>2</b> Stochastic Processes in Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lebesgue-stieltjes-calculus.html"><a href="lebesgue-stieltjes-calculus.html"><i class="fa fa-check"></i><b>2.1</b> Lebesgue-Stieltjes calculus</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="lebesgue-stieltjes-calculus.html"><a href="lebesgue-stieltjes-calculus.html#cadlag-functions"><i class="fa fa-check"></i><b>2.1.1</b> CADLAG functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="lebesgue-stieltjes-calculus.html"><a href="lebesgue-stieltjes-calculus.html#functions-of-finite-variation"><i class="fa fa-check"></i><b>2.1.2</b> Functions of finite variation</a></li>
<li class="chapter" data-level="2.1.3" data-path="lebesgue-stieltjes-calculus.html"><a href="lebesgue-stieltjes-calculus.html#lebesgue-stieltjes-integration"><i class="fa fa-check"></i><b>2.1.3</b> Lebesgue-Stieltjes integration</a></li>
<li class="chapter" data-level="2.1.4" data-path="lebesgue-stieltjes-calculus.html"><a href="lebesgue-stieltjes-calculus.html#change-of-variables-formula-ito-formula-for-fv-functions"><i class="fa fa-check"></i><b>2.1.4</b> Change of variables formula (Ito formula for FV-functions)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="stochastic-processes.html"><a href="stochastic-processes.html"><i class="fa fa-check"></i><b>2.2</b> Stochastic processes</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="stochastic-processes.html"><a href="stochastic-processes.html#general-theory-of-stochastic-processes"><i class="fa fa-check"></i><b>2.2.1</b> General theory of stochastic processes</a></li>
<li class="chapter" data-level="2.2.2" data-path="stochastic-processes.html"><a href="stochastic-processes.html#markov-processes"><i class="fa fa-check"></i><b>2.2.2</b> Markov processes</a></li>
<li class="chapter" data-level="2.2.3" data-path="stochastic-processes.html"><a href="stochastic-processes.html#finite-variation-processes"><i class="fa fa-check"></i><b>2.2.3</b> Finite variation processes</a></li>
<li class="chapter" data-level="2.2.4" data-path="stochastic-processes.html"><a href="stochastic-processes.html#finite-variation-martingales"><i class="fa fa-check"></i><b>2.2.4</b> Finite variation martingales</a></li>
<li class="chapter" data-level="2.2.5" data-path="stochastic-processes.html"><a href="stochastic-processes.html#integral-processes"><i class="fa fa-check"></i><b>2.2.5</b> Integral processes</a></li>
<li class="chapter" data-level="2.2.6" data-path="stochastic-processes.html"><a href="stochastic-processes.html#counting-processes-and-point-processes"><i class="fa fa-check"></i><b>2.2.6</b> Counting processes and point processes</a></li>
<li class="chapter" data-level="2.2.7" data-path="stochastic-processes.html"><a href="stochastic-processes.html#piecewise-constant-processes-on-finite-state-spaces"><i class="fa fa-check"></i><b>2.2.7</b> Piecewise constant processes on finite state spaces</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="life-insurance-models.html"><a href="life-insurance-models.html"><i class="fa fa-check"></i><b>2.3</b> Life insurance models</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="life-insurance-models.html"><a href="life-insurance-models.html#general-definition-of-reserves"><i class="fa fa-check"></i><b>2.3.1</b> General definition of reserves</a></li>
<li class="chapter" data-level="2.3.2" data-path="life-insurance-models.html"><a href="life-insurance-models.html#multi-state-policy-general-model"><i class="fa fa-check"></i><b>2.3.2</b> Multi-state policy, general model</a></li>
<li class="chapter" data-level="2.3.3" data-path="life-insurance-models.html"><a href="life-insurance-models.html#standard-multi-state-policy-markov-model"><i class="fa fa-check"></i><b>2.3.3</b> Standard multi-state policy, Markov model</a></li>
<li class="chapter" data-level="2.3.4" data-path="life-insurance-models.html"><a href="life-insurance-models.html#models-with-state-duration-semi-markov-model"><i class="fa fa-check"></i><b>2.3.4</b> Models with state duration, semi-Markov model</a></li>
<li class="chapter" data-level="2.3.5" data-path="life-insurance-models.html"><a href="life-insurance-models.html#surplus-and-dividends"><i class="fa fa-check"></i><b>2.3.5</b> Surplus and dividends</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html"><i class="fa fa-check"></i><b>2.4</b> Introduction to survival and event history analysis</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html#hazard-rate-force-of-mortality"><i class="fa fa-check"></i><b>2.4.1</b> Hazard rate (force of mortality)</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html#examples-of-basic-counting-processes-models"><i class="fa fa-check"></i><b>2.4.2</b> Examples of basic counting processes models</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html#multiplicative-intensity-model"><i class="fa fa-check"></i><b>2.4.3</b> Multiplicative intensity model</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html#nonparametric-models"><i class="fa fa-check"></i><b>2.4.4</b> Nonparametric models</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-survival-and-event-history-analysis.html"><a href="introduction-to-survival-and-event-history-analysis.html#parametric-models"><i class="fa fa-check"></i><b>2.4.5</b> Parametric models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html"><i class="fa fa-check"></i><b>3</b> Continuous Time Finance</a>
<ul>
<li class="chapter" data-level="3.1" data-path="discrete-time-models.html"><a href="discrete-time-models.html"><i class="fa fa-check"></i><b>3.1</b> Discrete time models</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="discrete-time-models.html"><a href="discrete-time-models.html#one-period-time-models"><i class="fa fa-check"></i><b>3.1.1</b> One-period time models</a></li>
<li class="chapter" data-level="3.1.2" data-path="discrete-time-models.html"><a href="discrete-time-models.html#multi-period-model"><i class="fa fa-check"></i><b>3.1.2</b> Multi-period model</a></li>
<li class="chapter" data-level="3.1.3" data-path="discrete-time-models.html"><a href="discrete-time-models.html#generelised-one-period-model"><i class="fa fa-check"></i><b>3.1.3</b> Generelised one-period model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html"><i class="fa fa-check"></i><b>3.2</b> Self-financing portfolios</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#discrete-time-sf-portfolio"><i class="fa fa-check"></i><b>3.2.1</b> Discrete time SF portfolio</a></li>
<li class="chapter" data-level="3.2.2" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#continuous-time-sf-portfolio"><i class="fa fa-check"></i><b>3.2.2</b> Continuous time SF portfolio</a></li>
<li class="chapter" data-level="3.2.3" data-path="self-financing-portfolios.html"><a href="self-financing-portfolios.html#portfolio-weights"><i class="fa fa-check"></i><b>3.2.3</b> Portfolio weights</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html"><i class="fa fa-check"></i><b>3.3</b> Black-Scholes PDE</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#contingent-claims-and-arbitrage"><i class="fa fa-check"></i><b>3.3.1</b> Contingent Claims and Arbitrage</a></li>
<li class="chapter" data-level="3.3.2" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#risk-neutral-valuation-1"><i class="fa fa-check"></i><b>3.3.2</b> Risk Neutral Valuation</a></li>
<li class="chapter" data-level="3.3.3" data-path="black-scholes-pde.html"><a href="black-scholes-pde.html#black-scholes-formula"><i class="fa fa-check"></i><b>3.3.3</b> Black-Scholes formula</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html"><i class="fa fa-check"></i><b>3.4</b> Completeness and Hedging</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#completeness-in-black-scholes"><i class="fa fa-check"></i><b>3.4.1</b> Completeness in Black-Scholes</a></li>
<li class="chapter" data-level="3.4.2" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#absence-of-arbitrage-1"><i class="fa fa-check"></i><b>3.4.2</b> Absence of Arbitrage</a></li>
<li class="chapter" data-level="3.4.3" data-path="completeness-and-hedging.html"><a href="completeness-and-hedging.html#incomplete-markets"><i class="fa fa-check"></i><b>3.4.3</b> Incomplete Markets</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="parity-relations.html"><a href="parity-relations.html"><i class="fa fa-check"></i><b>3.5</b> Parity relations</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="parity-relations.html"><a href="parity-relations.html#put-call-parity"><i class="fa fa-check"></i><b>3.5.1</b> Put-call Parity</a></li>
<li class="chapter" data-level="3.5.2" data-path="parity-relations.html"><a href="parity-relations.html#the-greeks"><i class="fa fa-check"></i><b>3.5.2</b> The Greeks</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html"><i class="fa fa-check"></i><b>3.6</b> Fundamental pricing theorem I and II</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#completeness-1"><i class="fa fa-check"></i><b>3.6.1</b> Completeness</a></li>
<li class="chapter" data-level="3.6.2" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#risk-neutral-valuation-formula"><i class="fa fa-check"></i><b>3.6.2</b> Risk Neutral Valuation Formula</a></li>
<li class="chapter" data-level="3.6.3" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#stochastic-discount-factors-1"><i class="fa fa-check"></i><b>3.6.3</b> Stochastic Discount Factors</a></li>
<li class="chapter" data-level="3.6.4" data-path="fundamental-pricing-theorem-i-and-ii.html"><a href="fundamental-pricing-theorem-i-and-ii.html#summary"><i class="fa fa-check"></i><b>3.6.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html"><i class="fa fa-check"></i><b>3.7</b> Mathematics of the martingale approach</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html#martingale-representation-theorem"><i class="fa fa-check"></i><b>3.7.1</b> Martingale representation theorem</a></li>
<li class="chapter" data-level="3.7.2" data-path="mathematics-of-the-martingale-approach.html"><a href="mathematics-of-the-martingale-approach.html#girsanov-theorem"><i class="fa fa-check"></i><b>3.7.2</b> Girsanov theorem</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="black-scholes-model---martingale-approach.html"><a href="black-scholes-model---martingale-approach.html"><i class="fa fa-check"></i><b>3.8</b> Black-Scholes model - martingale approach</a></li>
<li class="chapter" data-level="3.9" data-path="multidimensional-models.html"><a href="multidimensional-models.html"><i class="fa fa-check"></i><b>3.9</b> Multidimensional models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>4</b> Topics in Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="markov-jump-processes.html"><a href="markov-jump-processes.html"><i class="fa fa-check"></i><b>4.1</b> Markov Jump Processes</a></li>
<li class="chapter" data-level="4.2" data-path="phase-type-distributions.html"><a href="phase-type-distributions.html"><i class="fa fa-check"></i><b>4.2</b> Phase-type distributions</a></li>
<li class="chapter" data-level="4.3" data-path="interest-rates.html"><a href="interest-rates.html"><i class="fa fa-check"></i><b>4.3</b> Interest rates</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="interest-rates.html"><a href="interest-rates.html#basic-definitions-and-properties"><i class="fa fa-check"></i><b>4.3.1</b> Basic definitions and properties</a></li>
<li class="chapter" data-level="4.3.2" data-path="interest-rates.html"><a href="interest-rates.html#phase-type-representation-of-bond-prices"><i class="fa fa-check"></i><b>4.3.2</b> Phase-type representation of bond prices</a></li>
<li class="chapter" data-level="4.3.3" data-path="interest-rates.html"><a href="interest-rates.html#term-structure-models"><i class="fa fa-check"></i><b>4.3.3</b> Term structure models</a></li>
<li class="chapter" data-level="4.3.4" data-path="interest-rates.html"><a href="interest-rates.html#estimation-of-ph-bond-models"><i class="fa fa-check"></i><b>4.3.4</b> Estimation of PH bond models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html"><i class="fa fa-check"></i><b>4.4</b> Survival and mortality rates</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#survival-probabilities-and-forward-mortality-rates"><i class="fa fa-check"></i><b>4.4.1</b> Survival probabilities and forward mortality rates</a></li>
<li class="chapter" data-level="4.4.2" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#forward-transistion-rates"><i class="fa fa-check"></i><b>4.4.2</b> Forward transistion rates</a></li>
<li class="chapter" data-level="4.4.3" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#reserves-revisited"><i class="fa fa-check"></i><b>4.4.3</b> Reserves revisited</a></li>
<li class="chapter" data-level="4.4.4" data-path="survival-and-mortality-rates.html"><a href="survival-and-mortality-rates.html#stochastic-mortality-rates"><i class="fa fa-check"></i><b>4.4.4</b> Stochastic mortality rates</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html"><i class="fa fa-check"></i><b>4.5</b> Matrix methods in life insurance</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#basic-setup"><i class="fa fa-check"></i><b>4.5.1</b> Basic setup</a></li>
<li class="chapter" data-level="4.5.2" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#interest-rate-free-analysis"><i class="fa fa-check"></i><b>4.5.2</b> Interest rate free analysis</a></li>
<li class="chapter" data-level="4.5.3" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#transform-of-rewards-and-higher-order-moments"><i class="fa fa-check"></i><b>4.5.3</b> Transform of rewards and higher order moments</a></li>
<li class="chapter" data-level="4.5.4" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#markovian-interest-rates"><i class="fa fa-check"></i><b>4.5.4</b> Markovian interest rates</a></li>
<li class="chapter" data-level="4.5.5" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#reserves"><i class="fa fa-check"></i><b>4.5.5</b> Reserves</a></li>
<li class="chapter" data-level="4.5.6" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#higher-order-moments"><i class="fa fa-check"></i><b>4.5.6</b> Higher order moments</a></li>
<li class="chapter" data-level="4.5.7" data-path="matrix-methods-in-life-insurance.html"><a href="matrix-methods-in-life-insurance.html#equivalence-premium"><i class="fa fa-check"></i><b>4.5.7</b> Equivalence premium</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html"><i class="fa fa-check"></i><b>4.6</b> Financial Mathematics in Life Insurance</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#background-and-simple-claims"><i class="fa fa-check"></i><b>4.6.1</b> Background and Simple Claims</a></li>
<li class="chapter" data-level="4.6.2" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#payment-streams"><i class="fa fa-check"></i><b>4.6.2</b> Payment Streams</a></li>
<li class="chapter" data-level="4.6.3" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#unit-link-insurance"><i class="fa fa-check"></i><b>4.6.3</b> Unit-Link Insurance</a></li>
<li class="chapter" data-level="4.6.4" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#with-profit-insurance-and-the-dynamics-of-the-surplus"><i class="fa fa-check"></i><b>4.6.4</b> With-Profit Insurance and the Dynamics of the Surplus</a></li>
<li class="chapter" data-level="4.6.5" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#cash-dividends-and-market-reserve"><i class="fa fa-check"></i><b>4.6.5</b> Cash Dividends and Market Reserve</a></li>
<li class="chapter" data-level="4.6.6" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#the-pure-case-of-cash-dividends"><i class="fa fa-check"></i><b>4.6.6</b> The Pure Case of Cash Dividends</a></li>
<li class="chapter" data-level="4.6.7" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#bonus-payments-and-market-reserve"><i class="fa fa-check"></i><b>4.6.7</b> Bonus Payments and Market Reserve</a></li>
<li class="chapter" data-level="4.6.8" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#the-pure-case-of-bonus-payments"><i class="fa fa-check"></i><b>4.6.8</b> The Pure Case of Bonus Payments</a></li>
<li class="chapter" data-level="4.6.9" data-path="financial-mathematics-in-life-insurance.html"><a href="financial-mathematics-in-life-insurance.html#incidental-policy-holder-behavior"><i class="fa fa-check"></i><b>4.6.9</b> Incidental Policy Holder Behavior</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="projects-in-the-mathematics-of-life-insurance.html"><a href="projects-in-the-mathematics-of-life-insurance.html"><i class="fa fa-check"></i><b>5</b> Projects in the Mathematics of Life Insurance</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cash-flows-markov-models-and-policyholder-behavior.html"><a href="cash-flows-markov-models-and-policyholder-behavior.html"><i class="fa fa-check"></i><b>5.1</b> Cash flows, Markov models, and policyholder behavior</a></li>
<li class="chapter" data-level="5.2" data-path="transaction-time-modeling.html"><a href="transaction-time-modeling.html"><i class="fa fa-check"></i><b>5.2</b> Transaction time modeling</a></li>
<li class="chapter" data-level="5.3" data-path="parametric-estimation-in-markov-models.html"><a href="parametric-estimation-in-markov-models.html"><i class="fa fa-check"></i><b>5.3</b> Parametric estimation in Markov models</a></li>
<li class="chapter" data-level="5.4" data-path="non-parametric-estimation-in-markov-models.html"><a href="non-parametric-estimation-in-markov-models.html"><i class="fa fa-check"></i><b>5.4</b> Non-parametric estimation in Markov models</a></li>
<li class="chapter" data-level="5.5" data-path="non-markov-modeling.html"><a href="non-markov-modeling.html"><i class="fa fa-check"></i><b>5.5</b> Non-Markov modeling</a></li>
<li class="chapter" data-level="5.6" data-path="outlook.html"><a href="outlook.html"><i class="fa fa-check"></i><b>5.6</b> Outlook</a></li>
</ul></li>
<li class="part"><span><b>II The Mathematics and Methods of Non-Life Insurance</b></span></li>
<li class="chapter" data-level="6" data-path="basic-non-life-insurance-mathematics.html"><a href="basic-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>6</b> Basic Non-Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-basic-model.html"><a href="the-basic-model.html"><i class="fa fa-check"></i><b>6.1</b> The Basic Model</a></li>
<li class="chapter" data-level="6.2" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html"><i class="fa fa-check"></i><b>6.2</b> Models for the Claim Number Process</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-poisson-process"><i class="fa fa-check"></i><b>6.2.1</b> The Poisson Process</a></li>
<li class="chapter" data-level="6.2.2" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-homogeneous-poisson-process-the-intensity-function-the-cramér-lundberg-model"><i class="fa fa-check"></i><b>6.2.2</b> The Homogeneous Poisson Process, the Intensity Function, the Cramér-Lundberg Model</a></li>
<li class="chapter" data-level="6.2.3" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-markov-property"><i class="fa fa-check"></i><b>6.2.3</b> The Markov Property</a></li>
<li class="chapter" data-level="6.2.4" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#relations-between-the-homogeneous-and-the-inhomogeneous-poisson-process"><i class="fa fa-check"></i><b>6.2.4</b> Relations Between the Homogeneous and the Inhomogeneous Poisson Process</a></li>
<li class="chapter" data-level="6.2.5" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-homogeneous-poisson-process-as-a-renewal-process"><i class="fa fa-check"></i><b>6.2.5</b> The Homogeneous Poisson Process as a Renewal Process</a></li>
<li class="chapter" data-level="6.2.6" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-distribution-of-the-inter-arrival-times"><i class="fa fa-check"></i><b>6.2.6</b> The Distribution of the Inter-Arrival Times</a></li>
<li class="chapter" data-level="6.2.7" data-path="models-for-the-claim-number-process.html"><a href="models-for-the-claim-number-process.html#the-order-statistics-property"><i class="fa fa-check"></i><b>6.2.7</b> The Order Statistics Property</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-total-claim-amount.html"><a href="the-total-claim-amount.html"><i class="fa fa-check"></i><b>6.3</b> The Total Claim Amount</a></li>
<li class="chapter" data-level="6.4" data-path="ruin-theory.html"><a href="ruin-theory.html"><i class="fa fa-check"></i><b>6.4</b> Ruin Theory</a></li>
<li class="chapter" data-level="6.5" data-path="bayes-estimation.html"><a href="bayes-estimation.html"><i class="fa fa-check"></i><b>6.5</b> Bayes Estimation</a></li>
<li class="chapter" data-level="6.6" data-path="linear-bayes-estimation.html"><a href="linear-bayes-estimation.html"><i class="fa fa-check"></i><b>6.6</b> Linear Bayes Estimation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stochastic-processes-in-non-life-insurance-mathematics.html"><a href="stochastic-processes-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>7</b> Stochastic Processes in Non-Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>7.1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="preliminaries.html"><a href="preliminaries.html#poisson-process"><i class="fa fa-check"></i><b>7.1.1</b> Poisson process</a></li>
<li class="chapter" data-level="7.1.2" data-path="preliminaries.html"><a href="preliminaries.html#renewal-processes"><i class="fa fa-check"></i><b>7.1.2</b> Renewal processes</a></li>
<li class="chapter" data-level="7.1.3" data-path="preliminaries.html"><a href="preliminaries.html#wiener-hopf-factorisation"><i class="fa fa-check"></i><b>7.1.3</b> Wiener-Hopf factorisation</a></li>
<li class="chapter" data-level="7.1.4" data-path="preliminaries.html"><a href="preliminaries.html#subexponential-distributions"><i class="fa fa-check"></i><b>7.1.4</b> Subexponential distributions</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html"><i class="fa fa-check"></i><b>7.2</b> The Cramer-Lundberg model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#definition-of-the-cramer-lundberg-process"><i class="fa fa-check"></i><b>7.2.1</b> Definition of the Cramer-Lundberg process</a></li>
<li class="chapter" data-level="7.2.2" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#a-differential-equation-for-the-ruin-probability"><i class="fa fa-check"></i><b>7.2.2</b> A differential equation for the ruin probability</a></li>
<li class="chapter" data-level="7.2.3" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#the-adjustment-coefficient"><i class="fa fa-check"></i><b>7.2.3</b> The adjustment coefficient</a></li>
<li class="chapter" data-level="7.2.4" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#lundbergs-inequality"><i class="fa fa-check"></i><b>7.2.4</b> Lundberg’s inequality</a></li>
<li class="chapter" data-level="7.2.5" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#the-cramer-lundberg-approximation"><i class="fa fa-check"></i><b>7.2.5</b> The Cramer-Lundberg approximation</a></li>
<li class="chapter" data-level="7.2.6" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#reinsurance-and-ruin"><i class="fa fa-check"></i><b>7.2.6</b> Reinsurance and ruin</a></li>
<li class="chapter" data-level="7.2.7" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#the-severity-of-ruin-and-the-distribution-of-infc_t-t-ge-0"><i class="fa fa-check"></i><b>7.2.7</b> The severity of ruin and the distribution of <span class="math inline">\(\inf\{C_t : t \ge 0\}\)</span></a></li>
<li class="chapter" data-level="7.2.8" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#the-laplace-transform-of-psi"><i class="fa fa-check"></i><b>7.2.8</b> The Laplace transform of <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="7.2.9" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#approximations-to-psi"><i class="fa fa-check"></i><b>7.2.9</b> Approximations to <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="7.2.10" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#subexponential-claim-size-distributions"><i class="fa fa-check"></i><b>7.2.10</b> Subexponential claim size distributions</a></li>
<li class="chapter" data-level="7.2.11" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#the-time-of-ruin"><i class="fa fa-check"></i><b>7.2.11</b> The time of ruin</a></li>
<li class="chapter" data-level="7.2.12" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#seals-formulae"><i class="fa fa-check"></i><b>7.2.12</b> Seal’s formulae</a></li>
<li class="chapter" data-level="7.2.13" data-path="the-cramer-lundberg-model.html"><a href="the-cramer-lundberg-model.html#finite-time-lundberg-inequalities"><i class="fa fa-check"></i><b>7.2.13</b> Finite time Lundberg inequalities</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html"><i class="fa fa-check"></i><b>7.3</b> The renewal risk model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#definition-of-the-renewal-risk-model"><i class="fa fa-check"></i><b>7.3.1</b> Definition of the renewal risk model</a></li>
<li class="chapter" data-level="7.3.2" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#the-adjustment-coefficient-1"><i class="fa fa-check"></i><b>7.3.2</b> The adjustment coefficient</a></li>
<li class="chapter" data-level="7.3.3" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#lundbergs-inequality-1"><i class="fa fa-check"></i><b>7.3.3</b> Lundberg’s inequality</a></li>
<li class="chapter" data-level="7.3.4" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#the-cramer-lundberg-approximation-1"><i class="fa fa-check"></i><b>7.3.4</b> The Cramer-Lundberg approximation</a></li>
<li class="chapter" data-level="7.3.5" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#diffusion-approximations-1"><i class="fa fa-check"></i><b>7.3.5</b> Diffusion approximations</a></li>
<li class="chapter" data-level="7.3.6" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#subexponential-claim-size-distributions-1"><i class="fa fa-check"></i><b>7.3.6</b> Subexponential claim size distributions</a></li>
<li class="chapter" data-level="7.3.7" data-path="the-renewal-risk-model.html"><a href="the-renewal-risk-model.html#finite-time-lundberg-inequalities-1"><i class="fa fa-check"></i><b>7.3.7</b> Finite time Lundberg inequalities</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="modern-ruin-theory.html"><a href="modern-ruin-theory.html"><i class="fa fa-check"></i><b>7.4</b> Modern ruin theory</a></li>
<li class="chapter" data-level="7.5" data-path="claims-reserving.html"><a href="claims-reserving.html"><i class="fa fa-check"></i><b>7.5</b> Claims reserving</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="topics-in-non-life-insurance-mathematics.html"><a href="topics-in-non-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>8</b> Topics in Non-Life Insurance Mathematics</a></li>
<li class="chapter" data-level="9" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html"><i class="fa fa-check"></i><b>9</b> Probabilistic Machine Learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>9.1</b> Supervised Learning</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="supervised-learning.html"><a href="supervised-learning.html#what-is-a-good-estimator"><i class="fa fa-check"></i><b>9.1.1</b> What is a good estimator?</a></li>
<li class="chapter" data-level="9.1.2" data-path="supervised-learning.html"><a href="supervised-learning.html#excess-risk"><i class="fa fa-check"></i><b>9.1.2</b> Excess risk</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="training-validating-and-testing.html"><a href="training-validating-and-testing.html"><i class="fa fa-check"></i><b>9.2</b> Training, Validating and Testing</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="training-validating-and-testing.html"><a href="training-validating-and-testing.html#estimating-risk"><i class="fa fa-check"></i><b>9.2.1</b> Estimating risk</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>9.3</b> Linear Models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="linear-models.html"><a href="linear-models.html#least-squares-estimator"><i class="fa fa-check"></i><b>9.3.1</b> Least Squares Estimator</a></li>
<li class="chapter" data-level="9.3.2" data-path="linear-models.html"><a href="linear-models.html#ridge-regression"><i class="fa fa-check"></i><b>9.3.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="9.3.3" data-path="linear-models.html"><a href="linear-models.html#lasso-regression"><i class="fa fa-check"></i><b>9.3.3</b> Lasso Regression</a></li>
<li class="chapter" data-level="9.3.4" data-path="linear-models.html"><a href="linear-models.html#conclusion"><i class="fa fa-check"></i><b>9.3.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html"><i class="fa fa-check"></i><b>9.4</b> Nonparametric Regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#linear-smoothers"><i class="fa fa-check"></i><b>9.4.1</b> Linear Smoothers</a></li>
<li class="chapter" data-level="9.4.2" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#curse-of-dimensionality"><i class="fa fa-check"></i><b>9.4.2</b> Curse of dimensionality</a></li>
<li class="chapter" data-level="9.4.3" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#splines"><i class="fa fa-check"></i><b>9.4.3</b> Splines</a></li>
<li class="chapter" data-level="9.4.4" data-path="nonparametric-regression.html"><a href="nonparametric-regression.html#linear-regression-with-splines."><i class="fa fa-check"></i><b>9.4.4</b> Linear regression with splines.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="trees-and-forests.html"><a href="trees-and-forests.html"><i class="fa fa-check"></i><b>9.5</b> Trees and forests</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="trees-and-forests.html"><a href="trees-and-forests.html#cart"><i class="fa fa-check"></i><b>9.5.1</b> CART</a></li>
<li class="chapter" data-level="9.5.2" data-path="trees-and-forests.html"><a href="trees-and-forests.html#pruning"><i class="fa fa-check"></i><b>9.5.2</b> Pruning</a></li>
<li class="chapter" data-level="9.5.3" data-path="trees-and-forests.html"><a href="trees-and-forests.html#bagging"><i class="fa fa-check"></i><b>9.5.3</b> Bagging</a></li>
<li class="chapter" data-level="9.5.4" data-path="trees-and-forests.html"><a href="trees-and-forests.html#random-forests"><i class="fa fa-check"></i><b>9.5.4</b> Random Forests</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="boosting-and-additive-trees.html"><a href="boosting-and-additive-trees.html"><i class="fa fa-check"></i><b>9.6</b> Boosting and additive trees</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="boosting-and-additive-trees.html"><a href="boosting-and-additive-trees.html#gradient-boosting-machines"><i class="fa fa-check"></i><b>9.6.1</b> Gradient Boosting Machines</a></li>
<li class="chapter" data-level="9.6.2" data-path="boosting-and-additive-trees.html"><a href="boosting-and-additive-trees.html#bayesian-additive-regression-trees"><i class="fa fa-check"></i><b>9.6.2</b> Bayesian additive regression trees</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="some-practical-considerations.html"><a href="some-practical-considerations.html"><i class="fa fa-check"></i><b>9.7</b> Some practical considerations</a></li>
<li class="chapter" data-level="9.8" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>9.8</b> Neural Networks</a></li>
<li class="chapter" data-level="9.9" data-path="local-explanations.html"><a href="local-explanations.html"><i class="fa fa-check"></i><b>9.9</b> Local explanations</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="local-explanations.html"><a href="local-explanations.html#interpretability"><i class="fa fa-check"></i><b>9.9.1</b> Interpretability</a></li>
</ul></li>
<li class="chapter" data-level="9.10" data-path="causality.html"><a href="causality.html"><i class="fa fa-check"></i><b>9.10</b> Causality</a></li>
<li class="chapter" data-level="9.11" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html"><i class="fa fa-check"></i><b>9.11</b> Local and Global Explanations</a>
<ul>
<li class="chapter" data-level="9.11.1" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#interpretability-1"><i class="fa fa-check"></i><b>9.11.1</b> Interpretability</a></li>
<li class="chapter" data-level="9.11.2" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#partial-dependence-plots"><i class="fa fa-check"></i><b>9.11.2</b> Partial dependence plots</a></li>
<li class="chapter" data-level="9.11.3" data-path="local-and-global-explanations.html"><a href="local-and-global-explanations.html#a-functional-decomposition"><i class="fa fa-check"></i><b>9.11.3</b> A functional decomposition</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html"><i class="fa fa-check"></i><b>10</b> Quantative Risk Management</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-loss-variable.html"><a href="the-loss-variable.html"><i class="fa fa-check"></i><b>10.1</b> The Loss Variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="the-loss-variable.html"><a href="the-loss-variable.html#risk-measures"><i class="fa fa-check"></i><b>10.1.1</b> Risk measures</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="extreme-value-theory.html"><a href="extreme-value-theory.html"><i class="fa fa-check"></i><b>10.2</b> Extreme value theory</a></li>
<li class="chapter" data-level="10.3" data-path="elliptical-distributions-and-copulas.html"><a href="elliptical-distributions-and-copulas.html"><i class="fa fa-check"></i><b>10.3</b> Elliptical distributions and copulas</a></li>
<li class="chapter" data-level="10.4" data-path="credit-risk-modelling.html"><a href="credit-risk-modelling.html"><i class="fa fa-check"></i><b>10.4</b> Credit risk modelling</a></li>
<li class="chapter" data-level="10.5" data-path="models-for-operational-risk.html"><a href="models-for-operational-risk.html"><i class="fa fa-check"></i><b>10.5</b> Models for operational risk</a></li>
</ul></li>
<li class="part"><span><b>III Mathematical Prerequisites</b></span></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="measure-theory.html"><a href="measure-theory.html"><i class="fa fa-check"></i><b>A</b> Measure theory</a>
<ul>
<li class="chapter" data-level="A.1" data-path="axioms-of-probability.html"><a href="axioms-of-probability.html"><i class="fa fa-check"></i><b>A.1</b> Axioms of Probability</a></li>
<li class="chapter" data-level="A.2" data-path="conditional-probability-and-independence.html"><a href="conditional-probability-and-independence.html"><i class="fa fa-check"></i><b>A.2</b> Conditional Probability and Independence</a></li>
<li class="chapter" data-level="A.3" data-path="probabilities-on-a-finite-or-countable-space.html"><a href="probabilities-on-a-finite-or-countable-space.html"><i class="fa fa-check"></i><b>A.3</b> Probabilities on a Finite or Countable Space</a></li>
<li class="chapter" data-level="A.4" data-path="construction-of-a-probability-measure-on-mathbb-r.html"><a href="construction-of-a-probability-measure-on-mathbb-r.html"><i class="fa fa-check"></i><b>A.4</b> Construction of a Probability Measure on <span class="math inline">\(\mathbb R\)</span></a></li>
<li class="chapter" data-level="A.5" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>A.5</b> Random Variables</a></li>
<li class="chapter" data-level="A.6" data-path="integration-with-respect-to-a-probability-measure.html"><a href="integration-with-respect-to-a-probability-measure.html"><i class="fa fa-check"></i><b>A.6</b> Integration with Respect to a Probability Measure</a></li>
<li class="chapter" data-level="A.7" data-path="independent-random-variables.html"><a href="independent-random-variables.html"><i class="fa fa-check"></i><b>A.7</b> Independent Random Variables</a></li>
<li class="chapter" data-level="A.8" data-path="probability-distributions-on-mathbb-r.html"><a href="probability-distributions-on-mathbb-r.html"><i class="fa fa-check"></i><b>A.8</b> Probability Distributions on <span class="math inline">\(\mathbb R\)</span></a></li>
<li class="chapter" data-level="A.9" data-path="probability-distributions-on-mathbb-rn.html"><a href="probability-distributions-on-mathbb-rn.html"><i class="fa fa-check"></i><b>A.9</b> Probability Distributions on <span class="math inline">\(\mathbb R^n\)</span></a></li>
<li class="chapter" data-level="A.10" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html"><i class="fa fa-check"></i><b>A.10</b> Equivalent Probability Measures</a>
<ul>
<li class="chapter" data-level="A.10.1" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#the-radon-nikodym-theorem"><i class="fa fa-check"></i><b>A.10.1</b> The Radon-Nikodym Theorem</a></li>
<li class="chapter" data-level="A.10.2" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#equivalent-probability-measures-1"><i class="fa fa-check"></i><b>A.10.2</b> Equivalent Probability Measures</a></li>
<li class="chapter" data-level="A.10.3" data-path="equivalent-probability-measures.html"><a href="equivalent-probability-measures.html#likelihood-processes"><i class="fa fa-check"></i><b>A.10.3</b> Likelihood processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="random-variables-1.html"><a href="random-variables-1.html"><i class="fa fa-check"></i><b>B</b> Random Variables</a>
<ul>
<li class="chapter" data-level="B.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>B.1</b> Introduction</a></li>
<li class="chapter" data-level="B.2" data-path="conditional-expectation.html"><a href="conditional-expectation.html"><i class="fa fa-check"></i><b>B.2</b> Conditional expectation</a></li>
<li class="chapter" data-level="B.3" data-path="independence.html"><a href="independence.html"><i class="fa fa-check"></i><b>B.3</b> Independence</a></li>
<li class="chapter" data-level="B.4" data-path="moment-generating-function.html"><a href="moment-generating-function.html"><i class="fa fa-check"></i><b>B.4</b> Moment generating function</a></li>
<li class="chapter" data-level="B.5" data-path="standard-distributions.html"><a href="standard-distributions.html"><i class="fa fa-check"></i><b>B.5</b> Standard distributions</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="standard-distributions.html"><a href="standard-distributions.html#normal-disribution"><i class="fa fa-check"></i><b>B.5.1</b> Normal disribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="discrete-time-stochastic-processes.html"><a href="discrete-time-stochastic-processes.html"><i class="fa fa-check"></i><b>C</b> Discrete Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="C.1" data-path="convergence-concepts.html"><a href="convergence-concepts.html"><i class="fa fa-check"></i><b>C.1</b> Convergence concepts</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="convergence-concepts.html"><a href="convergence-concepts.html#sums-and-average-processes"><i class="fa fa-check"></i><b>C.1.1</b> Sums and average processes</a></li>
<li class="chapter" data-level="C.1.2" data-path="convergence-concepts.html"><a href="convergence-concepts.html#ergodic-theory"><i class="fa fa-check"></i><b>C.1.2</b> Ergodic Theory</a></li>
<li class="chapter" data-level="C.1.3" data-path="convergence-concepts.html"><a href="convergence-concepts.html#weak-convergence"><i class="fa fa-check"></i><b>C.1.3</b> Weak Convergence</a></li>
<li class="chapter" data-level="C.1.4" data-path="convergence-concepts.html"><a href="convergence-concepts.html#central-limit-theorems"><i class="fa fa-check"></i><b>C.1.4</b> Central Limit Theorems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>D</b> Markov Chains</a>
<ul>
<li class="chapter" data-level="D.1" data-path="definition-of-a-markov-chain.html"><a href="definition-of-a-markov-chain.html"><i class="fa fa-check"></i><b>D.1</b> Definition of a Markov Chain</a></li>
<li class="chapter" data-level="D.2" data-path="classification-of-states.html"><a href="classification-of-states.html"><i class="fa fa-check"></i><b>D.2</b> Classification of states</a></li>
<li class="chapter" data-level="D.3" data-path="limit-results-and-invariant-probabilities.html"><a href="limit-results-and-invariant-probabilities.html"><i class="fa fa-check"></i><b>D.3</b> Limit results and invariant probabilities</a></li>
<li class="chapter" data-level="D.4" data-path="absorbing-probabilities.html"><a href="absorbing-probabilities.html"><i class="fa fa-check"></i><b>D.4</b> Absorbing probabilities</a></li>
<li class="chapter" data-level="D.5" data-path="markov-chains-in-continuous-times.html"><a href="markov-chains-in-continuous-times.html"><i class="fa fa-check"></i><b>D.5</b> Markov Chains in Continuous Times</a></li>
<li class="chapter" data-level="D.6" data-path="properties-of-transitionsprobabilities.html"><a href="properties-of-transitionsprobabilities.html"><i class="fa fa-check"></i><b>D.6</b> Properties of transitionsprobabilities</a></li>
<li class="chapter" data-level="D.7" data-path="invariant-probabilies-and-absorption.html"><a href="invariant-probabilies-and-absorption.html"><i class="fa fa-check"></i><b>D.7</b> Invariant probabilies and absorption</a></li>
<li class="chapter" data-level="D.8" data-path="birth-death-processes.html"><a href="birth-death-processes.html"><i class="fa fa-check"></i><b>D.8</b> Birth-death processes</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="continuous-time-stochastic-processes.html"><a href="continuous-time-stochastic-processes.html"><i class="fa fa-check"></i><b>E</b> Continuous Time Stochastic Processes</a>
<ul>
<li class="chapter" data-level="E.1" data-path="point-processes.html"><a href="point-processes.html"><i class="fa fa-check"></i><b>E.1</b> Point processes</a></li>
<li class="chapter" data-level="E.2" data-path="filtration.html"><a href="filtration.html"><i class="fa fa-check"></i><b>E.2</b> Filtration</a></li>
<li class="chapter" data-level="E.3" data-path="martingale.html"><a href="martingale.html"><i class="fa fa-check"></i><b>E.3</b> Martingale</a></li>
<li class="chapter" data-level="E.4" data-path="brownian-motion.html"><a href="brownian-motion.html"><i class="fa fa-check"></i><b>E.4</b> Brownian Motion</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="stochastic-calculus.html"><a href="stochastic-calculus.html"><i class="fa fa-check"></i><b>F</b> Stochastic calculus</a>
<ul>
<li class="chapter" data-level="F.1" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html"><i class="fa fa-check"></i><b>F.1</b> Stochastic Integrals</a>
<ul>
<li class="chapter" data-level="F.1.1" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#information"><i class="fa fa-check"></i><b>F.1.1</b> Information</a></li>
<li class="chapter" data-level="F.1.2" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#stochastic-integrals-1"><i class="fa fa-check"></i><b>F.1.2</b> Stochastic Integrals</a></li>
<li class="chapter" data-level="F.1.3" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#stochastic-calculus-and-the-ito-formula"><i class="fa fa-check"></i><b>F.1.3</b> Stochastic Calculus and the Ito Formula</a></li>
<li class="chapter" data-level="F.1.4" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#the-multidimensional-ito-formula"><i class="fa fa-check"></i><b>F.1.4</b> The multidimensional Ito Formula</a></li>
<li class="chapter" data-level="F.1.5" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#the-multidimensional-ito-formula-with-states"><i class="fa fa-check"></i><b>F.1.5</b> The multidimensional Ito Formula with states</a></li>
<li class="chapter" data-level="F.1.6" data-path="stochastic-integrals.html"><a href="stochastic-integrals.html#correlated-brownian-motions"><i class="fa fa-check"></i><b>F.1.6</b> Correlated Brownian motions</a></li>
</ul></li>
<li class="chapter" data-level="F.2" data-path="discrete-stochastic-integrals.html"><a href="discrete-stochastic-integrals.html"><i class="fa fa-check"></i><b>F.2</b> Discrete Stochastic Integrals</a></li>
<li class="chapter" data-level="F.3" data-path="stochastic-differential-equations.html"><a href="stochastic-differential-equations.html"><i class="fa fa-check"></i><b>F.3</b> Stochastic Differential Equations</a></li>
<li class="chapter" data-level="F.4" data-path="partial-differential-equations.html"><a href="partial-differential-equations.html"><i class="fa fa-check"></i><b>F.4</b> Partial differential equations</a></li>
<li class="chapter" data-level="F.5" data-path="the-product-integral.html"><a href="the-product-integral.html"><i class="fa fa-check"></i><b>F.5</b> The Product Integral</a>
<ul>
<li class="chapter" data-level="F.5.1" data-path="the-product-integral.html"><a href="the-product-integral.html#properties-of-the-product-integral"><i class="fa fa-check"></i><b>F.5.1</b> Properties of the Product Integral</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="G" data-path="linear-algebra.html"><a href="linear-algebra.html"><i class="fa fa-check"></i><b>G</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="G.1" data-path="invertible-matrices.html"><a href="invertible-matrices.html"><i class="fa fa-check"></i><b>G.1</b> Invertible matrices</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://joakim-bilyk.github.io/index.html">Back to main site</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mathematics of the Actuarial Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="matrix-methods-in-life-insurance" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Matrix methods in life insurance<a href="matrix-methods-in-life-insurance.html#matrix-methods-in-life-insurance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="basic-setup" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Basic setup<a href="matrix-methods-in-life-insurance.html#basic-setup" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider the time-inhomogeneous Markov jump process <span class="math inline">\(X=\{X(t)\}_{t\ge 0}\)</span> with a finite state–space <span class="math inline">\(E\)</span> and intensity matrix <span class="math inline">\(\mathbf \Lambda(t)=\{\lambda_{ij}(t)\}_{i,j\in E}\)</span>. We then define the payment process as</p>
<p><span class="math display">\[
dB(t)=\sum_{i\in E}1_{X(t-)=i}\left(b_i(t)\ dt +\sum_{j\in E}b_{ij}(t)\ dN_{ij}(t)\right),
\]</span></p>
<p>with <span class="math inline">\(b_i(t)\)</span> are continuous payment rates (negative if premiums) and <span class="math inline">\(b_{ij}(t)\)</span> lump sum payments, which occur according to the counting measure <span class="math inline">\(N_{ij}(t)\)</span>. The intensity matrix is decomposed into</p>
<p><span class="math display">\[
\mathbf \Lambda(t)=\mathbf \Lambda^0(t) + \mathbf \Lambda^1(t),
\]</span></p>
<p>where <span class="math inline">\(\mathbf \Lambda^1(t)\)</span> is a non–negative matrix and, consequently, <span class="math inline">\(\mathbf \Lambda^0(t)\)</span> a sub–intensity matrix, i.e. row sums are non–positive. We choose this decomposition in a way such that <span class="math inline">\(\mathbf \Lambda^1(t)\)</span> contains the intensities with a factor <span class="math inline">\(l_{ij}(t)\)</span> being the probability upon jump from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> at time <span class="math inline">\(t\)</span> of recieving the payment <span class="math inline">\(b_{ij}(t)\)</span>. In other words, we have the decomposition</p>
<p><span class="math display">\[
\lambda_{ij}(t)=\lambda_{ij}^0(t)+\lambda_{ij}^1(t)=l_{ij}(t)\lambda_{ij}^0(t)+(1-l_{ij}(t))\lambda_{ij}^1(t)\iff l_{ij}(t)=\frac{\lambda_{ij}^1(t)}{\lambda_{ij}^0(t)+\lambda_{ij}^1(t)}.
\]</span></p>
<p>In the case <span class="math inline">\(i=j\)</span> then the counting measure <span class="math inline">\(N_{ii}\)</span> denotes a poisson arrival process for lump sum payments arriving during the visit in the state <span class="math inline">\(i\)</span>. This in particular means that the payment <span class="math inline">\(b_{ii}(t)\)</span> will be triggered in <span class="math inline">\([t,t+dt)\)</span> with probability <span class="math inline">\(\lambda_{ii}^1\ dt\)</span> given that <span class="math inline">\(X(t-)=i\)</span>.</p>
<p>Finally, we assume that the spot interest rates in state i follow a deterministic function <span class="math inline">\(r_i(t)\)</span>. Hence the interest rates follow the model</p>
<p><span class="math display">\[
r(u) = r_{X(u)}(u).
\]</span></p>
<p>Recall that the reserve is defined as</p>
<p><span class="math display">\[
V(t)=\mathbb E^{\mathbb Q}\left[\left.\int_t^Te^{-\int_t^ur(s)\ ds}\ dB(u)\right\vert \mathcal F(t)\right].
\]</span></p>
<p>We will be using the following matrix functions when computing the reserve and higher order moments.
<span class="math display">\[\begin{align*}
\mathbf B(t)&amp;=\{b_{ij}(t)\}_{i,j\in E},\\
\mathbf R(t)&amp;=\mathbf \Lambda^1(t)\bullet \mathbf B(t) + \mathbf \Delta (\mathbf b(t)),\\
\mathbf C^{(k)}(t)&amp;=\mathbf \Lambda^1(t)\bullet \mathbf B^{\bullet k}(t),\qquad k\ge 2,
\end{align*}\]</span>
where <span class="math inline">\(\bullet\)</span> denotes the Schur product simply defined as <span class="math inline">\(\mathbf A\bullet\mathbf B=\{a_{ij}b_{ij}\}\)</span> with <span class="math inline">\(\mathbf A=\{a_{ij}\}\)</span> and <span class="math inline">\(\mathbf B=\{b_{ij}\}\)</span>. The notation <span class="math inline">\(\mathbf \Delta (\cdot)\)</span> operator sets <span class="math inline">\(\cdot\)</span> as the diagonal i.e.</p>
<p><span class="math display">\[
\mathbf \Delta (\mathbf b(t))=\text{diag}(b_1(t),...,b_p(t)),
\]</span></p>
<p>assuming <span class="math inline">\(E=\{1,...,p\}\)</span>. We call <span class="math inline">\(\mathbf B(t)\)</span> the transition payments, <span class="math inline">\(\mathbf R(t)\)</span> the rewards and <span class="math inline">\(\mathbf C^{(k)}(t)\)</span> the <span class="math inline">\(k\)</span>th order contributions. The matrix <span class="math inline">\(\mathbf C^{(k)}(t)\)</span> is mostly usefull notationally rather than intuitively.</p>
</div>
<div id="interest-rate-free-analysis" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Interest rate free analysis<a href="matrix-methods-in-life-insurance.html#interest-rate-free-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we consider the risk free context where we are not concerned with any discounting of expected payments. This make us introduce the following random process</p>
<p><span class="math display">\[
U^0(s,t) = \sum_{i\in E}\int_s^tb_i(u)1_{X(u-)=i}\ du+\sum_{i,j\in E}\int_s^tb_{ij}(u)\ dN_{ij}(u),
\]</span></p>
<p>giving the total reward obtained in the time interval <span class="math inline">\([s,t]\)</span>. We are interested in higher order moments of this quantity (representing the rate free reserve). To this goal we introduce the conditional moments with</p>
<p><span class="math display">\[
m_{ij}^{(k)}(s,t)=\mathbb E\left.\Big[1_{X(t)=j}U^0(s,t)^k\right\vert X(s)=i\Big],
\]</span></p>
<p>representing the weighted expected moment upon start in state <span class="math inline">\(i\)</span> weighted with the probability with end in state <span class="math inline">\(j\)</span>. This forms the matrix</p>
<p><span class="math display">\[
\mathbf m^{(k)}(s,t)=\left\{m_{ij}^{(k)}(s,t)\right\}_{i,j\in E}.
\]</span></p>
<p>For simplicity we simply for <span class="math inline">\(k=1\)</span> write <span class="math inline">\(\mathbf m^{(1)}(s,t) = \mathbf m(s,t)\)</span>.</p>
<blockquote class="thm">
<p><strong>Theorem 5.1. (Bladt)</strong> <em>With the above assumptions it holds that</em></p>
<p><span class="math display">\[
\mathbf m(s,t)=\int_s^t\mathbf P(s,u)\mathbf R(u)\mathbf P(u,t)\ du.
\]</span></p>
<p><em>In particular, by Van Loans formula we have</em></p>
<p><span class="math display">\[
\prod_s^t\left(\mathbf I + \begin{pmatrix}\mathbf \Lambda(x) &amp; \mathbf R(t)\\ \mathbf 0 &amp; \mathbf \Lambda(x)\end{pmatrix} dx\right)=
\begin{pmatrix}
\mathbf P(s,t) &amp; \mathbf m(s,t)\\
\mathbf 0 &amp; \mathbf P(s,t).
\end{pmatrix}
\]</span></p>
</blockquote>
</div>
<div id="transform-of-rewards-and-higher-order-moments" class="section level3 hasAnchor" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Transform of rewards and higher order moments<a href="matrix-methods-in-life-insurance.html#transform-of-rewards-and-higher-order-moments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that for a random variable <span class="math inline">\(X\)</span> the moment generating function <span class="math inline">\(M(\theta)\)</span> given by</p>
<p><span class="math display">\[
M(\theta)=\mathbb E[e^{\theta X}],
\]</span></p>
<p>gives us a comprehensive insight into the moments of <span class="math inline">\(X\)</span>. Take the taylor approximation of <span class="math inline">\(e^{\theta X}\)</span>:</p>
<p><span class="math display">\[
e^{\theta X}=\sum_{n=0}^\infty\frac{(\theta X)^n}{n!}
\]</span></p>
<p>Hence taking expectation gives</p>
<p><span class="math display">\[
M_X(\theta)=\mathbb E[e^{\theta X}]=\mathbb E\left[\sum_{n=0}^\infty\frac{(\theta X)^n}{n!}\right]=\sum_{n=0}^\infty\frac{\theta^n \mathbb E[X^n]}{n!}.
\]</span></p>
<p>Now differentiating wrt. <span class="math inline">\(\theta\)</span> yields the important result</p>
<p><span class="math display">\[
\frac{\partial M_X(\theta)}{\partial \theta}(\theta)=\sum_{n=1}^\infty\frac{n\theta^{n-1} \mathbb E[X^n]}{n!}=\sum_{n=1}^\infty\frac{\theta^{n-1} \mathbb E[X^n]}{(n-1)!}=\mathbb E[X]+\sum_{n=1}^\infty\frac{\theta^{n} \mathbb E[X^{n+1}]}{n!},
\]</span></p>
<p>hence by evaluating in <span class="math inline">\(\theta = 0\)</span> we get <span class="math inline">\(M&#39;_X(0)=\mathbb E[X]\)</span>. In general we have</p>
<p><span class="math display">\[
\left.\frac{\partial^n M_X(\theta)}{\partial \theta^n}(\theta)\right\vert_{\theta = 0}=\mathbb E[X^n],\qquad n\ge 1.
\]</span></p>
<p>This is really the motivation for examining the moment generating function of the reward obtained in the interval <span class="math inline">\([s,t]\)</span> i.e. the quantity <span class="math inline">\(U^0(s,t)\)</span>. To this we define</p>
<p><span class="math display">\[
\hat F_{ij}(\theta;s,t)=\mathbb E\left[\left.e^{\theta U^0(s,t)}1\{X(t)=j\}\ \right\vert\ X(s)=i\right],
\]</span></p>
<p>for <span class="math inline">\(i,j=1,...,p\)</span>. Obviously we have the following identity</p>
<p><span class="math display">\[
\sum_{j=1}^p\hat F_{ij}(\theta;s,t)=\mathbb E\left[\left.e^{\theta U^0(s,t)}\ \right\vert\ X(s)=i\right].
\]</span></p>
<p>Furthermore, if we define the distribution of <span class="math inline">\(X(t),U^0(s,t)\)</span> given <span class="math inline">\(X(s)\)</span> by</p>
<p><span class="math display">\[
F_{ij}(x; s,t)=\mathbb P(X(t)=j,U^0(s,t)\le x\ \vert\ X(s)=i)
\]</span></p>
<p>then we have the integral decomposition</p>
<p><span class="math display">\[
\hat F_{ij}(\theta; s,t)=\int_{\mathbb R} e^{\theta x}\ dF_{ij}(x; s,t).
\]</span></p>
<p>The following theorem gives a way of calculating the object <span class="math inline">\(\hat{\mathbf F}(\theta; s,t)=\{\hat F_{ij}(\theta; s,t)\}\)</span>.</p>
<blockquote class="thm">
<p><strong>Theorem 5.5. (Bladt)</strong> <em>Let <span class="math inline">\(\hat{\mathbf F}(\theta; s,t)=\{\hat F_{ij}(\theta; s,t)\}_{i,j=1,...,p}\)</span> and</em></p>
<p><span class="math display">\[
\mathbf A(\theta;u)=\mathbf\Lambda^1(u)\bullet\left\{e^{\theta b_{kl}(u)}\right\}_{k,l}+\mathbf \Lambda^0(u)+\theta \mathbf \Delta(\mathbf b(u))
\]</span></p>
<p><em>where <span class="math inline">\(\bullet\)</span> denotes the Schur matrix product. Then the moment generating function of <span class="math inline">\(U^0(s,t)\)</span> is given by</em></p>
<span class="math display">\[
\hat{\mathbf F}(\theta; s,t)=\prod_s^t(\mathbf I + \mathbf A(\theta; u)\ du).
\]</span>
</blockquote>
<p>By the above theorem we see that</p>
<p><span class="math display">\[
\mathbb E\left[\left.e^{\theta U^0(s,t)}\ \right\vert\ X(s)=i\right] =e_i^\top\hat{\mathbf F}(\theta; s,t)e = e_i^\top\prod_s^t(\mathbf I + \mathbf A(\theta; u)\ du)e,
\]</span></p>
<p>in particular</p>
<p><span class="math display">\[
\prod_s^t(\mathbf I + \mathbf A(\theta; u)\ du)e=
\begin{pmatrix}
\mathbb E\left[\left.e^{\theta U^0(s,t)}\ \right\vert\ X(s)=1\right]\\
\mathbb E\left[\left.e^{\theta U^0(s,t)}\ \right\vert\ X(s)=2\right]\\
\vdots\\
\mathbb E\left[\left.e^{\theta U^0(s,t)}\ \right\vert\ X(s)=p\right]
\end{pmatrix}.
\]</span></p>
<p>Furthermore, we have from the property above that</p>
<p><span class="math display">\[
\left.\frac{\partial^k}{\partial \theta^k}\left(e_i^\top\prod_s^t(\mathbf I + \mathbf A(\theta; u)\ du)e\right)\right\vert_{\theta = 0}=m^{(k)}_{i}(s,t).
\]</span></p>
<blockquote class="lem">
<p><strong>Lemma 5.6. (Bladt)</strong> <em>Given the definitions in theorem 5.5 we have</em>
<span class="math display">\[\begin{align*}
\left.\frac{\partial^0}{\partial \theta^0}\mathbf A(\theta; s)\right\vert_{\theta=0}&amp;=\mathbf A(\theta; s)\Big\vert_{\theta=0}=\mathbf \Lambda^1(s)+\mathbf\Lambda^0(s)=\mathbf\Lambda(s),\\
\left.\frac{\partial}{\partial \theta}\mathbf A(\theta; s)\right\vert_{\theta=0}&amp;=\mathbf \Lambda^1(s)\bullet \mathbf B(s)+\mathbf \Delta(\mathbf b(s))=\mathbf R(s),\\
\left.\frac{\partial^k}{\partial \theta^k}\mathbf A(\theta; s)\right\vert_{\theta=0}&amp;=\mathbf \Lambda^1(s)\bullet \mathbf B^{\bullet k} B(s)=\mathbf C^{(k)}(s),\qquad k&gt;1.
\end{align*}\]</span></p>
</blockquote>
<p>Recall that we defined the moments in general by</p>
<p><span class="math display">\[
\mathbf m^{(k)}(s,t)=\left\{\mathbb E\left[\left. 1\{X(t)=j\}U^0(s,t)^k\ \right\vert\ X(s)=i\right]\right\}_{i,j=1,...,p}=\left\{m^{(k)}_{ij}(s,t)\right\}_{i,j=1,...,p},
\]</span></p>
<p>hence we can define (for ease of notation) the reduced moments by</p>
<p><span class="math display">\[
\mathbf m_r^{(k)}(s,t)=\left\{\frac{m^{(k)}_{ij}(s,t)}{k!}\right\}_{i,j=1,...,p}=\frac{1}{k!}\mathbf m^{(k)}(s,t).
\]</span></p>
<p>Furthermore, we define the reduced contributions</p>
<p><span class="math display">\[
\mathbf C^{(k)}_r(s,t)=\frac{1}{k!}\mathbf C^{(k)}(s,t)=\frac{1}{k!}\mathbf \Lambda^1(t)\bullet \mathbf B^{\bullet k}(t).
\]</span></p>
<blockquote class="thm">
<p><strong>Theorem 5.7. (Bladt)</strong> <em>Given the definitions above we have</em></p>
<p><span class="math display">\[
\mathbf m^{(k)}(s,t)=\int_s^t\mathbf P(s,x)\mathbf R(x)\mathbf m^{(k-1)}_r(x,t)\ dx+\sum_{m=2}^k\int_s^t\mathbf P(s,x)\mathbf C^{(m)}_r(x)\mathbf m^{(k-m)}_r(x,t)\ dx.
\]</span></p>
</blockquote>
<p>Using this result we can make a powerful statement regarding how one could calculate all of the <span class="math inline">\(k\)</span>th moments at once. To this we have the result.</p>
<blockquote class="thm">
<p><strong>Theorem 5.8. (Bladt)</strong> <em>Let <span class="math inline">\(\mathbf F^{(k)}(x)\)</span> be given by</em></p>
<p><span class="math display">\[
\mathbf F^{(k)}(x)=
\begin{bmatrix}
\mathbf \Lambda(x) &amp; \mathbf R(x) &amp; \mathbf C^{(2)}_r(x) &amp; \cdots &amp; \mathbf C^{(k-1)}_r(x) &amp; \mathbf C^{(k)}_r(x)\\
\mathbf 0 &amp; \mathbf \Lambda(x) &amp; \mathbf R(x) &amp; \cdots &amp; \mathbf C^{(k-2)}_r(x) &amp; \mathbf C^{(k-1)}_r(x)\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp;\mathbf \Lambda(x) &amp; \mathbf R(x)\\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf 0 &amp;\mathbf \Lambda(x)
\end{bmatrix},
\]</span></p>
<p><em>and <span class="math inline">\(\mathbf H^{(k)}(s,t)\)</span> defined by</em></p>
<p><span class="math display">\[
\mathbf H^{(k)}(x)=
\begin{bmatrix}
\mathbf P(s,t) &amp; \mathbf m_r^{(1)}(s,t) &amp; \mathbf m_r^{(2)}(s,t) &amp; \cdots &amp; \mathbf m_r^{(k-1)}(s,t) &amp; \mathbf m_r^{(k)}(s,t)\\
\mathbf 0 &amp; \mathbf P(s,t) &amp; \mathbf m_r^{(1)}(s,t) &amp; \cdots &amp; \mathbf m_r^{(k-2)}(s,t) &amp; \mathbf m_r^{(k-1)}(s,t)\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf P(s,t) &amp; \mathbf m_r^{(1)}(s,t)\\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf 0 &amp; \mathbf P(s,t)
\end{bmatrix}.
\]</span></p>
<p><em>Then we have the result</em></p>
<p><span class="math display">\[
\prod_s^t(\mathbf I + \mathbf F^{(k)}(x)\ dx)=\mathbf H^{(k)}(s,t).
\]</span></p>
</blockquote>
<p>For ease of notation we define the Toeplitz matrix as</p>
<p><span class="math display">\[
\mathcal T(\mathbf A_1,\mathbf A_2,...,\mathbf A_n)=
\begin{bmatrix}
\mathbf A_1 &amp; \mathbf A_2 &amp; \mathbf A_3 &amp; \cdots &amp; \mathbf A_{n-1} &amp; \mathbf A_n\\
\mathbf 0 &amp; \mathbf A_1 &amp; \mathbf A_2 &amp; \cdots &amp; \mathbf A_{n-2} &amp; \mathbf A_{n-1}\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf A_1 &amp; \mathbf A_2\\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf 0 &amp; \mathbf A_1
\end{bmatrix}.
\]</span></p>
<p>And hence we could write:</p>
<p><span class="math display">\[
\mathbf F^{(k)}(x)=\mathcal T(\mathbf \Lambda(x), \mathbf R(x) , \mathbf C^{(2)}_r(x) , ... , \mathbf C^{(k-1)}_r(x), \mathbf C^{(k)}_r(x)),
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\mathbf H^{(k)}(x)=\mathcal T(\mathbf P(s,t) , \mathbf m_r^{(1)}(s,t) , \mathbf m_r^{(2)}(s,t), ...,\mathbf m_r^{(k-1)}(s,t) , \mathbf m_r^{(k)}(s,t)).
\]</span></p>
</div>
<div id="markovian-interest-rates" class="section level3 hasAnchor" number="4.5.4">
<h3><span class="header-section-number">4.5.4</span> Markovian interest rates<a href="matrix-methods-in-life-insurance.html#markovian-interest-rates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now study how we may calculate the moments of the reserves in the case with rates. To this we start by assuming the Markov-jump interest model in sync with the Markov-jump process for the policy holder. Obviously, we in practice would assume that these two processes are independent, but for generality we will not insist on this for now. We therefore define the process</p>
<p><span class="math display">\[
\mathbf r(t)=\{r_i(t)\}_{i\in E_r}
\]</span></p>
<p>and the two Markov jump processes</p>
<p><span class="math display">\[
X_r=\{X_r(t)\}_{t\ge 0}\in E_r=\{1,...,p\},\qquad X_b(t)=\{X_b(t)\}_{t\ge 0}\in E_b=\{1,...,q\},
\]</span></p>
<p>and naturally we at time <span class="math inline">\(t\)</span> have the interest rate <span class="math inline">\(r_{X_r(t)}(t)\)</span> and <span class="math inline">\(X_v(t)\)</span> governs the state of the policy holder. Using this we define the combined Markov jump process as</p>
<p><span class="math display">\[
X(t)=\{X_r(t),X_b(t)\}_{t\ge 0}\in E_r\times E_b.
\]</span></p>
<p>The processes <span class="math inline">\(X_b\)</span> and <span class="math inline">\(X_r\)</span> may or may not be independent, and the payment processes likewise may or may not be independent of <span class="math inline">\(X_r\)</span>. In the independent case the processes <span class="math inline">\(X_b\)</span> and <span class="math inline">\(X_r\)</span> are defined on each their state–space, and the common state–space will be the product set of the two. If the processes are sharing states, with the possibility of having simultaneous jumps, then we obtain dependency of the processes. Such a case could, e.g. be a rise in the interest rate causing an increased intensity of jumping to surrender or free–policy states.</p>
<p>In the case where we have independence we have that the transition intensities of <span class="math inline">\(X\)</span> is given by</p>
<p><span class="math display">\[
\mathbf \Lambda(t)=\mathbf \Lambda_b(t)\oplus \mathbf\Lambda_r(t)=\mathbf \Lambda_b(t)\otimes \mathbf I_p+\mathbf I_p \otimes \mathbf \Lambda_r(t)=\{\lambda_{ij}\}_{i,j=1,...,pq},
\]</span></p>
<p>where <span class="math inline">\(\oplus\)</span> is the Kronecker sum and <span class="math inline">\(\otimes\)</span> is the Kronecker product given by</p>
<p><span class="math display">\[
\mathbf A\otimes \mathbf B=\{a_{ij}\mathbf B\}=\begin{bmatrix}
a_{1,1}\mathbf B &amp; \cdots &amp; a_{1,n}\mathbf B\\
\vdots &amp; \ddots &amp; \vdots\\
a_{n,1}\mathbf B &amp; \cdots &amp; a_{n,n}\mathbf B
\end{bmatrix}.
\]</span></p>
</div>
<div id="reserves" class="section level3 hasAnchor" number="4.5.5">
<h3><span class="header-section-number">4.5.5</span> Reserves<a href="matrix-methods-in-life-insurance.html#reserves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We now consider the valuation of the payment process <span class="math inline">\(B\)</span>. Introduce the matrix of partial state–wise prospective reserves,
<span class="math display">\[\begin{align*}
\mathbf V(s,t)&amp;=\{V_{ij}(s,t)\}_{i,j\in E_b},\\
V_{ij}(s,t)&amp;=\mathbb E\left[\left.1\{X(t)=j\}\int_s^te^{-\int_s^xr_{X(u)}(u)\ du}\ dB(x) \ \right\vert\ X(s)=i\right].
\end{align*}\]</span>
From the Markov-jump representation we recall that we defines <span class="math inline">\(d_{ij}(s,t)\)</span> by</p>
<p><span class="math display">\[
d_{ij}(s,t)=\mathbb E\left[\left.1\{X(t)=j\}\exp\left\{-\int_s^tr_{X(u)}(u)\ du\right\} \ \right\vert\ X(s)=i\right],
\]</span></p>
<p>and that the matrix <span class="math inline">\(\mathbf D(s,t)=\{d_{ij}(s,t)\}\)</span> has representation</p>
<p><span class="math display">\[
\mathbf D(s,t)=\prod_s^t\Big(\mathbf I+[\mathbf \Lambda(u)-\mathbf\Delta (r(u))]\ du\Big).
\]</span></p>
<p>Using this we have the theorem.</p>
<blockquote class="thm">
<p><strong>Theorem 5.10. (Bladt)</strong> <em>The matrix of partial state-wise prospective reserves <span class="math inline">\(\mathbf V(s,t)\)</span> has the following integral representation</em></p>
<span class="math display">\[
\mathbf V(s,t)=\int_s^t\mathbf D(s,x)\mathbf R(x)\mathbf P(x,t)\ dx.
\]</span>
</blockquote>
<p>Using Van loans formula we can avoid the integration and calculate the product integral from below.</p>
<blockquote class="prop">
<p><strong>Corollary 5.11. (Bladt)</strong> <em>The matrix of partial state-wise prospective reserves <span class="math inline">\(\mathbf V(s,t)\)</span> has the following product integral representation</em></p>
<span class="math display">\[
\prod_s^t\left(\mathbf I+
\begin{pmatrix}
\mathbf \Lambda(u)-\mathbf \Delta (r(u)) &amp; \mathbf R(u)\\
\mathbf 0 &amp; \mathbf \Lambda(u)
\end{pmatrix}
\right)=\begin{pmatrix}
\mathbf D(s,t) &amp; \mathbf V(s,t)\\
\mathbf 0 &amp; \mathbf P(s,t)
\end{pmatrix}.
\]</span>
</blockquote>
<p>Finally, we state and prove Thiele’s differential equations for partial reserves with stochastic interest rates.</p>
<blockquote class="thm">
<p><strong>Theorem 5.12. (Bladt)</strong> <em>The state-wise reserves satisfies the differential equations</em></p>
<p><span class="math display">\[
\frac{\partial}{\partial s}\mathbf V(s,t)=-[\mathbf \Lambda(s) - \mathbf\Delta(r(s))]\mathbf V(s,t) - \mathbf R(s)\mathbf P(s,t)
\]</span></p>
<p><em>where <span class="math inline">\(\mathbf V(t,t)=0\)</span>. For the conventional state-wise prospective reserves <span class="math inline">\(\mathbf V^{Th}(t)=\mathbf V(t,T)\mathbf e\)</span>, this has the form</em></p>
<p><span class="math display">\[
\frac{\partial}{\partial s}\mathbf V^{Th}(t)=-[\mathbf \Lambda(t) - \mathbf\Delta(r(t)]\mathbf V^{Th}(t) - \mathbf R(t)\mathbf e,
\]</span></p>
<p><em>where <span class="math inline">\(\mathbf V^{Th}(T)=\mathbf 0\)</span>.</em></p>
</blockquote>
</div>
<div id="higher-order-moments" class="section level3 hasAnchor" number="4.5.6">
<h3><span class="header-section-number">4.5.6</span> Higher order moments<a href="matrix-methods-in-life-insurance.html#higher-order-moments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the matrix of partial state-wise higher order moments of future payments, given by, for <span class="math inline">\(k\in\mathbb N\)</span>,
<span class="math display">\[\begin{align*}
\mathbf V^{(k)}(t,T)&amp;=\Big\{V_{ij}^{(k)}(t,T)\Big\}_{i,j\in E}\\
V_{ij}^{(k)}(t,T)&amp;=\mathbb E\left[\left.1\{X(T)=j\}\left(\int_s^te^{-\int_s^xr_{X(u)}(u)\ du}\ dB(x)\right)^k \ \right\vert\ X(s)=i\right],
\end{align*}\]</span>
and introduce what we shall term the <em>reduced</em> partial state-wise higher order moments:</p>
<p><span class="math display">\[
\mathbf V_r^{(k)}(t,T)=\frac{\mathbf V^{(k)}(t,T)}{k!}
\]</span></p>
<p>and denoting</p>
<p><span class="math display">\[
\mathbf D^{(m)}(s,t)=\prod_s^t\Big(\mathbf I + [\mathbf\Lambda(u)-m\mathbf\Delta(r(u))]\ du\Big),\qquad m\in\mathbb N,
\]</span></p>
<p>we then obtain the following version of Hattendorff’s theorem for partial reserves with stochastic interest rate.</p>
<blockquote class="thm">
<strong>Theorem 5.13. (Bladt)</strong> <em>The matrix of reduced partial state-wise higher order moments satisfies the integral equation, for <span class="math inline">\(k\in\mathbb N_0\)</span>,</em>
<span class="math display">\[\begin{align*}
\mathbf V_r^{(k)}&amp;(t,T)\\
&amp;=\int_t^T\mathbf D^{(k)}(t,x)\mathbf R(x)\mathbf V^{(k-1)}_r(x,T)\ dx+\sum_{m=2}^k\int_t^T\mathbf D^{(k)}(t,x)\mathbf C^{(m)}_r(x)\mathbf V^{(k-m)}_r(x,T)\ dx.
\end{align*}\]</span>
</blockquote>
<p>Using Van loan we can define the following matrix</p>
<p><span class="math display">\[
\mathbf F_U^{(k)}(x)=
\begin{bmatrix}
\mathbf \Lambda(x)-k\mathbf \Delta(r(x)) &amp; \mathbf R(x) &amp; \mathbf C^{(2)}_r(x) &amp; \cdots &amp; \mathbf C_r^{(k-1)}(x) &amp; \mathbf C_r^{(k)}(x)\\
\mathbf0 &amp; \mathbf \Lambda(x)-(k-1)\mathbf \Delta(r(x)) &amp; \mathbf R(x)  &amp; \cdots &amp; \mathbf C_r^{(k-2)}(x) &amp; \mathbf C_r^{(k-1)}(x)\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf \Lambda(x)-\mathbf \Delta(r(x)) &amp; \mathbf R(x)\\
\mathbf 0 &amp; \mathbf 0 &amp; \mathbf 0 &amp; \cdots &amp; \mathbf 0 &amp; \mathbf \Lambda(x)
\end{bmatrix},
\]</span></p>
<p>then we get the usefull product integral</p>
<p><span class="math display">\[
\prod_t^T\Big(\mathbf I + \mathbf F_U^{(k)}(x)\ dx\Big)=
\begin{bmatrix}
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf V_r^{(k)}(t)\\
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf V_r^{(k-1)}(t)\\
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf V_r^{(k-2)}(t)\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp;\vdots &amp; \vdots\\
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf V_r^{(2)}(t)\\
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf V(t)\\
* &amp; * &amp; * &amp; * &amp; \cdots &amp;* &amp; \mathbf P(t,T)
\end{bmatrix}.
\]</span></p>
<p>Then by differentiating we obtain the classical differential equations below.</p>
<blockquote class="thm">
<p><strong>Theorem 5.14. (Bladt)</strong> <em>The matrix of reduced partial state-wise higher order moments satisfies the system of differential equations, for <span class="math inline">\(k\in \mathbb N_0\)</span>,</em></p>
<p><span class="math display">\[
\frac{\partial}{\partial t}\mathbf V_r^{(k)}(t,T)=\Big(k\mathbf\Delta(r(t)) - \mathbf \Lambda(t)\Big)\mathbf V_r^{(k)}(t,T)-\mathbf R(t)\mathbf V_r^{(k-1)}(t,T)-\sum_{i=2}^k\mathbf C_r^{(i)}(t)\mathbf V_r^{(k-i)}(t,T),
\]</span></p>
<em>with terminal condition <span class="math inline">\(\mathbf V_r^{(k)}(T,T)=1_{(k=0)}\mathbf I\)</span>.</em>
</blockquote>
</div>
<div id="equivalence-premium" class="section level3 hasAnchor" number="4.5.7">
<h3><span class="header-section-number">4.5.7</span> Equivalence premium<a href="matrix-methods-in-life-insurance.html#equivalence-premium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We assume that a policy has payments determined and fixed and that we want to adjust one or more payments such that <span class="math inline">\(V^{Th}\)</span> satisfies the equivalence principle i.e. <span class="math inline">\(V_{X(0)}^{Th}(0)=0\)</span>. To this define <span class="math inline">\(\mathbf R(t)=\mathbf R(t;\theta)\)</span> for some payment <span class="math inline">\(\theta\)</span>. Notice that <span class="math inline">\(\theta\)</span> is rather general and may be thought of as either a single transition payment or payment rate. This in particular gives the mapping <span class="math inline">\(\theta \mapsto \mathbf V(t;\theta)\)</span> given by</p>
<p><span class="math display">\[
\mathbf V(t;\theta) = \int_t^T\prod_t^u\Big(\mathbf I +[\mathbf\Lambda(s)-\mathbf\Delta(r(s))]\ ds\Big)\mathbf R(u;\theta)\prod_u^T\Big(\mathbf I +\mathbf \Lambda(s)\ ds\Big)\ du,
\]</span></p>
<p>hence if <span class="math inline">\(\mathbf R(t;\theta)\)</span> is continuously differentiable and <span class="math inline">\(\mathbf \Lambda\)</span> and <span class="math inline">\(\mathbf r\)</span> are continuous we have</p>
<p><span class="math display">\[
\frac{\partial}{\partial \theta}\mathbf V(t;\theta) = \int_t^T\prod_t^u\Big(\mathbf I +[\mathbf\Lambda(s)-\mathbf\Delta(r(s))]\ ds\Big)\frac{\partial}{\partial \theta}\mathbf R(u;\theta)\prod_u^T\Big(\mathbf I +\mathbf \Lambda(s)\ ds\Big)\ du.
\]</span></p>
<p>and then by Van loan formula</p>
<p><span class="math display">\[
\prod_t^T\left(\mathbf I+
\begin{pmatrix}
\mathbf \Lambda(u)-\mathbf \Delta(r(u)) &amp; \frac{\partial}{\partial \theta}\mathbf R(u;\theta)\\
\mathbf 0 &amp; \mathbf \Lambda(u)
\end{pmatrix}du
\right)=
\begin{pmatrix}
\mathbf D(t,T) &amp; \frac{\partial}{\partial \theta}\mathbf V(t;\theta)\\
\mathbf 0 &amp; \mathbf P(t,T)
\end{pmatrix}.
\]</span></p>
<p>Using this framework we can make establish the pricing corollary below.</p>
<blockquote class="prop">
<p><strong>Corollary.</strong> <em>(Equivalence premium) Assume that <span class="math inline">\(\mathbf R(t)=\mathbf R(t;\theta)\)</span> for <span class="math inline">\(\theta\in\Theta\)</span>. Let <span class="math inline">\(\tilde\theta\)</span> b the equivalence premium i.e. <span class="math inline">\(\tilde \theta\)</span> solves <span class="math inline">\(V^{Th}_{X(0)}(0;\tilde\theta)=0\)</span>, then the sequence <span class="math inline">\(\{\theta_n\}_{n\in \mathbb N_0}\)</span> defined by</em></p>
<p><span class="math display">\[
\theta_0\in\Theta,\qquad \theta_{n+1}=\theta_{n}-\frac{\mathbf e_{X(0)}^\top\mathbf V(0;\theta_n)\mathbf e}{\mathbf e_{X(0)}^\top\mathbf V_\theta(0;\theta_n)\mathbf e},
\]</span></p>
<p><em>converges to <span class="math inline">\(\tilde\theta\)</span>. In the above <span class="math inline">\(\mathbf V_\theta(0;\theta)\)</span> denote the first derivative in <span class="math inline">\(\theta\)</span>. In case <span class="math inline">\(V^{Th}_{X(0)}(0;\tilde\theta)\)</span> is linear in <span class="math inline">\(\theta\)</span> then the above converges for <span class="math inline">\(n=1\)</span> and</em></p>
<p><span class="math display">\[
\tilde\theta = -\frac{\mathbf e_{X(0)}^\top\mathbf V(0;0)\mathbf e}{\mathbf e_{X(0)}^\top\mathbf V_\theta(0;0)\mathbf e}.
\]</span></p>
</blockquote>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="survival-and-mortality-rates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="financial-mathematics-in-life-insurance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["theory.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
