<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.2 Part two | Exam preparation</title>
  <meta name="description" content="5.2 Part two | Exam preparation" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="5.2 Part two | Exam preparation" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.2 Part two | Exam preparation" />
  
  
  

<meta name="author" content="Joakim Bilyk" />


<meta name="date" content="2023-04-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-one.html"/>

<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

<script>
    $(function() {
        var element = document.body;
        if (localStorage.chkbx && localStorage.chkbx != '') {
            $('#remember_me').attr('checked', 'checked');
            element.classList.toggle("dark-mode");
            document.querySelector('.book-header.fixed').click();
        } else {
            $('#remember_me').removeAttr('checked');
            document.querySelector('.book-header.fixed').click();
        }

        $('#remember_me').click(function() {

            if ($('#remember_me').is(':checked')) {
                // save username and password
                localStorage.chkbx = $('#remember_me').val();
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            } else {
                localStorage.chkbx = '';
                element.classList.toggle("dark-mode");
                document.querySelector('.book-header.fixed').click();
            }
        });
    });

</script>

<div class = "sticky-darkmode-toggle">
  <label class="switch">
  <input type="checkbox" value="remember-me" id="remember_me">
  <span class="slider round">
  </span>
  </label>
</div>

<script>
$(function() {
  $('body').after($('.sticky-darkmode-toggle'));
})
</script>

<style>

.sticky-darkmode-toggle {
  position: fixed;
  right: 20px;
  bottom: 20px;
}
</style>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Exam preparation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="abbreviations.html"><a href="abbreviations.html"><i class="fa fa-check"></i><b>1.1</b> Abbreviations</a></li>
<li class="chapter" data-level="1.2" data-path="to-do-work.html"><a href="to-do-work.html"><i class="fa fa-check"></i><b>1.2</b> To-do work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="continuous-time-finance.html"><a href="continuous-time-finance.html"><i class="fa fa-check"></i><b>2</b> Continuous Time Finance</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exam-201718.html"><a href="exam-201718.html"><i class="fa fa-check"></i><b>2.1</b> Exam 2017/18</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="exam-201718.html"><a href="exam-201718.html#problem-1"><i class="fa fa-check"></i><b>2.1.1</b> Problem 1</a></li>
<li class="chapter" data-level="2.1.2" data-path="exam-201718.html"><a href="exam-201718.html#problem-2"><i class="fa fa-check"></i><b>2.1.2</b> Problem 2</a></li>
<li class="chapter" data-level="2.1.3" data-path="exam-201718.html"><a href="exam-201718.html#problem-3"><i class="fa fa-check"></i><b>2.1.3</b> Problem 3</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="exam-201819.html"><a href="exam-201819.html"><i class="fa fa-check"></i><b>2.2</b> Exam 2018/19</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exam-201819.html"><a href="exam-201819.html#problem-1-1"><i class="fa fa-check"></i><b>2.2.1</b> Problem 1</a></li>
<li class="chapter" data-level="2.2.2" data-path="exam-201819.html"><a href="exam-201819.html#problem-2-1"><i class="fa fa-check"></i><b>2.2.2</b> Problem 2</a></li>
<li class="chapter" data-level="2.2.3" data-path="exam-201819.html"><a href="exam-201819.html#problem-3-1"><i class="fa fa-check"></i><b>2.2.3</b> Problem 3</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="exam-201920.html"><a href="exam-201920.html"><i class="fa fa-check"></i><b>2.3</b> Exam 2019/20</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="exam-201920.html"><a href="exam-201920.html#problem-1-2"><i class="fa fa-check"></i><b>2.3.1</b> Problem 1</a></li>
<li class="chapter" data-level="2.3.2" data-path="exam-201920.html"><a href="exam-201920.html#problem-2-2"><i class="fa fa-check"></i><b>2.3.2</b> Problem 2</a></li>
<li class="chapter" data-level="2.3.3" data-path="exam-201920.html"><a href="exam-201920.html#problem-3-2"><i class="fa fa-check"></i><b>2.3.3</b> Problem 3</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exam-202021.html"><a href="exam-202021.html"><i class="fa fa-check"></i><b>2.4</b> Exam 2020/21</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="exam-202021.html"><a href="exam-202021.html#problem-1-3"><i class="fa fa-check"></i><b>2.4.1</b> Problem 1</a></li>
<li class="chapter" data-level="2.4.2" data-path="exam-202021.html"><a href="exam-202021.html#problem-3-3"><i class="fa fa-check"></i><b>2.4.2</b> Problem 3</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="exam-202122.html"><a href="exam-202122.html"><i class="fa fa-check"></i><b>2.5</b> Exam 2021/22</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="exam-202122.html"><a href="exam-202122.html#problem-1-4"><i class="fa fa-check"></i><b>2.5.1</b> Problem 1</a></li>
<li class="chapter" data-level="2.5.2" data-path="exam-202122.html"><a href="exam-202122.html#problem-2-3"><i class="fa fa-check"></i><b>2.5.2</b> Problem 2</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="exam-202223.html"><a href="exam-202223.html"><i class="fa fa-check"></i><b>2.6</b> Exam 2022/23</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="topics-in-life-insurance-mathematics.html"><a href="topics-in-life-insurance-mathematics.html"><i class="fa fa-check"></i><b>3</b> Topics in Life Insurance Mathematics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="question-1-interest-and-mortality-rate-models.html"><a href="question-1-interest-and-mortality-rate-models.html"><i class="fa fa-check"></i><b>3.1</b> Question 1: Interest and mortality rate models</a></li>
<li class="chapter" data-level="3.2" data-path="question-2-matrix-approach-to-life-insurance-models.html"><a href="question-2-matrix-approach-to-life-insurance-models.html"><i class="fa fa-check"></i><b>3.2</b> Question 2: Matrix-approach to life insurance models</a></li>
<li class="chapter" data-level="3.3" data-path="question-3-unit-linked-life-insurance-models.html"><a href="question-3-unit-linked-life-insurance-models.html"><i class="fa fa-check"></i><b>3.3</b> Question 3: Unit-linked life insurance models</a></li>
<li class="chapter" data-level="3.4" data-path="question-4-with-profit-life-insurance-models.html"><a href="question-4-with-profit-life-insurance-models.html"><i class="fa fa-check"></i><b>3.4</b> Question 4: With-profit life insurance models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quantative-risk-management.html"><a href="quantative-risk-management.html"><i class="fa fa-check"></i><b>4</b> Quantative Risk Management</a>
<ul>
<li class="chapter" data-level="4.1" data-path="emne-1-risk-measures.html"><a href="emne-1-risk-measures.html"><i class="fa fa-check"></i><b>4.1</b> Emne 1: Risk measures</a></li>
<li class="chapter" data-level="4.2" data-path="emne-2-var-and-es.html"><a href="emne-2-var-and-es.html"><i class="fa fa-check"></i><b>4.2</b> Emne 2: VaR and ES</a></li>
<li class="chapter" data-level="4.3" data-path="emne-3-evt.html"><a href="emne-3-evt.html"><i class="fa fa-check"></i><b>4.3</b> Emne 3: EVT</a></li>
<li class="chapter" data-level="4.4" data-path="emne-4-elliptical-distributions.html"><a href="emne-4-elliptical-distributions.html"><i class="fa fa-check"></i><b>4.4</b> Emne 4: Elliptical distributions}</a></li>
<li class="chapter" data-level="4.5" data-path="emne-5-copulas-i.html"><a href="emne-5-copulas-i.html"><i class="fa fa-check"></i><b>4.5</b> Emne 5: Copulas I</a></li>
<li class="chapter" data-level="4.6" data-path="emne-6-copulas-ii.html"><a href="emne-6-copulas-ii.html"><i class="fa fa-check"></i><b>4.6</b> Emne 6: Copulas II</a></li>
<li class="chapter" data-level="4.7" data-path="emne-7-credit-risk-i.html"><a href="emne-7-credit-risk-i.html"><i class="fa fa-check"></i><b>4.7</b> Emne 7: Credit Risk I</a></li>
<li class="chapter" data-level="4.8" data-path="emne-8-credit-risk-ii.html"><a href="emne-8-credit-risk-ii.html"><i class="fa fa-check"></i><b>4.8</b> Emne 8: Credit Risk II</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probabilistic-machine-learning.html"><a href="probabilistic-machine-learning.html"><i class="fa fa-check"></i><b>5</b> Probabilistic Machine Learning</a>
<ul>
<li class="chapter" data-level="5.1" data-path="part-one.html"><a href="part-one.html"><i class="fa fa-check"></i><b>5.1</b> Part one</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="part-one.html"><a href="part-one.html#question-1-linear-models-with-penalization"><i class="fa fa-check"></i><b>5.1.1</b> Question 1: Linear models with penalization</a></li>
<li class="chapter" data-level="5.1.2" data-path="part-one.html"><a href="part-one.html#question-2-nonparametrics"><i class="fa fa-check"></i><b>5.1.2</b> Question 2: Nonparametrics</a></li>
<li class="chapter" data-level="5.1.3" data-path="part-one.html"><a href="part-one.html#question-3-additive-models"><i class="fa fa-check"></i><b>5.1.3</b> Question 3: Additive models</a></li>
<li class="chapter" data-level="5.1.4" data-path="part-one.html"><a href="part-one.html#question-4-model-explanation-and-fairness"><i class="fa fa-check"></i><b>5.1.4</b> Question 4: Model explanation and fairness</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="part-two.html"><a href="part-two.html"><i class="fa fa-check"></i><b>5.2</b> Part two</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="part-two.html"><a href="part-two.html#question-1-backfitting"><i class="fa fa-check"></i><b>5.2.1</b> Question 1: Backfitting</a></li>
<li class="chapter" data-level="5.2.2" data-path="part-two.html"><a href="part-two.html#question-2-cart-algorithm"><i class="fa fa-check"></i><b>5.2.2</b> Question 2: CART algorithm</a></li>
<li class="chapter" data-level="5.2.3" data-path="part-two.html"><a href="part-two.html#question-3-alpha-pruning"><i class="fa fa-check"></i><b>5.2.3</b> Question 3: Alpha-pruning</a></li>
<li class="chapter" data-level="5.2.4" data-path="part-two.html"><a href="part-two.html#question-4-gradient-boosting-machine"><i class="fa fa-check"></i><b>5.2.4</b> Question 4: Gradient Boosting Machine</a></li>
<li class="chapter" data-level="5.2.5" data-path="part-two.html"><a href="part-two.html#question-5-neural-network"><i class="fa fa-check"></i><b>5.2.5</b> Question 5: Neural Network</a></li>
<li class="chapter" data-level="5.2.6" data-path="part-two.html"><a href="part-two.html#question-6-tree-shap"><i class="fa fa-check"></i><b>5.2.6</b> Question 6: Tree SHAP</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://joakim-bilyk.github.io/index.html">Back to main site</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exam preparation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-two" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Part two<a href="part-two.html#part-two" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the second part of the exam one draws an algorithm. The student must explain the algorithm and be prepared to defend why it works and in which circumstances it is prefered.</p>
<div id="question-1-backfitting" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Question 1: Backfitting<a href="part-two.html#question-1-backfitting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A method of fitting an additive model
<span class="math display">\[\begin{align*}
  Y=\alpha +\sum_{i=1}^pm^*_i(X_i)+\varepsilon
  \end{align*}\]</span></li>
</ul>
<p>The algorithm:</p>
<ul>
<li>Initialize with
<span class="math display">\[\begin{align*}
  \hat \alpha = \frac{1}{n}\sum_{i=1}^n Y_i,\qquad\forall j=1,...,p\ :\ \hat m_j\equiv 0
  \end{align*}\]</span></li>
<li>For <span class="math inline">\(j=1,...,p\)</span> do
<ol style="list-style-type: lower-alpha">
<li>Calculate
<span class="math display">\[\begin{align*}
\tilde Y_j=Y-\alpha-\sum_{k:k\ne j}\hat m_k(X_{k})
\end{align*}\]</span></li>
<li>Smooth an estimator
<span class="math display">\[\begin{align*}
\hat m_j(x_j)=\text{Smooth}(X_j,\tilde Y_j)
\end{align*}\]</span></li>
<li>Center smoother
<span class="math display">\[\begin{align*}
\hat m_j(x_j)=\hat m_j(x_j)-\frac{1}{n}\sum_{i=1}^n \hat m_j(X_{ij})
\end{align*}\]</span></li>
</ol></li>
<li>The estimator is
<span class="math display">\[\begin{align*}
  \hat m(x)=\hat\alpha + \sum_{j=1}^p\hat m_j(x_j)
  \end{align*}\]</span></li>
</ul>
</div>
<div id="question-2-cart-algorithm" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Question 2: CART algorithm<a href="part-two.html#question-2-cart-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A method of constructing a binary classification or regression tree <span class="math inline">\(T\)</span>.</li>
</ul>
<p>The algorithm:</p>
<ul>
<li>Choose loss function <span class="math inline">\(Q\)</span> and a threshold <span class="math inline">\(q\)</span>.</li>
<li>Initialize tree as <span class="math inline">\(T=\{\mathcal X\}\)</span>.</li>
<li>For a node <span class="math inline">\(R\)</span> define
<span class="math display">\[\begin{align*}
  Q_n(R)=\sum_{i : X_{i\cdot} \in R}\left( Y_i - \frac{1}{\vert R\vert}\sum_{k : X_{k\cdot}\in R} Y_k\right)^2
  \end{align*}\]</span></li>
<li>Define <span class="math inline">\(\mathcal R_q=\{R\in T : C(R)&gt;c\}\)</span> for some criteria function <span class="math inline">\(C : \mathbb X\to\mathbb R_+\)</span> and <span class="math inline">\(c&gt;0\)</span>. While <span class="math inline">\(\mathcal R_q\ne \emptyset\)</span> choose some <span class="math inline">\(R\in \mathcal R_q\)</span> and do:
<ul>
<li>For all predictors <span class="math inline">\(j=1,...,p\)</span> do:
<ol style="list-style-type: lower-alpha">
<li>Define
<span class="math display">\[\begin{align*}
R(j)=\{x_j\ \vert\ \exists (x_1,...,x_{j-1},x_{j+1},...,x_p)\ s.t.\ (x_1,...,x_{j-1},x_j,x_{j+1},...,x_p)\in R \}
\end{align*}\]</span></li>
<li>Define for each <span class="math inline">\(s_j\in R(j)\)</span>
<span class="math display">\[\begin{align*}
R^+(j,s_j)=\{x\in R\ \vert\ x_j&gt; s_j\},\qquad R^-(j,s_j)=\{x\in R\ \vert\ x_j\le s_j\}
\end{align*}\]</span></li>
<li>Define the set <span class="math inline">\(\overline R=\{(j,s_j)\ \vert\ s_j\in R(j)\}\)</span>.</li>
<li>Split the node <span class="math inline">\(R\)</span> into <span class="math inline">\(R^+(j^*,s^*)\)</span> and <span class="math inline">\(R^-(j^*,s^*)\)</span> for
<span class="math display">\[\begin{align*}
(j^*,s^*)=\underset{s_j\in \overline R}{\text{arg min}}\left\{ Q_n(R^+(j,s_j))+Q_n(R^-(j,s_j))\right\}
\end{align*}\]</span></li>
<li>Update tree <span class="math inline">\(T=(T\setminus \{R\})\cup \{R^+(j^*,s^*),R^-(j^*,s^*)\}\)</span>.</li>
</ol></li>
</ul></li>
</ul>
</div>
<div id="question-3-alpha-pruning" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Question 3: Alpha-pruning<a href="part-two.html#question-3-alpha-pruning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Growing a tree <span class="math inline">\(T_{\max}\)</span> may lead to overfit. Solution: pruning branches.</li>
<li>Context: We have a objective risk measure <span class="math inline">\(R\)</span> based on <span class="math inline">\(Q_n\)</span> which favors smaller nodes/branches. Where
<span class="math display">\[\begin{align*}
  R(T_t)=\sum_{t&#39;\in \tilde T_t}Q_n(t&#39;)
  \end{align*}\]</span>
with <span class="math inline">\(T_t\)</span> being the branch with root <span class="math inline">\(t\)</span> and <span class="math inline">\(\tilde T_t\)</span> is the terminal nodes in <span class="math inline">\(T_t\)</span>. We penalizes the size of branch by
<span class="math display">\[\begin{align*}
  \widetilde R_\alpha(T_t)=R(T_t)+\alpha \vert T_t\vert
  \end{align*}\]</span>
where <span class="math inline">\(\vert T_t\vert\)</span> is the number of terminal leaves in <span class="math inline">\(T_t\)</span> (a tree can be a single leaf <span class="math inline">\(\tilde T_t=\{R\}\)</span>).
<ul>
<li>For any note <span class="math inline">\(t\)</span> and a branch <span class="math inline">\(T_t\)</span> we have <span class="math inline">\(\widetilde R_\alpha(T_t)&lt;\widetilde R_\alpha(t)\)</span> for <span class="math inline">\(\alpha\)</span> small and <span class="math inline">\(\frac{\partial}{\partial \alpha}\widetilde R_\alpha(T)=\vert T\vert\)</span> hence grows faster for the branch.</li>
<li>For some <span class="math inline">\(\alpha\)</span> we have <span class="math inline">\(\widetilde R_\alpha(T_t)=\widetilde R_\alpha(t)\)</span></li>
<li>We can gather a sequence <span class="math inline">\(0=\alpha_0&lt;\alpha_1&lt;...&lt;\alpha_{\max}\)</span> with <span class="math inline">\(T_0\supset T_1\supset ... \supset T_{\max}\)</span> and define the mapping <span class="math inline">\(\alpha \mapsto T_{n,\alpha}\)</span> via the sequence.</li>
</ul></li>
</ul>
<p>The algorithm</p>
<ul>
<li>Set <span class="math inline">\(k=0\)</span>. Initiate by pruning all terminal leaf pairs with
<span class="math display">\[\begin{align*}
  R(t)=R(t_L)+R(t_R)
  \end{align*}\]</span>
The first pair <span class="math inline">\((\alpha_0,T_0)=(0,T_n-t&#39;)\)</span> where <span class="math inline">\(t&#39;\)</span> is the terminal nodes satisfying the above.</li>
<li>While <span class="math inline">\(\vert T_k\vert &gt;1\)</span> do:
<ol style="list-style-type: lower-alpha">
<li>For all <span class="math inline">\(t\in T_k\)</span> we can find the smallest <span class="math inline">\(\alpha\)</span> such that <span class="math inline">\(R_\alpha(t)=R_\alpha(T_t)\)</span> and define
<span class="math display">\[\begin{align*}
g(t)=\frac{R(t)-R(T_t)}{\vert T_t\vert -1}
\end{align*}\]</span></li>
<li>The next <span class="math inline">\(\alpha_{k+1}\)</span> is then
<span class="math display">\[\begin{align*}
\alpha_{k+1}=\underset{t\in T_k}{\text{arg min}}(g(t)).
\end{align*}\]</span></li>
<li>Prune all terminal notes in <span class="math inline">\(T_t\)</span> where <span class="math inline">\(g(t)=\alpha_{k+1}\)</span>.</li>
<li>Collect the pruned tree and the <span class="math inline">\(\alpha\)</span> in <span class="math inline">\((\alpha_{k+1},T_{k+1})\)</span>.</li>
<li>Set <span class="math inline">\(k=k+1\)</span>.</li>
</ol></li>
</ul>
</div>
<div id="question-4-gradient-boosting-machine" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Question 4: Gradient Boosting Machine<a href="part-two.html#question-4-gradient-boosting-machine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We construct an estimator by improving on the previous for an amount of iterations.</p>
<ul>
<li>Initialize with
<span class="math display">\[\begin{align*}
  m^{(0)}(x)=\underset{m\in \mathcal G}{\text{arg min}}\sum_{i=1}^n L(Y_i,m(X_i)).
  \end{align*}\]</span></li>
<li>For <span class="math inline">\(b= 1,..., B\)</span> do
<ol style="list-style-type: lower-alpha">
<li>Calculate the derivative
<span class="math display">\[\begin{align*}
g_{ib}=-\left.\frac{\partial L(Y_i,y)}{\partial y}\right\vert_{y=m^{(b-1)}(X_i)}
\end{align*}\]</span></li>
<li>Train <span class="math inline">\(\gamma_b\)</span> on <span class="math inline">\(\{X,g_b\}\)</span></li>
<li>Search for optimal learning rate
<span class="math display">\[\begin{align*}
\alpha_b=\underset{\alpha}{\text{arg min}}\sum_{i=1}^n L(Y_i,m^{(b-1)}(X_i) +\alpha\gamma_b(X_i)).
\end{align*}\]</span></li>
<li>Update
<span class="math display">\[\begin{align*}
m^{(b)}(x)=m^{(b)}(x) + \alpha_b\gamma_b(x)
\end{align*}\]</span></li>
</ol></li>
</ul>
</div>
<div id="question-5-neural-network" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Question 5: Neural Network<a href="part-two.html#question-5-neural-network" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Neural networks are defined by the amount of layers and the activation functions <span class="math inline">\(\{g_k\}_{k=0,...,l}\)</span> where <span class="math inline">\(l\)</span> is the number of hidden layers.</p>
<p>The estimator is</p>
<p><span class="math display">\[
\hat m(x)=g^{(l)}\left(\beta^{(l)}_0+\beta^{(l)\top}g^{(l-1)}\left(\beta^{(l-2)}_0+\beta^{(l-2)\top}g^{(l-2)}\left(...\right)\right) \right)
\]</span></p>
<p>or</p>
<p><span class="math display">\[
\hat m (x)=\left(g^{(l)}\circ \beta^{(l)}\circ g^{(l-1)}\circ \cdots \circ g^{(0)} \circ\beta^{(0)}\right)(x)
\]</span></p>
<p>Backpropogation and Gradient decent:</p>
<ul>
<li>Assume <span class="math inline">\(l=1\)</span>.</li>
<li>We initialize <span class="math inline">\(\beta^{(k)}=(1,...,1)^\top\)</span> for <span class="math inline">\(k=0,1\)</span>.</li>
<li>We set <span class="math inline">\(b=0\)</span> and
<span class="math display">\[\begin{align*}
  \hat m^{(b)}(\beta^{(0),b},\beta^{(1),b};x)=g^{(1)}\left(\beta^{(1),b}_0 + \sum_{k=1}^{K}\beta_k^{(1),b}g^{(0)}\left(\beta^{(0),b}_0+\sum_{i=1}^n\beta^{(0),b}_ix_i\right)\right)
  \end{align*}\]</span></li>
<li>For <span class="math inline">\(b=1,...,B\)</span> do
<ol style="list-style-type: lower-alpha">
<li>Calculate for <span class="math inline">\(k=0,1\)</span>
<span class="math display">\[\begin{align*}
\rho_{ib}^{(k)}=-\left.\frac{\partial L(Y_i,y)}{\partial \beta^{(k)}}\right\vert_{y=\hat m^{(b-1)}(X_i)}
\end{align*}\]</span>
and define
<span class="math inline">\(\rho_{b}^{(k)}=\frac{1}{n}\sum_{i=1}^n\rho_{ib}^{(k)}\)</span>.</li>
<li>Optional: Calculate optimal decent for <span class="math inline">\(k=0,1\)</span>:
<span class="math display">\[\begin{align*}
\gamma_{b}=\underset{\gamma \in (0,\infty)^{l+1}}{\text{arg min}}\sum_{i=1}^n L(Y_i,m(\beta^{(0),b-1}+\gamma_0\rho_b^{(0)},\beta^{(1),b-1}+\gamma_1\rho_b^{(1)},X_i)).
\end{align*}\]</span>
else simply define learning rate <span class="math inline">\(\gamma_b^{(k)}=\gamma\)</span> always.</li>
<li>Update estimator with <span class="math inline">\(\beta^{(k),b}=\beta^{(k),b-1}+\gamma_{b}^{(k)}\rho_b^{(k)}\)</span>.</li>
</ol></li>
<li>Return <span class="math inline">\(\hat m(x)=\hat m^{(B)}(x)\)</span>.</li>
</ul>
</div>
<div id="question-6-tree-shap" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Question 6: Tree SHAP<a href="part-two.html#question-6-tree-shap" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="part-one.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
